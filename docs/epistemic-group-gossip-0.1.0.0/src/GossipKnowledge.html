<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_DfpSUhLQIpV0wVDmWDTiUm"><span id="%24tag2con_DfpSUhLQIpV0wVDmWDTiUm"><span id="%24con2tag_DfpSUhLQIpV0wVDmWDTiUm"></span></span></span><span class="hs-comment">{-|
Module      : GossipKnowledge
Description : Implements Knowledge Structures and Knowledge Transformers as defined in (Gattinger, 2018).
Copyright   : (c) Jesper Kuiper, 2021
                  Leander van Boven, 2021
                  Ramon Meffert, 2021
License     : BSD3
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GossipKnowledge</span><span> </span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Atomic proposition for Dynamic Gossip</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier">GossipAtom</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GAt"><span class="hs-identifier">GAt</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Rel"><span class="hs-identifier">Rel</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GossipKnowledge.html#N"><span class="hs-identifier">N</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#S"><span class="hs-identifier">S</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#C"><span class="hs-identifier">C</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Conversion to and from BDDs</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier">intToGAt</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#bddToGAt"><span class="hs-identifier">bddToGAt</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier">gAtToInt</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#gAtToBdd"><span class="hs-identifier">gAtToBdd</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Texification</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#texifyGAt"><span class="hs-identifier">texifyGAt</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#texifyBddVar"><span class="hs-identifier">texifyBddVar</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Epistemic formulae for Dyamic Gossip</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier">Form</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Fact"><span class="hs-identifier">Fact</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#K"><span class="hs-identifier">K</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#M"><span class="hs-identifier">M</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier">GossipForm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#Top"><span class="hs-identifier">Top</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Atom"><span class="hs-identifier">Atom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Neg"><span class="hs-identifier">Neg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Conj"><span class="hs-identifier">Conj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Disj"><span class="hs-identifier">Disj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Impl"><span class="hs-identifier">Impl</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Knowledge Structures for Dynamic Gossip</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier">GKS</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Knowledge Structure fields</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#vocabulary"><span class="hs-identifier">vocabulary</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier">stateLaw</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#observables"><span class="hs-identifier">observables</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#nag"><span class="hs-identifier">nag</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Generation and validation</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#fromGossipGraph"><span class="hs-identifier">fromGossipGraph</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#validKS"><span class="hs-identifier">validKS</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Transition from epistemic to boolean formulae</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#formToBdd"><span class="hs-identifier">formToBdd</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Knowledge Transformers for Dyamic Gossip</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier">KnowledgeTransformer</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KT"><span class="hs-identifier">KT</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Knowledge Transformer fields</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#addVocab"><span class="hs-identifier">addVocab</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#eventLaw"><span class="hs-identifier">eventLaw</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#addObs"><span class="hs-identifier">addObs</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Generation and validation</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#baseTransformer"><span class="hs-identifier">baseTransformer</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#validKT"><span class="hs-identifier">validKT</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Updating Knowledge Structures </span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#update"><span class="hs-identifier">update</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#%7C%2B%7C"><span class="hs-operator">(|+|)</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GossipKnowledge.html#updateWithCall"><span class="hs-identifier">updateWithCall</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></span><span>
</span><span id="line-54"></span><span class="hs-comment">--import Data.HasCacBDD</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unionWith</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">union</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isSubsetOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GossipGraph.html"><span class="hs-identifier">GossipGraph</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GossipTypes.html"><span class="hs-identifier">GossipTypes</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PrintableBdd.html"><span class="hs-identifier">PrintableBdd</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PrintableBdd.html#var"><span class="hs-identifier">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PrintableBdd.html#forall"><span class="hs-keyword">forall</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PrintableBdd.html#exists"><span class="hs-identifier">exists</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PrintableBdd.html#forallSet"><span class="hs-identifier">forallSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PrintableBdd.html#existsSet"><span class="hs-identifier">existsSet</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.html"><span class="hs-identifier">Util</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">{- 
    Atomic propositions for gossip 
-}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | The relation type of a GossipAtom. </span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="Rel"><span class="annot"><a href="GossipKnowledge.html#Rel"><span class="hs-identifier hs-var">Rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="N"><span class="annot"><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Indicates that x knows the number of y.</span><span>
</span><span id="line-75"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="S"><span class="annot"><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Indicates that x knows the secret of y.</span><span>
</span><span id="line-76"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span id="C"><span class="annot"><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Indicates that x has called y.</span><span>
</span><span id="line-77"></span><span>         </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058646"><span id="local-6989586621679058648"><span id="local-6989586621679058650"><span class="annot"><span class="annottext">Int -&gt; Rel -&gt; ShowS
[Rel] -&gt; ShowS
Rel -&gt; String
(Int -&gt; Rel -&gt; ShowS)
-&gt; (Rel -&gt; String) -&gt; ([Rel] -&gt; ShowS) -&gt; Show Rel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Rel] -&gt; ShowS
$cshowList :: [Rel] -&gt; ShowS
show :: Rel -&gt; String
$cshow :: Rel -&gt; String
showsPrec :: Int -&gt; Rel -&gt; ShowS
$cshowsPrec :: Int -&gt; Rel -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058630"><span id="local-6989586621679058632"><span id="local-6989586621679058634"><span id="local-6989586621679058636"><span id="local-6989586621679058638"><span id="local-6989586621679058640"><span id="local-6989586621679058642"><span class="annot"><span class="annottext">Eq Rel
Eq Rel
-&gt; (Rel -&gt; Rel -&gt; Ordering)
-&gt; (Rel -&gt; Rel -&gt; Bool)
-&gt; (Rel -&gt; Rel -&gt; Bool)
-&gt; (Rel -&gt; Rel -&gt; Bool)
-&gt; (Rel -&gt; Rel -&gt; Bool)
-&gt; (Rel -&gt; Rel -&gt; Rel)
-&gt; (Rel -&gt; Rel -&gt; Rel)
-&gt; Ord Rel
Rel -&gt; Rel -&gt; Bool
Rel -&gt; Rel -&gt; Ordering
Rel -&gt; Rel -&gt; Rel
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Rel -&gt; Rel -&gt; Rel
$cmin :: Rel -&gt; Rel -&gt; Rel
max :: Rel -&gt; Rel -&gt; Rel
$cmax :: Rel -&gt; Rel -&gt; Rel
&gt;= :: Rel -&gt; Rel -&gt; Bool
$c&gt;= :: Rel -&gt; Rel -&gt; Bool
&gt; :: Rel -&gt; Rel -&gt; Bool
$c&gt; :: Rel -&gt; Rel -&gt; Bool
&lt;= :: Rel -&gt; Rel -&gt; Bool
$c&lt;= :: Rel -&gt; Rel -&gt; Bool
&lt; :: Rel -&gt; Rel -&gt; Bool
$c&lt; :: Rel -&gt; Rel -&gt; Bool
compare :: Rel -&gt; Rel -&gt; Ordering
$ccompare :: Rel -&gt; Rel -&gt; Ordering
$cp1Ord :: Eq Rel
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058625"><span id="local-6989586621679058627"><span class="annot"><span class="annottext">Rel -&gt; Rel -&gt; Bool
(Rel -&gt; Rel -&gt; Bool) -&gt; (Rel -&gt; Rel -&gt; Bool) -&gt; Eq Rel
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Rel -&gt; Rel -&gt; Bool
$c/= :: Rel -&gt; Rel -&gt; Bool
== :: Rel -&gt; Rel -&gt; Bool
$c== :: Rel -&gt; Rel -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058608"><span id="local-6989586621679058610"><span id="local-6989586621679058612"><span id="local-6989586621679058614"><span id="local-6989586621679058616"><span id="local-6989586621679058618"><span id="local-6989586621679058620"><span id="local-6989586621679058622"><span class="annot"><span class="annottext">Int -&gt; Rel
Rel -&gt; Int
Rel -&gt; [Rel]
Rel -&gt; Rel
Rel -&gt; Rel -&gt; [Rel]
Rel -&gt; Rel -&gt; Rel -&gt; [Rel]
(Rel -&gt; Rel)
-&gt; (Rel -&gt; Rel)
-&gt; (Int -&gt; Rel)
-&gt; (Rel -&gt; Int)
-&gt; (Rel -&gt; [Rel])
-&gt; (Rel -&gt; Rel -&gt; [Rel])
-&gt; (Rel -&gt; Rel -&gt; [Rel])
-&gt; (Rel -&gt; Rel -&gt; Rel -&gt; [Rel])
-&gt; Enum Rel
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Rel -&gt; Rel -&gt; Rel -&gt; [Rel]
$cenumFromThenTo :: Rel -&gt; Rel -&gt; Rel -&gt; [Rel]
enumFromTo :: Rel -&gt; Rel -&gt; [Rel]
$cenumFromTo :: Rel -&gt; Rel -&gt; [Rel]
enumFromThen :: Rel -&gt; Rel -&gt; [Rel]
$cenumFromThen :: Rel -&gt; Rel -&gt; [Rel]
enumFrom :: Rel -&gt; [Rel]
$cenumFrom :: Rel -&gt; [Rel]
fromEnum :: Rel -&gt; Int
$cfromEnum :: Rel -&gt; Int
toEnum :: Int -&gt; Rel
$ctoEnum :: Int -&gt; Rel
pred :: Rel -&gt; Rel
$cpred :: Rel -&gt; Rel
succ :: Rel -&gt; Rel
$csucc :: Rel -&gt; Rel
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | An atomic proposition in a gossip state: Rel(Agent, Agent).</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="GossipAtom"><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-var">GossipAtom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GAt"><span class="annot"><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#Rel"><span class="hs-identifier hs-type">Rel</span></a></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058592"><span id="local-6989586621679058594"><span id="local-6989586621679058596"><span id="local-6989586621679058598"><span id="local-6989586621679058600"><span id="local-6989586621679058602"><span id="local-6989586621679058604"><span class="annot"><span class="annottext">Eq GossipAtom
Eq GossipAtom
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Ordering)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Bool)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Bool)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Bool)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Bool)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; GossipAtom)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; GossipAtom)
-&gt; Ord GossipAtom
GossipAtom -&gt; GossipAtom -&gt; Bool
GossipAtom -&gt; GossipAtom -&gt; Ordering
GossipAtom -&gt; GossipAtom -&gt; GossipAtom
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: GossipAtom -&gt; GossipAtom -&gt; GossipAtom
$cmin :: GossipAtom -&gt; GossipAtom -&gt; GossipAtom
max :: GossipAtom -&gt; GossipAtom -&gt; GossipAtom
$cmax :: GossipAtom -&gt; GossipAtom -&gt; GossipAtom
&gt;= :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c&gt;= :: GossipAtom -&gt; GossipAtom -&gt; Bool
&gt; :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c&gt; :: GossipAtom -&gt; GossipAtom -&gt; Bool
&lt;= :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c&lt;= :: GossipAtom -&gt; GossipAtom -&gt; Bool
&lt; :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c&lt; :: GossipAtom -&gt; GossipAtom -&gt; Bool
compare :: GossipAtom -&gt; GossipAtom -&gt; Ordering
$ccompare :: GossipAtom -&gt; GossipAtom -&gt; Ordering
$cp1Ord :: Eq GossipAtom
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058588"><span id="local-6989586621679058590"><span class="annot"><span class="annottext">GossipAtom -&gt; GossipAtom -&gt; Bool
(GossipAtom -&gt; GossipAtom -&gt; Bool)
-&gt; (GossipAtom -&gt; GossipAtom -&gt; Bool) -&gt; Eq GossipAtom
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c/= :: GossipAtom -&gt; GossipAtom -&gt; Bool
== :: GossipAtom -&gt; GossipAtom -&gt; Bool
$c== :: GossipAtom -&gt; GossipAtom -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058583"><span id="local-6989586621679058586"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679058582"><span class="annot"><span class="annottext">show :: GossipAtom -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-type">GAt</span></a></span><span> </span><span id="local-6989586621679058580"><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058580"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679058579"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058579"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621679058578"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058578"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rel -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058580"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058579"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058578"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Converts an atomic gossip proposition into a LaTeX string.</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;&gt;&gt; texify (GAt N a b)</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- \texttt{N}ab</span><span>
</span><span id="line-89"></span><span class="annot"><a href="GossipKnowledge.html#texifyGAt"><span class="hs-identifier hs-type">texifyGAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-90"></span><span id="texifyGAt"><span class="annot"><span class="annottext">texifyGAt :: GossipAtom -&gt; String
</span><a href="GossipKnowledge.html#texifyGAt"><span class="hs-identifier hs-var hs-var">texifyGAt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-type">GAt</span></a></span><span> </span><span id="local-6989586621679058575"><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058575"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span id="local-6989586621679058574"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058574"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621679058573"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058573"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\texttt{&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058575"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058574"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058573"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Converts a BDD formula to a list of GossipAtoms for all variables in the formula. Internally calls intToGAt.</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;&gt;&gt; bddToGAt 3 ((var 0) `imp` (var 12))</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt;&gt;&gt; [Naa, Sba]</span><span>
</span><span id="line-96"></span><span class="annot"><a href="GossipKnowledge.html#bddToGAt"><span class="hs-identifier hs-type">bddToGAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span id="bddToGAt"><span class="annot"><span class="annottext">bddToGAt :: Int -&gt; Bdd -&gt; [GossipAtom]
</span><a href="GossipKnowledge.html#bddToGAt"><span class="hs-identifier hs-var hs-var">bddToGAt</span></a></span></span><span> </span><span id="local-6989586621679058572"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058572"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679058571"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058571"><span class="hs-identifier hs-var">bdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; GossipAtom) -&gt; [Int] -&gt; [GossipAtom]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; GossipAtom
</span><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-var">intToGAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058572"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bdd -&gt; [Int]
</span><a href="PrintableBdd.html#allVarsOf"><span class="hs-identifier hs-var">allVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058571"><span class="hs-identifier hs-var">bdd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Converts a BDD variable index to a GossipAtom. Note that the first Int argument corresponds to the amount of agents present in the gossip graph. This is a bijective function to allow for unique indexing of atomic gossip propositions. </span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt;&gt;&gt; intToGAt 3 0</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- Naa</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- </span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;&gt;&gt; intToGAt 3 12</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Sba</span><span>
</span><span id="line-106"></span><span class="annot"><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-type">intToGAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span>
</span><span id="line-107"></span><span id="intToGAt"><span class="annot"><span class="annottext">intToGAt :: Int -&gt; Int -&gt; GossipAtom
</span><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-var hs-var">intToGAt</span></a></span></span><span> </span><span id="local-6989586621679058569"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679058568"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058568"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Rel
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058566"><span class="hs-identifier hs-var">rel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058565"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="GossipGraph.html#idToLab"><span class="hs-identifier hs-var">idToLab</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058565"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058563"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><a href="GossipGraph.html#idToLab"><span class="hs-identifier hs-var">idToLab</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058563"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679058566"><span class="annot"><span class="annottext">rel :: Int
</span><a href="#local-6989586621679058566"><span class="hs-identifier hs-var hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058568"><span class="hs-identifier hs-var">v</span></a></span><span>                   </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-109"></span><span>        </span><span id="local-6989586621679058565"><span class="annot"><span class="annottext">a1 :: Int
</span><a href="#local-6989586621679058565"><span class="hs-identifier hs-var hs-var">a1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058568"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>         </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679058563"><span class="annot"><span class="annottext">a2 :: Int
</span><a href="#local-6989586621679058563"><span class="hs-identifier hs-var hs-var">a2</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058568"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058569"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Converts a BDD variable index to a GossipAtom, and converts that to a string.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt;&gt;&gt; showBddVar 3 12</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &gt;&gt;&gt; &quot;Sba&quot;</span><span>
</span><span id="line-116"></span><span class="annot"><a href="GossipKnowledge.html#showBddVar"><span class="hs-identifier hs-type">showBddVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-117"></span><span id="showBddVar"><span class="annot"><span class="annottext">showBddVar :: Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#showBddVar"><span class="hs-identifier hs-var hs-var">showBddVar</span></a></span></span><span> </span><span id="local-6989586621679058558"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058558"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; String) -&gt; (Int -&gt; GossipAtom) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; GossipAtom
</span><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-var">intToGAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058558"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Converts a BDD variable index to a GossipAtom, and converts that to a LaTeX string.</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;&gt;&gt; texifyBddVar 3 12</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &quot;\texttt{S}ba&quot;</span><span>
</span><span id="line-123"></span><span class="annot"><a href="GossipKnowledge.html#texifyBddVar"><span class="hs-identifier hs-type">texifyBddVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-124"></span><span id="texifyBddVar"><span class="annot"><span class="annottext">texifyBddVar :: Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texifyBddVar"><span class="hs-identifier hs-var hs-var">texifyBddVar</span></a></span></span><span> </span><span id="local-6989586621679058556"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058556"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; String
</span><a href="GossipKnowledge.html#texifyGAt"><span class="hs-identifier hs-var">texifyGAt</span></a></span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; String) -&gt; (Int -&gt; GossipAtom) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; GossipAtom
</span><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-var">intToGAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058556"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Converts a GossipAtom to a unique but labelled BDD variable. Note that the first argument corresponds to the amount of agents present in the gossip graph. </span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- &gt;&gt;&gt; gAtToBdd 3 (GAt S b a)</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Sba</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Note that, while this function prints the normal gossip atom, the type that is returned is of BDD instead of GossipAtom. Internally, a unique variable index has been generated.</span><span>
</span><span id="line-132"></span><span class="annot"><a href="GossipKnowledge.html#gAtToBdd"><span class="hs-identifier hs-type">gAtToBdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-133"></span><span id="gAtToBdd"><span class="annot"><span class="annottext">gAtToBdd :: Int -&gt; GossipAtom -&gt; Bdd
</span><a href="GossipKnowledge.html#gAtToBdd"><span class="hs-identifier hs-var hs-var">gAtToBdd</span></a></span></span><span> </span><span id="local-6989586621679058555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058555"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679058554"><span class="annot"><span class="annottext">GossipAtom
</span><a href="#local-6989586621679058554"><span class="hs-identifier hs-var">gat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bdd
</span><a href="GossipKnowledge.html#gvar"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058555"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bdd) -&gt; Int -&gt; Bdd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; GossipAtom -&gt; Int
</span><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-var">gAtToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058555"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">GossipAtom
</span><a href="#local-6989586621679058554"><span class="hs-identifier hs-var">gat</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Converts a GossipAtom to a unique integer index that can be used for a BDD variable. </span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt;&gt;&gt; gAtToInt 3 (GAt S b a)</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- 12</span><span>
</span><span id="line-139"></span><span class="annot"><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-type">gAtToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-140"></span><span id="gAtToInt"><span class="annot"><span class="annottext">gAtToInt :: Int -&gt; GossipAtom -&gt; Int
</span><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-var hs-var">gAtToInt</span></a></span></span><span> </span><span id="local-6989586621679058552"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058552"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-type">GAt</span></a></span><span> </span><span id="local-6989586621679058551"><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058551"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058550"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058550"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058549"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058549"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058552"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="#local-6989586621679058551"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058552"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058550"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058549"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- Local helper functions</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | Generates a labelled BDD variable based on agent count and a variable index. </span><span>
</span><span id="line-146"></span><span class="annot"><a href="GossipKnowledge.html#gvar"><span class="hs-identifier hs-type">gvar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-147"></span><span id="gvar"><span class="annot"><span class="annottext">gvar :: Int -&gt; Int -&gt; Bdd
</span><a href="GossipKnowledge.html#gvar"><span class="hs-identifier hs-var hs-var">gvar</span></a></span></span><span> </span><span id="local-6989586621679058545"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058545"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; (Int -&gt; String) -&gt; Int -&gt; Bdd
</span><a href="PrintableBdd.html#varl"><span class="hs-identifier hs-var">varl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#showBddVar"><span class="hs-identifier hs-var">showBddVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058545"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texifyBddVar"><span class="hs-identifier hs-var">texifyBddVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058545"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | The labeller that is used to label variables in the BDD. </span><span>
</span><span id="line-150"></span><span class="annot"><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-type">strLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#VarLabeller"><span class="hs-identifier hs-type">VarLabeller</span></a></span><span>
</span><span id="line-151"></span><span id="strLabel"><span class="annot"><span class="annottext">strLabel :: Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-var hs-var">strLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#showBddVar"><span class="hs-identifier hs-var">showBddVar</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | The labeller that is used to label variables in the LaTeX string of the BDD.</span><span>
</span><span id="line-154"></span><span class="annot"><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-type">texLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#VarLabeller"><span class="hs-identifier hs-type">VarLabeller</span></a></span><span>
</span><span id="line-155"></span><span id="texLabel"><span class="annot"><span class="annottext">texLabel :: Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-var hs-var">texLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texifyBddVar"><span class="hs-identifier hs-var">texifyBddVar</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">{- 
    Epistemic formulae for gossip
-}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | A recursively defined propositional formula build out of GossipAtoms.</span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="GossipForm"><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-var">GossipForm</span></a></span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="Top"><span class="annot"><a href="GossipKnowledge.html#Top"><span class="hs-identifier hs-var">Top</span></a></span></span><span>                           </span><span class="hs-comment">-- ^ Always true</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Atom"><span class="annot"><a href="GossipKnowledge.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipAtom"><span class="hs-identifier hs-type">GossipAtom</span></a></span><span>               </span><span class="hs-comment">-- ^ Atom</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Neg"><span class="annot"><a href="GossipKnowledge.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-type">GossipForm</span></a></span><span>                </span><span class="hs-comment">-- ^ Negation</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Conj"><span class="annot"><a href="GossipKnowledge.html#Conj"><span class="hs-identifier hs-var">Conj</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-type">GossipForm</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ Conjunction</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Disj"><span class="annot"><a href="GossipKnowledge.html#Disj"><span class="hs-identifier hs-var">Disj</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-type">GossipForm</span></a></span><span class="hs-special">]</span><span>             </span><span class="hs-comment">-- ^ Disjunction   </span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Impl"><span class="annot"><a href="GossipKnowledge.html#Impl"><span class="hs-identifier hs-var">Impl</span></a></span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-type">GossipForm</span></a></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipForm"><span class="hs-identifier hs-type">GossipForm</span></a></span><span>    </span><span class="hs-comment">-- ^ Implication</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058535"><span id="local-6989586621679058537"><span id="local-6989586621679058539"><span class="annot"><span class="annottext">Int -&gt; GossipForm -&gt; ShowS
[GossipForm] -&gt; ShowS
GossipForm -&gt; String
(Int -&gt; GossipForm -&gt; ShowS)
-&gt; (GossipForm -&gt; String)
-&gt; ([GossipForm] -&gt; ShowS)
-&gt; Show GossipForm
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GossipForm] -&gt; ShowS
$cshowList :: [GossipForm] -&gt; ShowS
show :: GossipForm -&gt; String
$cshow :: GossipForm -&gt; String
showsPrec :: Int -&gt; GossipForm -&gt; ShowS
$cshowsPrec :: Int -&gt; GossipForm -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | An epistemic formula, defined in terms of BDDs. This data structure allows for propositional formulae, as well as (higher-order) agent knowledge.  </span><span>
</span><span id="line-173"></span><span class="hs-keyword">data</span><span> </span><span id="Form"><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-var">Form</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fact"><span class="annot"><a href="GossipKnowledge.html#Fact"><span class="hs-identifier hs-var">Fact</span></a></span></span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-174"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="K"><span class="annot"><a href="GossipKnowledge.html#K"><span class="hs-identifier hs-var">K</span></a></span></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="M"><span class="annot"><a href="GossipKnowledge.html#M"><span class="hs-identifier hs-var">M</span></a></span></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058530"><span id="local-6989586621679058533"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-type">Form</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679058529"><span class="annot"><span class="annottext">show :: Form -&gt; String
</span><a href="#local-6989586621679058529"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#Fact"><span class="hs-identifier hs-type">Fact</span></a></span><span> </span><span id="local-6989586621679058528"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058528"><span class="hs-identifier hs-var">bdd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058528"><span class="hs-identifier hs-var">bdd</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#K"><span class="hs-identifier hs-type">K</span></a></span><span> </span><span id="local-6989586621679058527"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058527"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679058526"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058526"><span class="hs-identifier hs-var">form</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;K&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058527"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Form -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058526"><span class="hs-identifier hs-var">form</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679058525"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058525"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679058524"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058524"><span class="hs-identifier hs-var">form</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;K&#770;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058525"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Form -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058524"><span class="hs-identifier hs-var">form</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">{- 
    Knowledge Structures for gossip
-}</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | A knowledge structure (Gattinger, 2018) which represents the knowledge of a Gossip State. </span><span>
</span><span id="line-188"></span><span class="hs-keyword">data</span><span> </span><span id="GossipKnowledgeStructure"><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-var">GossipKnowledgeStructure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GKS"><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-var">GKS</span></a></span></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | The set of propositional atoms available in the model. </span><span>
</span><span id="line-190"></span><span>    </span><span id="vocabulary"><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Set Int
</span><a href="GossipKnowledge.html#vocabulary"><span class="hs-identifier hs-var hs-var">vocabulary</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- | A boolean formula representing the law that every state needs to adhere to. </span><span>
</span><span id="line-193"></span><span>    </span><span id="stateLaw"><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Bdd
</span><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier hs-var hs-var">stateLaw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- | The set of atoms seen by some agent. If an atom is observable for an agent, then they are certain as to whether this atom is true or false. </span><span>
</span><span id="line-196"></span><span>    </span><span id="observables"><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Map Agent (Set Int)
</span><a href="GossipKnowledge.html#observables"><span class="hs-identifier hs-var hs-var">observables</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679058520"><span id="local-6989586621679058522"><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool
(GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool)
-&gt; (GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool)
-&gt; Eq GossipKnowledgeStructure
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool
$c/= :: GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool
== :: GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool
$c== :: GossipKnowledgeStructure -&gt; GossipKnowledgeStructure -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679058515"><span id="local-6989586621679058518"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679058514"><span class="annot"><span class="annottext">show :: GossipKnowledgeStructure -&gt; String
</span><a href="#local-6989586621679058514"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span> </span><span id="local-6989586621679058513"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058513"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679058512"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058512"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679058511"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058511"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vocabulary: { &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,\n              &quot;</span></span><span>  </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679058509"><span class="hs-identifier hs-var">vocab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; }&quot;</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nstate law: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058512"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nobservables: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n             &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Agent, Set Int) -&gt; String) -&gt; [(Agent, Set Int)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Agent, Set Int) -&gt; String
</span><a href="#local-6989586621679058508"><span class="hs-identifier hs-var">shObs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Agent (Set Int) -&gt; [(Agent, Set Int)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.assocs</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058511"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>      </span><span id="local-6989586621679058509"><span class="annot"><span class="annottext">vocab :: [String]
</span><a href="#local-6989586621679058509"><span class="hs-identifier hs-var hs-var">vocab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [[String]] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[String]] -&gt; [String]) -&gt; [[String]] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [[String]]
forall e. Int -&gt; [e] -&gt; [[e]]
</span><a href="#local-6989586621679058506"><span class="hs-identifier hs-var">chunksOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [[String]]) -&gt; [String] -&gt; [[String]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679058505"><span class="hs-identifier hs-var">gat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int -&gt; [Int]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058513"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>      </span><span class="annot"><a href="#local-6989586621679058505"><span class="hs-identifier hs-type">gat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-209"></span><span>      </span><span id="local-6989586621679058505"><span class="annot"><span class="annottext">gat :: Int -&gt; String
</span><a href="#local-6989586621679058505"><span class="hs-identifier hs-var hs-var">gat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; String) -&gt; (Int -&gt; GossipAtom) -&gt; Int -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; GossipAtom
</span><a href="GossipKnowledge.html#intToGAt"><span class="hs-identifier hs-var">intToGAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Agent (Set Int) -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058511"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><a href="#local-6989586621679058508"><span class="hs-identifier hs-type">shObs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621679058508"><span class="annot"><span class="annottext">shObs :: (Agent, Set Int) -&gt; String
</span><a href="#local-6989586621679058508"><span class="hs-identifier hs-var hs-var">shObs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058502"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058502"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058501"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058501"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Agent -&gt; String
</span><a href="GossipTypes.html#showAgent"><span class="hs-identifier hs-var">showAgent</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058502"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; [Int] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679058505"><span class="hs-identifier hs-var">gat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int -&gt; [Int]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058501"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; }&quot;</span></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-comment">-- The following two functions were taken from the source code of Data.List.Split, so that we don't have to </span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-comment">-- import the entire module. </span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-comment">-- Source: https://hackage.haskell.org/package/split-0.2.3.4/docs/src/Data.List.Split.Internals.html#build</span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679058736"><span class="annot"><a href="#local-6989586621679058500"><span class="hs-identifier hs-type">build</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-221"></span><span>      </span><span id="local-6989586621679058500"><span class="annot"><span class="annottext">build :: ((a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]) -&gt; [a]
</span><a href="#local-6989586621679058500"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679058499"><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679058499"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]
</span><a href="#local-6989586621679058499"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>      </span><span id="local-6989586621679058744"><span class="annot"><a href="#local-6989586621679058506"><span class="hs-identifier hs-type">chunksOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058744"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058744"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-224"></span><span>      </span><span id="local-6989586621679058506"><span class="annot"><span class="annottext">chunksOf :: Int -&gt; [e] -&gt; [[e]]
</span><a href="#local-6989586621679058506"><span class="hs-identifier hs-var hs-var">chunksOf</span></a></span></span><span> </span><span id="local-6989586621679058498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058498"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679058497"><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679058497"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([e] -&gt; [e]) -&gt; [[e]] -&gt; [[e]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [e] -&gt; [e]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058498"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([e] -&gt; [[e]] -&gt; [[e]]) -&gt; [[e]] -&gt; [[e]]) -&gt; [[e]]
forall a. ((a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a]) -&gt; [a]
</span><a href="#local-6989586621679058500"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[e] -&gt; ([e] -&gt; [[e]] -&gt; [[e]]) -&gt; [[e]] -&gt; [[e]]
forall e a. [e] -&gt; ([e] -&gt; a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679058495"><span class="hs-identifier hs-var">splitter</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679058497"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>        </span><span id="local-6989586621679058734"><span id="local-6989586621679058735"><span class="annot"><a href="#local-6989586621679058495"><span class="hs-identifier hs-type">splitter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058735"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679058735"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058734"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058734"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679058734"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-226"></span><span>        </span><span id="local-6989586621679058495"><span class="annot"><span class="annottext">splitter :: [e] -&gt; ([e] -&gt; a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679058495"><span class="hs-identifier hs-var hs-var">splitter</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679058494"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058494"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058494"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><a href="#local-6989586621679058495"><span class="hs-identifier hs-var">splitter</span></a></span><span> </span><span id="local-6989586621679058493"><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679058493"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679058492"><span class="annot"><span class="annottext">[e] -&gt; a -&gt; a
</span><a href="#local-6989586621679058492"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679058491"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058491"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679058493"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; a -&gt; a
</span><a href="#local-6989586621679058492"><span class="hs-operator hs-var">`c`</span></a></span><span> </span><span class="annot"><span class="annottext">[e] -&gt; ([e] -&gt; a -&gt; a) -&gt; a -&gt; a
forall e a. [e] -&gt; ([e] -&gt; a -&gt; a) -&gt; a -&gt; a
</span><a href="#local-6989586621679058495"><span class="hs-identifier hs-var">splitter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [e] -&gt; [e]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058498"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[e]
</span><a href="#local-6989586621679058493"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[e] -&gt; a -&gt; a
</span><a href="#local-6989586621679058492"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058491"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-comment">-- End of copy</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Checks if a given Knowledge Structure is valid. It checks whether the variables found in both the state law and the observable sets are present in the vocabulary. </span><span>
</span><span id="line-231"></span><span class="annot"><a href="GossipKnowledge.html#validKS"><span class="hs-identifier hs-type">validKS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-232"></span><span id="validKS"><span class="annot"><span class="annottext">validKS :: GossipKnowledgeStructure -&gt; Bool
</span><a href="GossipKnowledge.html#validKS"><span class="hs-identifier hs-var hs-var">validKS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span> </span><span id="local-6989586621679058489"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058489"><span class="hs-identifier hs-var">vocab</span></a></span></span><span> </span><span id="local-6989586621679058488"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058488"><span class="hs-identifier hs-var">law</span></a></span></span><span> </span><span id="local-6989586621679058487"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058487"><span class="hs-identifier hs-var">obs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058486"><span class="annot"><span class="annottext">lawCheck :: Bool
</span><a href="#local-6989586621679058486"><span class="hs-identifier hs-var hs-var">lawCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bdd -&gt; [Int]
</span><a href="PrintableBdd.html#allVarsOf"><span class="hs-identifier hs-var">allVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058488"><span class="hs-identifier hs-var">law</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058489"><span class="hs-identifier hs-var">vocab</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span id="local-6989586621679058484"><span class="annot"><span class="annottext">obsCheck :: Bool
</span><a href="#local-6989586621679058484"><span class="hs-identifier hs-var hs-var">obsCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Int -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map Agent (Set Int) -&gt; Bool
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (Set Int -&gt; Bool) -&gt; Set Int -&gt; Bool -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058489"><span class="hs-identifier hs-var">vocab</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058487"><span class="hs-identifier hs-var">obs</span></a></span><span>
</span><span id="line-235"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058486"><span class="hs-identifier hs-var">lawCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058484"><span class="hs-identifier hs-var">obsCheck</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Converts a gossip graph to its corresponding knowledge structure. </span><span>
</span><span id="line-238"></span><span class="hs-comment">--   Note that this doesn't convert a gossip state, i.e. no call sequence is encoded.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--   This is meant for the conversion of the _initial_ gossip state, (G, &#949;) </span><span>
</span><span id="line-240"></span><span class="hs-comment">--   (van Ditmarsch et al., 2017)</span><span>
</span><span id="line-241"></span><span class="annot"><a href="GossipKnowledge.html#fromGossipGraph"><span class="hs-identifier hs-type">fromGossipGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipGraph.html#GossipGraph"><span class="hs-identifier hs-type">GossipGraph</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span>
</span><span id="line-242"></span><span id="fromGossipGraph"><span class="annot"><span class="annottext">fromGossipGraph :: GossipGraph -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#fromGossipGraph"><span class="hs-identifier hs-var hs-var">fromGossipGraph</span></a></span></span><span> </span><span id="local-6989586621679058481"><span class="annot"><span class="annottext">GossipGraph
</span><a href="#local-6989586621679058481"><span class="hs-identifier hs-var">graph</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058480"><span class="annot"><span class="annottext">agents :: [Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var hs-var">agents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipGraph -&gt; [Agent]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><span class="hs-identifier hs-var">labNodes</span></span><span> </span><span class="annot"><span class="annottext">GossipGraph
</span><a href="#local-6989586621679058481"><span class="hs-identifier hs-var">graph</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679058478"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679058478"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Agent] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>      </span><span id="local-6989586621679058476"><span class="annot"><span class="annottext">gvar :: GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var hs-var">gvar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GossipAtom -&gt; Bdd
</span><a href="GossipKnowledge.html#gAtToBdd"><span class="hs-identifier hs-var">gAtToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058478"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span id="local-6989586621679058475"><span class="annot"><span class="annottext">gint :: GossipAtom -&gt; Int
</span><a href="#local-6989586621679058475"><span class="hs-identifier hs-var hs-var">gint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GossipAtom -&gt; Int
</span><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-var">gAtToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058478"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-comment">-- vocabulary</span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621679058474"><span class="annot"><span class="annottext">agentCombs :: [(Agent, Agent)]
</span><a href="#local-6989586621679058474"><span class="hs-identifier hs-var hs-var">agentCombs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058473"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058472"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679058473"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058473"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058472"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058472"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621679058471"><span class="annot"><span class="annottext">vocabAtoms :: [GossipAtom]
</span><a href="#local-6989586621679058471"><span class="hs-identifier hs-var hs-var">vocabAtoms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Agent, Agent) -&gt; [GossipAtom] -&gt; [GossipAtom])
-&gt; [GossipAtom] -&gt; [(Agent, Agent)] -&gt; [GossipAtom]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679058469"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679058468"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058468"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GossipAtom] -&gt; [GossipAtom] -&gt; [GossipAtom]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058468"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058468"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058469"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058468"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Agent, Agent)]
</span><a href="#local-6989586621679058474"><span class="hs-identifier hs-var">agentCombs</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679058467"><span class="annot"><span class="annottext">vocabulary :: [Int]
</span><a href="#local-6989586621679058467"><span class="hs-identifier hs-var hs-var">vocabulary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; Int) -&gt; [GossipAtom] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Int
</span><a href="#local-6989586621679058475"><span class="hs-identifier hs-var">gint</span></a></span><span> </span><span class="annot"><span class="annottext">[GossipAtom]
</span><a href="#local-6989586621679058471"><span class="hs-identifier hs-var">vocabAtoms</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-comment">-- state law</span><span>
</span><span id="line-255"></span><span>      </span><span id="local-6989586621679058466"><span class="annot"><span class="annottext">stateLaw :: Bdd
</span><a href="#local-6989586621679058466"><span class="hs-identifier hs-var hs-var">stateLaw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; Bdd
</span><a href="PrintableBdd.html#conSet"><span class="hs-identifier hs-var">conSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Agent -&gt; [Bdd] -&gt; [Bdd]) -&gt; [Bdd] -&gt; [Agent] -&gt; [Bdd]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679058464"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; [Bdd] -&gt; [Bdd]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058464"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#con"><span class="hs-operator hs-var">`con`</span></a></span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; Bdd
</span><a href="PrintableBdd.html#conSet"><span class="hs-identifier hs-var">conSet</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#imp"><span class="hs-operator hs-var">`imp`</span></a></span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; Bdd
</span><a href="PrintableBdd.html#conSet"><span class="hs-identifier hs-var">conSet</span></a></span><span>             </span><span class="hs-comment">--  if x has called y;</span><span>
</span><span id="line-258"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>                        </span><span class="hs-comment">--  then x knows y's number;</span><span>
</span><span id="line-259"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>                        </span><span class="hs-comment">--  and y knows x's number;</span><span>
</span><span id="line-260"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>                        </span><span class="hs-comment">--  and x knows y's secret;</span><span>
</span><span id="line-261"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>                        </span><span class="hs-comment">--  and y knows x's secret;</span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679058462"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058461"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Agent -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058461"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; [Bdd] -&gt; [Bdd]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#imp"><span class="hs-operator hs-var">`imp`</span></a></span><span> </span><span class="annot"><span class="annottext">[Bdd] -&gt; Bdd
</span><a href="PrintableBdd.html#conSet"><span class="hs-identifier hs-var">conSet</span></a></span><span>         </span><span>
</span><span id="line-264"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#equ"><span class="hs-operator hs-var">`equ`</span></a></span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- and if x knows the number of some z, then y does so as well (and vice versa);</span><span>
</span><span id="line-265"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#equ"><span class="hs-operator hs-var">`equ`</span></a></span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Bdd
</span><a href="#local-6989586621679058476"><span class="hs-identifier hs-var">gvar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- and if x knows the secret of some z, then y does so as well (and vice versa).</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679058458"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058457"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Agent -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058456"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058458"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Agent -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058457"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Agent -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058456"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-comment">-- observables</span><span>
</span><span id="line-270"></span><span>      </span><span id="local-6989586621679058454"><span class="annot"><span class="annottext">initials :: [GossipAtom]
</span><a href="#local-6989586621679058454"><span class="hs-identifier hs-var hs-var">initials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Agent -&gt; [GossipAtom] -&gt; [GossipAtom])
-&gt; [GossipAtom] -&gt; [Agent] -&gt; [GossipAtom]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679058453"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058453"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[GossipAtom] -&gt; [GossipAtom] -&gt; [GossipAtom]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058453"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058453"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058453"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058453"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679058452"><span class="annot"><span class="annottext">numbersOf :: Agent -&gt; [GossipAtom]
</span><a href="#local-6989586621679058452"><span class="hs-identifier hs-var hs-var">numbersOf</span></a></span></span><span> </span><span id="local-6989586621679058451"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058451"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058451"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058450"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679058450"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GossipGraph -&gt; Agent -&gt; [Agent]
</span><a href="GossipGraph.html#numbersKnownBy"><span class="hs-identifier hs-var">numbersKnownBy</span></a></span><span> </span><span class="annot"><span class="annottext">GossipGraph
</span><a href="#local-6989586621679058481"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058451"><span class="hs-identifier hs-var">ag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>      </span><span id="local-6989586621679058448"><span class="annot"><span class="annottext">observablesOf :: Agent -&gt; [Int]
</span><a href="#local-6989586621679058448"><span class="hs-identifier hs-var hs-var">observablesOf</span></a></span></span><span> </span><span id="local-6989586621679058447"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058447"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; Int) -&gt; [GossipAtom] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GossipAtom -&gt; Int
</span><a href="#local-6989586621679058475"><span class="hs-identifier hs-var">gint</span></a></span><span> </span><span class="annot"><span class="annottext">([GossipAtom] -&gt; [Int]) -&gt; [GossipAtom] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[GossipAtom]
</span><a href="#local-6989586621679058454"><span class="hs-identifier hs-var">initials</span></a></span><span> </span><span class="annot"><span class="annottext">[GossipAtom] -&gt; [GossipAtom] -&gt; [GossipAtom]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; [GossipAtom]
</span><a href="#local-6989586621679058452"><span class="hs-identifier hs-var">numbersOf</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058447"><span class="hs-identifier hs-var">ag</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span id="local-6989586621679058446"><span class="annot"><span class="annottext">observables :: Map Agent (Set Int)
</span><a href="#local-6989586621679058446"><span class="hs-identifier hs-var hs-var">observables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Agent, Set Int)] -&gt; Map Agent (Set Int)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058444"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Set Int) -&gt; [Int] -&gt; Set Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; [Int]
</span><a href="#local-6989586621679058448"><span class="hs-identifier hs-var">observablesOf</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058444"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679058444"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058444"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Agent]
</span><a href="#local-6989586621679058480"><span class="hs-identifier hs-var">agents</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Bdd -&gt; Map Agent (Set Int) -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-var">GKS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679058467"><span class="hs-identifier hs-var">vocabulary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058466"><span class="hs-identifier hs-var">stateLaw</span></a></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058446"><span class="hs-identifier hs-var">observables</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Converts an epistemic formula to a boolean formula, given a knowledge structure</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   in Gattinger (2018), `fromToBdd k &#981;` is denoted by ||&#981;||_k.</span><span>
</span><span id="line-280"></span><span class="annot"><a href="GossipKnowledge.html#formToBdd"><span class="hs-identifier hs-type">formToBdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-281"></span><span id="formToBdd"><span class="annot"><span class="annottext">formToBdd :: GossipKnowledgeStructure -&gt; Form -&gt; Bdd
</span><a href="GossipKnowledge.html#formToBdd"><span class="hs-identifier hs-var hs-var">formToBdd</span></a></span></span><span> </span><span id="local-6989586621679058443"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058443"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679058442"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058442"><span class="hs-identifier hs-var">form</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058442"><span class="hs-identifier hs-var">form</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="GossipKnowledge.html#Fact"><span class="hs-identifier hs-type">Fact</span></a></span><span> </span><span id="local-6989586621679058441"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058441"><span class="hs-identifier hs-var">bdd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058441"><span class="hs-identifier hs-var">bdd</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="GossipKnowledge.html#K"><span class="hs-identifier hs-type">K</span></a></span><span> </span><span id="local-6989586621679058440"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058440"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679058439"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058439"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Agent -&gt; Form -&gt; Bdd
</span><a href="#local-6989586621679058438"><span class="hs-identifier hs-var">knowledgeToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058443"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058440"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058439"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="GossipKnowledge.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679058437"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058437"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679058436"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058436"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#neg"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="annot"><span class="annottext">(Bdd -&gt; Bdd) -&gt; Bdd -&gt; Bdd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Agent -&gt; Form -&gt; Bdd
</span><a href="#local-6989586621679058438"><span class="hs-identifier hs-var">knowledgeToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058443"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058437"><span class="hs-identifier hs-var">ag</span></a></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058436"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679058438"><span class="annot"><span class="annottext">knowledgeToBdd :: GossipKnowledgeStructure -&gt; Agent -&gt; Form -&gt; Bdd
</span><a href="#local-6989586621679058438"><span class="hs-identifier hs-var hs-var">knowledgeToBdd</span></a></span></span><span> </span><span id="local-6989586621679058434"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679058433"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058433"><span class="hs-identifier hs-var">ag</span></a></span></span><span> </span><span id="local-6989586621679058432"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058432"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058431"><span class="annot"><span class="annottext">universe :: [Int]
</span><a href="#local-6989586621679058431"><span class="hs-identifier hs-var hs-var">universe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; [Int]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">(Set Int -&gt; [Int]) -&gt; Set Int -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Set Int
</span><a href="GossipKnowledge.html#vocabulary"><span class="hs-identifier hs-var hs-var">vocabulary</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Set Int
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Map Agent (Set Int)
</span><a href="GossipKnowledge.html#observables"><span class="hs-identifier hs-var hs-var">observables</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int) -&gt; Agent -&gt; Set Int
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-glyph hs-var">!</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058433"><span class="hs-identifier hs-var">ag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621679058430"><span class="annot"><span class="annottext">formula :: Bdd
</span><a href="#local-6989586621679058430"><span class="hs-identifier hs-var hs-var">formula</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058432"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><a href="GossipKnowledge.html#Fact"><span class="hs-identifier hs-type">Fact</span></a></span><span> </span><span id="local-6989586621679058429"><span class="annot"><a href="#local-6989586621679058429"><span class="hs-identifier hs-var">bdd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Bdd
</span><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier hs-var hs-var">stateLaw</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#imp"><span class="hs-operator hs-var">`imp`</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058429"><span class="hs-identifier hs-var">bdd</span></a></span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><a href="GossipKnowledge.html#K"><span class="hs-identifier hs-type">K</span></a></span><span> </span><span id="local-6989586621679058428"><span class="annot"><a href="#local-6989586621679058428"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679058427"><span class="annot"><a href="#local-6989586621679058427"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Bdd
</span><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier hs-var hs-var">stateLaw</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#imp"><span class="hs-operator hs-var">`imp`</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Agent -&gt; Form -&gt; Bdd
</span><a href="#local-6989586621679058438"><span class="hs-identifier hs-var">knowledgeToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058428"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058427"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><a href="GossipKnowledge.html#M"><span class="hs-identifier hs-type">M</span></a></span><span> </span><span id="local-6989586621679058426"><span class="annot"><a href="#local-6989586621679058426"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679058425"><span class="annot"><a href="#local-6989586621679058425"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#neg"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="annot"><span class="annottext">(Bdd -&gt; Bdd) -&gt; Bdd -&gt; Bdd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Bdd
</span><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier hs-var hs-var">stateLaw</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#imp"><span class="hs-operator hs-var">`imp`</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#neg"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Agent -&gt; Form -&gt; Bdd
</span><a href="#local-6989586621679058438"><span class="hs-identifier hs-var">knowledgeToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058426"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058425"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; [Int] -&gt; Bdd -&gt; Bdd
</span><a href="GossipKnowledge.html#gforallSet"><span class="hs-identifier hs-var">gforallSet</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058434"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679058431"><span class="hs-identifier hs-var">universe</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058430"><span class="hs-identifier hs-var">formula</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | An infix operator for the formToBdd function. </span><span>
</span><span id="line-297"></span><span class="annot"><a href="GossipKnowledge.html#%3C%7C%3E"><span class="hs-operator hs-type">(&lt;|&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#Form"><span class="hs-identifier hs-type">Form</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-298"></span><span id="local-6989586621679058423"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058423"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="%3C%7C%3E"><span class="annot"><span class="annottext">&lt;|&gt; :: GossipKnowledgeStructure -&gt; Form -&gt; Bdd
</span><a href="GossipKnowledge.html#%3C%7C%3E"><span class="hs-operator hs-var hs-var">&lt;|&gt;</span></a></span></span><span> </span><span id="local-6989586621679058422"><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058422"><span class="hs-identifier hs-var">&#981;</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Form -&gt; Bdd
</span><a href="GossipKnowledge.html#formToBdd"><span class="hs-identifier hs-var">formToBdd</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058423"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Form
</span><a href="#local-6989586621679058422"><span class="hs-identifier hs-var">&#981;</span></a></span><span>
</span><span id="line-299"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="GossipKnowledge.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- Private helper functions for Knowledge Structures</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Extracts the number of agents from the Knowledge Structure. </span><span>
</span><span id="line-305"></span><span class="annot"><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-type">nag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-306"></span><span id="nag"><span class="annot"><span class="annottext">nag :: GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var hs-var">nag</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679058421"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058421"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int) -&gt; Int
forall k a. Map k a -&gt; Int
</span><span class="hs-identifier hs-var">Map.size</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058421"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><a href="GossipKnowledge.html#gforall"><span class="hs-identifier hs-type">gforall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-309"></span><span id="gforall"><span class="annot"><span class="annottext">gforall :: GossipKnowledgeStructure -&gt; Int -&gt; Bdd -&gt; Bdd
</span><a href="GossipKnowledge.html#gforall"><span class="hs-identifier hs-var hs-var">gforall</span></a></span></span><span> </span><span id="local-6989586621679058419"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058419"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; (Int -&gt; String) -&gt; Int -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#foralll"><span class="hs-identifier hs-var">foralll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-var">strLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058419"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-var">texLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058419"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="GossipKnowledge.html#gexists"><span class="hs-identifier hs-type">gexists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-312"></span><span id="gexists"><span class="annot"><span class="annottext">gexists :: GossipKnowledgeStructure -&gt; Int -&gt; Bdd -&gt; Bdd
</span><a href="GossipKnowledge.html#gexists"><span class="hs-identifier hs-var hs-var">gexists</span></a></span></span><span> </span><span id="local-6989586621679058416"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058416"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; (Int -&gt; String) -&gt; Int -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#existsl"><span class="hs-identifier hs-var">existsl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-var">strLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058416"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-var">texLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058416"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="GossipKnowledge.html#gforallSet"><span class="hs-identifier hs-type">gforallSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-315"></span><span id="gforallSet"><span class="annot"><span class="annottext">gforallSet :: GossipKnowledgeStructure -&gt; [Int] -&gt; Bdd -&gt; Bdd
</span><a href="GossipKnowledge.html#gforallSet"><span class="hs-identifier hs-var hs-var">gforallSet</span></a></span></span><span> </span><span id="local-6989586621679058414"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058414"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; (Int -&gt; String) -&gt; [Int] -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#forallSetl"><span class="hs-identifier hs-var">forallSetl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-var">strLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058414"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-var">texLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058414"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="GossipKnowledge.html#gexistsSet"><span class="hs-identifier hs-type">gexistsSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span>
</span><span id="line-318"></span><span id="gexistsSet"><span class="annot"><span class="annottext">gexistsSet :: GossipKnowledgeStructure -&gt; [Int] -&gt; Bdd -&gt; Bdd
</span><a href="GossipKnowledge.html#gexistsSet"><span class="hs-identifier hs-var hs-var">gexistsSet</span></a></span></span><span> </span><span id="local-6989586621679058411"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058411"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; (Int -&gt; String) -&gt; [Int] -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#existsSetl"><span class="hs-identifier hs-var">existsSetl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#strLabel"><span class="hs-identifier hs-var">strLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058411"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><a href="GossipKnowledge.html#texLabel"><span class="hs-identifier hs-var">texLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; String) -&gt; Int -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058411"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">{- 
    Knowledge transformer for gossip 
-}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | The Knowledge Transformer data structure, as defined in (Gattinger, 2018).</span><span>
</span><span id="line-325"></span><span class="hs-keyword">data</span><span> </span><span id="KnowledgeTransformer"><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier hs-var">KnowledgeTransformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="KT"><span class="annot"><a href="GossipKnowledge.html#KT"><span class="hs-identifier hs-var">KT</span></a></span></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Additional vocabulary.</span><span>
</span><span id="line-327"></span><span>    </span><span id="addVocab"><span class="annot"><span class="annottext">KnowledgeTransformer -&gt; Set Int
</span><a href="GossipKnowledge.html#addVocab"><span class="hs-identifier hs-var hs-var">addVocab</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">-- | The event law.</span><span>
</span><span id="line-330"></span><span>    </span><span id="eventLaw"><span class="annot"><span class="annottext">KnowledgeTransformer -&gt; Bdd
</span><a href="GossipKnowledge.html#eventLaw"><span class="hs-identifier hs-var hs-var">eventLaw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PrintableBdd.html#Bdd"><span class="hs-identifier hs-type">Bdd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">-- | Additional observables.</span><span>
</span><span id="line-333"></span><span>    </span><span id="addObs"><span class="annot"><span class="annottext">KnowledgeTransformer -&gt; Map Agent (Set Int)
</span><a href="GossipKnowledge.html#addObs"><span class="hs-identifier hs-var hs-var">addObs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="GossipTypes.html#Agent"><span class="hs-identifier hs-type">Agent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | A base Knowledge Transformer structure, which will not change the Knowledge Structure.</span><span>
</span><span id="line-337"></span><span class="annot"><a href="GossipKnowledge.html#baseTransformer"><span class="hs-identifier hs-type">baseTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier hs-type">KnowledgeTransformer</span></a></span><span>
</span><span id="line-338"></span><span id="baseTransformer"><span class="annot"><span class="annottext">baseTransformer :: KnowledgeTransformer
</span><a href="GossipKnowledge.html#baseTransformer"><span class="hs-identifier hs-var hs-var">baseTransformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Bdd -&gt; Map Agent (Set Int) -&gt; KnowledgeTransformer
</span><a href="GossipKnowledge.html#KT"><span class="hs-identifier hs-var">KT</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="PrintableBdd.html#top"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Checks if a Knowledge Transformer is valid. Checks whether all atoms in the additional vocabulary are actually new, whether the event law only uses variables that are contained in either the original vocabulary or the additional vocabulary, and whether the additional observables are items from the additional vocabulary.</span><span>
</span><span id="line-341"></span><span class="annot"><a href="GossipKnowledge.html#validKT"><span class="hs-identifier hs-type">validKT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier hs-type">KnowledgeTransformer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-342"></span><span id="validKT"><span class="annot"><span class="annottext">validKT :: GossipKnowledgeStructure -&gt; KnowledgeTransformer -&gt; Bool
</span><a href="GossipKnowledge.html#validKT"><span class="hs-identifier hs-var hs-var">validKT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span> </span><span id="local-6989586621679058406"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058406"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679058405"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058405"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#KT"><span class="hs-identifier hs-type">KT</span></a></span><span> </span><span id="local-6989586621679058404"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058404"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679058403"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058403"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span id="local-6989586621679058402"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058402"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679058401"><span class="annot"><span class="annottext">vocabCheck :: Bool
</span><a href="#local-6989586621679058401"><span class="hs-identifier hs-var hs-var">vocabCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.disjoint</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058406"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058404"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-344"></span><span>      </span><span id="local-6989586621679058399"><span class="annot"><span class="annottext">lawCheck :: Bool
</span><a href="#local-6989586621679058399"><span class="hs-identifier hs-var hs-var">lawCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bdd -&gt; [Int]
</span><a href="PrintableBdd.html#allVarsOf"><span class="hs-identifier hs-var">allVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058403"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`isSubsetOf`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058406"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Set Int
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058404"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>      </span><span id="local-6989586621679058398"><span class="annot"><span class="annottext">obsCheck :: Bool
</span><a href="#local-6989586621679058398"><span class="hs-identifier hs-var hs-var">obsCheck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Int -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; Map Agent (Set Int) -&gt; Bool
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">Map.foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (Set Int -&gt; Bool) -&gt; Set Int -&gt; Bool -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`isSubsetOf`</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058404"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058402"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-346"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058401"><span class="hs-identifier hs-var">vocabCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058399"><span class="hs-identifier hs-var">lawCheck</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679058398"><span class="hs-identifier hs-var">obsCheck</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- | Updates a Knowledge Structure, given a Knowledge Transformer. </span><span>
</span><span id="line-349"></span><span class="annot"><a href="GossipKnowledge.html#update"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier hs-type">KnowledgeTransformer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span>
</span><span id="line-350"></span><span id="update"><span class="annot"><span class="annottext">update :: GossipKnowledgeStructure
-&gt; KnowledgeTransformer -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span> </span><span id="local-6989586621679058397"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058397"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679058396"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058396"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679058395"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058395"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GossipKnowledge.html#KT"><span class="hs-identifier hs-type">KT</span></a></span><span> </span><span id="local-6989586621679058394"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058394"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679058393"><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058393"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span id="local-6989586621679058392"><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058392"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GKS :: Set Int -&gt; Bdd -&gt; Map Agent (Set Int) -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#GKS"><span class="hs-identifier hs-type">GKS</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">vocabulary :: Set Int
</span><a href="GossipKnowledge.html#vocabulary"><span class="hs-identifier hs-var">vocabulary</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058397"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Set Int
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`union`</span></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058394"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">stateLaw :: Bdd
</span><a href="GossipKnowledge.html#stateLaw"><span class="hs-identifier hs-var">stateLaw</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058396"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd -&gt; Bdd -&gt; Bdd
</span><a href="PrintableBdd.html#con"><span class="hs-operator hs-var">`con`</span></a></span><span> </span><span class="annot"><span class="annottext">Bdd
</span><a href="#local-6989586621679058393"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">observables :: Map Agent (Set Int)
</span><a href="GossipKnowledge.html#observables"><span class="hs-identifier hs-var">observables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Int -&gt; Set Int -&gt; Set Int)
-&gt; Map Agent (Set Int)
-&gt; Map Agent (Set Int)
-&gt; Map Agent (Set Int)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">unionWith</span></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Set Int
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">union</span></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058395"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
</span><a href="#local-6989586621679058392"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | An infix operator for the `update` function. </span><span>
</span><span id="line-357"></span><span class="annot"><a href="GossipKnowledge.html#%7C%2B%7C"><span class="hs-operator hs-type">(|+|)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#KnowledgeTransformer"><span class="hs-identifier hs-type">KnowledgeTransformer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span>
</span><span id="line-358"></span><span id="local-6989586621679058391"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058391"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="%7C%2B%7C"><span class="annot"><span class="annottext">|+| :: GossipKnowledgeStructure
-&gt; KnowledgeTransformer -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#%7C%2B%7C"><span class="hs-operator hs-var hs-var">|+|</span></a></span></span><span> </span><span id="local-6989586621679058390"><span class="annot"><span class="annottext">KnowledgeTransformer
</span><a href="#local-6989586621679058390"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
-&gt; KnowledgeTransformer -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#update"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058391"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">KnowledgeTransformer
</span><a href="#local-6989586621679058390"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-359"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="annot"><a href="GossipKnowledge.html#%7C%2B%7C"><span class="hs-operator hs-type">|+|</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">{- 
    Update schemes for gossip calls
-}</span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Updates a Knowledge Structure for a given call made between two agents. The integer argument denotes the tick counter. </span><span>
</span><span id="line-367"></span><span class="annot"><a href="GossipKnowledge.html#updateWithCall"><span class="hs-identifier hs-type">updateWithCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipTypes.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GossipKnowledge.html#GossipKnowledgeStructure"><span class="hs-identifier hs-type">GossipKnowledgeStructure</span></a></span><span>
</span><span id="line-368"></span><span id="updateWithCall"><span class="annot"><span class="annottext">updateWithCall :: GossipKnowledgeStructure
-&gt; Int -&gt; (Agent, Agent) -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#updateWithCall"><span class="hs-identifier hs-var hs-var">updateWithCall</span></a></span></span><span> </span><span id="local-6989586621679058388"><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058388"><span class="hs-identifier hs-var">gks</span></a></span></span><span> </span><span id="local-6989586621679058387"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679058387"><span class="hs-identifier hs-var">ticks</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679058386"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679058385"><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058388"><span class="hs-identifier hs-var">gks</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
-&gt; KnowledgeTransformer -&gt; GossipKnowledgeStructure
</span><a href="GossipKnowledge.html#%7C%2B%7C"><span class="hs-operator hs-var">|+|</span></a></span><span> </span><span class="annot"><span class="annottext">KnowledgeTransformer
</span><a href="#local-6989586621679058384"><span class="hs-identifier hs-var">transformer</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679058384"><span class="annot"><span class="annottext">transformer :: KnowledgeTransformer
</span><a href="#local-6989586621679058384"><span class="hs-identifier hs-var hs-var">transformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnowledgeTransformer
</span><a href="GossipKnowledge.html#baseTransformer"><span class="hs-identifier hs-var">baseTransformer</span></a></span><span>
</span><span id="line-371"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">addObs :: Map Agent (Set Int)
</span><a href="GossipKnowledge.html#addObs"><span class="hs-identifier hs-var">addObs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Agent -&gt; Set Int -&gt; Map Agent (Set Int) -&gt; Map Agent (Set Int)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058382"><span class="hs-identifier hs-var">oa</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Agent (Set Int) -&gt; Map Agent (Set Int))
-&gt; (Map Agent (Set Int) -&gt; Map Agent (Set Int))
-&gt; Map Agent (Set Int)
-&gt; Map Agent (Set Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Agent -&gt; Set Int -&gt; Map Agent (Set Int) -&gt; Map Agent (Set Int)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679058381"><span class="hs-identifier hs-var">ob</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-372"></span><span>          </span><span class="hs-comment">--, eventLaw = xorSet $ map conSet allCallCombinations</span><span>
</span><span id="line-373"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>        </span><span id="local-6989586621679058380"><span class="annot"><span class="annottext">agents :: [Agent]
</span><a href="#local-6989586621679058380"><span class="hs-identifier hs-var hs-var">agents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Agent (Set Int) -&gt; [Agent]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map Agent (Set Int) -&gt; [Agent]) -&gt; Map Agent (Set Int) -&gt; [Agent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Map Agent (Set Int)
</span><a href="GossipKnowledge.html#observables"><span class="hs-identifier hs-var hs-var">observables</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058388"><span class="hs-identifier hs-var">gks</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-comment">--combinations = (. List.subsequences) . filter . (. length) . (==)</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-comment">--allCallCombinations = combinations ticks [gAtToBdd (nag gks) (GAt C x y) | x &lt;- agents, y &lt;- agents]</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>        </span><span id="local-6989586621679058382"><span class="annot"><span class="annottext">oa :: Set Int
</span><a href="#local-6989586621679058382"><span class="hs-identifier hs-var hs-var">oa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Set Int) -&gt; [Int] -&gt; Set Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; Int) -&gt; [GossipAtom] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; GossipAtom -&gt; Int
</span><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-var">gAtToInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; GossipAtom -&gt; Int) -&gt; Int -&gt; GossipAtom -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058388"><span class="hs-identifier hs-var">gks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-381"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-382"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-383"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679058381"><span class="annot"><span class="annottext">ob :: Set Int
</span><a href="#local-6989586621679058381"><span class="hs-identifier hs-var hs-var">ob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Set Int) -&gt; [Int] -&gt; Set Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GossipAtom -&gt; Int) -&gt; [GossipAtom] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; GossipAtom -&gt; Int
</span><a href="GossipKnowledge.html#gAtToInt"><span class="hs-identifier hs-var">gAtToInt</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; GossipAtom -&gt; Int) -&gt; Int -&gt; GossipAtom -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure -&gt; Int
</span><a href="GossipKnowledge.html#nag"><span class="hs-identifier hs-var">nag</span></a></span><span> </span><span class="annot"><span class="annottext">GossipKnowledgeStructure
</span><a href="#local-6989586621679058388"><span class="hs-identifier hs-var">gks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-388"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-389"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#S"><span class="hs-identifier hs-var">S</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-391"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rel -&gt; Agent -&gt; Agent -&gt; GossipAtom
</span><a href="GossipKnowledge.html#GAt"><span class="hs-identifier hs-var">GAt</span></a></span><span> </span><span class="annot"><span class="annottext">Rel
</span><a href="GossipKnowledge.html#N"><span class="hs-identifier hs-var">N</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058385"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Agent
</span><a href="#local-6989586621679058386"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-392"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-393"></span></pre></body></html>