<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_Gaa9GlpHRvq3UpgINOCBrX"></span><span class="hs-comment">-- | Alternative Maximum Flow</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.Query.MaxFlow2</span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier">Network</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimple"><span class="hs-identifier">ekSimple</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFused"><span class="hs-identifier">ekFused</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekList"><span class="hs-identifier">ekList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">--   ekSimple, ekFused, ekList) where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Queue.html"><span class="hs-identifier">Data.Graph.Inductive.Internal.Queue</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html"><span class="hs-identifier">Data.Graph.Inductive.PatriciaTree</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.BFS.html"><span class="hs-identifier">Data.Graph.Inductive.Query.BFS</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.BFS.html#bft"><span class="hs-identifier">bft</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- Data types</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Network data type</span><span>
</span><span id="line-24"></span><span class="hs-keyword">type</span><span> </span><span id="Network"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-var">Network</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- Data type for direction in which an edge is traversed</span><span>
</span><span id="line-27"></span><span class="hs-keyword">data</span><span> </span><span id="Direction"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Forward"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Backward"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077474"><span id="local-6989586621679077476"><span class="annot"><span class="annottext">Direction -&gt; Direction -&gt; Bool
(Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Bool) -&gt; Eq Direction
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Direction -&gt; Direction -&gt; Bool
$c/= :: Direction -&gt; Direction -&gt; Bool
== :: Direction -&gt; Direction -&gt; Bool
$c== :: Direction -&gt; Direction -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077458"><span id="local-6989586621679077460"><span id="local-6989586621679077462"><span id="local-6989586621679077464"><span id="local-6989586621679077466"><span id="local-6989586621679077468"><span id="local-6989586621679077470"><span class="annot"><span class="annottext">Eq Direction
Eq Direction
-&gt; (Direction -&gt; Direction -&gt; Ordering)
-&gt; (Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Direction)
-&gt; (Direction -&gt; Direction -&gt; Direction)
-&gt; Ord Direction
Direction -&gt; Direction -&gt; Bool
Direction -&gt; Direction -&gt; Ordering
Direction -&gt; Direction -&gt; Direction
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Direction -&gt; Direction -&gt; Direction
$cmin :: Direction -&gt; Direction -&gt; Direction
max :: Direction -&gt; Direction -&gt; Direction
$cmax :: Direction -&gt; Direction -&gt; Direction
&gt;= :: Direction -&gt; Direction -&gt; Bool
$c&gt;= :: Direction -&gt; Direction -&gt; Bool
&gt; :: Direction -&gt; Direction -&gt; Bool
$c&gt; :: Direction -&gt; Direction -&gt; Bool
&lt;= :: Direction -&gt; Direction -&gt; Bool
$c&lt;= :: Direction -&gt; Direction -&gt; Bool
&lt; :: Direction -&gt; Direction -&gt; Bool
$c&lt; :: Direction -&gt; Direction -&gt; Bool
compare :: Direction -&gt; Direction -&gt; Ordering
$ccompare :: Direction -&gt; Direction -&gt; Ordering
$cp1Ord :: Eq Direction
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077451"><span id="local-6989586621679077453"><span id="local-6989586621679077455"><span class="annot"><span class="annottext">Int -&gt; Direction -&gt; ShowS
[Direction] -&gt; ShowS
Direction -&gt; String
(Int -&gt; Direction -&gt; ShowS)
-&gt; (Direction -&gt; String)
-&gt; ([Direction] -&gt; ShowS)
-&gt; Show Direction
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Direction] -&gt; ShowS
$cshowList :: [Direction] -&gt; ShowS
show :: Direction -&gt; String
$cshow :: Direction -&gt; String
showsPrec :: Int -&gt; Direction -&gt; ShowS
$cshowsPrec :: Int -&gt; Direction -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077442"><span id="local-6989586621679077444"><span id="local-6989586621679077446"><span id="local-6989586621679077448"><span class="annot"><span class="annottext">ReadPrec [Direction]
ReadPrec Direction
Int -&gt; ReadS Direction
ReadS [Direction]
(Int -&gt; ReadS Direction)
-&gt; ReadS [Direction]
-&gt; ReadPrec Direction
-&gt; ReadPrec [Direction]
-&gt; Read Direction
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Direction]
$creadListPrec :: ReadPrec [Direction]
readPrec :: ReadPrec Direction
$creadPrec :: ReadPrec Direction
readList :: ReadS [Direction]
$creadList :: ReadS [Direction]
readsPrec :: Int -&gt; ReadS Direction
$creadsPrec :: Int -&gt; ReadS Direction
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Data type for edge with direction of traversal</span><span>
</span><span id="line-31"></span><span class="hs-keyword">type</span><span> </span><span id="DirEdge"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-var">DirEdge</span></a></span></span><span> </span><span id="local-6989586621679077440"><span class="annot"><a href="#local-6989586621679077440"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077440"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">type</span><span> </span><span id="DirPath"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-var">DirPath</span></a></span></span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-34"></span><span class="hs-keyword">type</span><span> </span><span id="DirRTree"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirRTree"><span class="hs-identifier hs-var">DirRTree</span></a></span></span><span class="hs-glyph">=</span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-type">DirPath</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#pathFromDirPath"><span class="hs-identifier hs-type">pathFromDirPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-type">DirPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-37"></span><span id="pathFromDirPath"><span class="annot"><span class="annottext">pathFromDirPath :: DirPath -&gt; [Int]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#pathFromDirPath"><span class="hs-identifier hs-var hs-var">pathFromDirPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Direction) -&gt; Int) -&gt; DirPath -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Int, Direction) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- Example networks</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Example number 1</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- This network has a maximum flow of 2000</span><span>
</span><span id="line-44"></span><span class="hs-comment">{-
exampleNetwork1 :: Network
exampleNetwork1=mkGraph [ (1,()), (2,()), (3,()), (4,()) ]
    [ (1,2,(1000,0)), (1,3,(1000,0)),
    (2,3,(1,0)), (2,4,(1000,0)), (3,4,(1000,0)) ]

-- Example number 2
-- Taken from &quot;Introduction to Algorithms&quot; (Cormen, Leiserson, Rivest)
-- This network has a maximum flow of 23
exampleNetwork2 :: Network
-- Names of nodes in &quot;Introduction to Algorithms&quot;:
-- 1: s
-- 2: v1
-- 3: v2
-- 4: v3
-- 5: v4
-- 6: t
exampleNetwork2=mkGraph [ (1,()), (2,()), (3,()), (4,()), (5,()), (6,()) ]
    [ (1, 2, (16, 0)),
    (1, 3, (13, 0)),
    (2, 3, (10, 0)),
    (3, 2, (4, 0)),
    (2, 4, (12, 0)),
    (3, 5, (14, 0)),
    (4, 3, (9, 0)),
    (5, 4, (7, 0)),
    (4, 6, (20, 0)),
    (5, 6, (4, 0)) ]
-}</span><span>
</span><span id="line-73"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Implementation of Edmonds-Karp algorithm</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- EXTRACT fglEdmondsFused.txt</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Compute an augmenting path</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPathFused"><span class="hs-identifier hs-type">augPathFused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-type">DirPath</span></a></span><span>
</span><span id="line-79"></span><span id="augPathFused"><span class="annot"><span class="annottext">augPathFused :: Network -&gt; Int -&gt; Int -&gt; Maybe DirPath
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPathFused"><span class="hs-identifier hs-var hs-var">augPathFused</span></a></span></span><span> </span><span id="local-6989586621679077435"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077435"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077434"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077434"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077433"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077433"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DirPath] -&gt; Maybe DirPath
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([DirPath] -&gt; Maybe DirPath) -&gt; [DirPath] -&gt; Maybe DirPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DirPath -&gt; DirPath) -&gt; [DirPath] -&gt; [DirPath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DirPath -&gt; DirPath
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([DirPath] -&gt; [DirPath]) -&gt; [DirPath] -&gt; [DirPath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">(DirPath -&gt; Bool) -&gt; [DirPath] -&gt; [DirPath]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077430"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077430"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077430"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077433"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DirPath]
</span><a href="#local-6989586621679077429"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077429"><span class="annot"><span class="annottext">tree :: [DirPath]
</span><a href="#local-6989586621679077429"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bftForEK"><span class="hs-identifier hs-var">bftForEK</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077434"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077435"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- Breadth First Search wrapper function</span><span>
</span><span id="line-84"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bftForEK"><span class="hs-identifier hs-type">bftForEK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirRTree"><span class="hs-identifier hs-type">DirRTree</span></a></span><span>
</span><span id="line-85"></span><span id="bftForEK"><span class="annot"><span class="annottext">bftForEK :: Int -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bftForEK"><span class="hs-identifier hs-var hs-var">bftForEK</span></a></span></span><span> </span><span id="local-6989586621679077427"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077427"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Queue DirPath -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bfForEK"><span class="hs-identifier hs-var">bfForEK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DirPath -&gt; Queue DirPath -&gt; Queue DirPath
forall a. a -&gt; Queue a -&gt; Queue a
</span><a href="Data.Graph.Inductive.Internal.Queue.html#queuePut"><span class="hs-identifier hs-var">queuePut</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077427"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Queue DirPath
forall a. Queue a
</span><a href="Data.Graph.Inductive.Internal.Queue.html#mkQueue"><span class="hs-identifier hs-var">mkQueue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- Breadth First Search, tailored for Edmonds &amp; Karp</span><span>
</span><span id="line-88"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bfForEK"><span class="hs-identifier hs-type">bfForEK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Queue.html#Queue"><span class="hs-identifier hs-type">Queue</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-type">DirPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirRTree"><span class="hs-identifier hs-type">DirRTree</span></a></span><span>
</span><span id="line-89"></span><span id="bfForEK"><span class="annot"><span class="annottext">bfForEK :: Queue DirPath -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bfForEK"><span class="hs-identifier hs-var hs-var">bfForEK</span></a></span></span><span> </span><span id="local-6989586621679077423"><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077423"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679077422"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077422"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Queue DirPath -&gt; Bool
forall a. Queue a -&gt; Bool
</span><a href="Data.Graph.Inductive.Internal.Queue.html#queueEmpty"><span class="hs-identifier hs-var">queueEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077423"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Network -&gt; Bool
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; Bool
</span><a href="Data.Graph.Inductive.Graph.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077422"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Network -&gt; Decomp Gr () (Double, Double)
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
Int -&gt; gr a b -&gt; Decomp gr a b
</span><a href="Data.Graph.Inductive.Graph.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077417"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077422"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context () (Double, Double))
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077416"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077416"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Queue DirPath -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bfForEK"><span class="hs-identifier hs-var">bfForEK</span></a></span><span> </span><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077415"><span class="hs-identifier hs-var">q1</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077416"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077414"><span class="annot"><span class="annottext">Adj (Double, Double)
</span><a href="#local-6989586621679077414"><span class="hs-identifier hs-var">preAdj</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077413"><span class="annot"><span class="annottext">Adj (Double, Double)
</span><a href="#local-6989586621679077413"><span class="hs-identifier hs-var">sucAdj</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077412"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077412"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DirPath
</span><a href="#local-6989586621679077411"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">DirPath -&gt; [DirPath] -&gt; [DirPath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Queue DirPath -&gt; Network -&gt; [DirPath]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#bfForEK"><span class="hs-identifier hs-var">bfForEK</span></a></span><span> </span><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077410"><span class="hs-identifier hs-var">q2</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077412"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-94"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>                </span><span class="hs-comment">-- Insert successor nodes (with path to root) into queue</span><span>
</span><span id="line-96"></span><span>                </span><span id="local-6989586621679077410"><span class="annot"><span class="annottext">q2 :: Queue DirPath
</span><a href="#local-6989586621679077410"><span class="hs-identifier hs-var hs-var">q2</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DirPath] -&gt; Queue DirPath -&gt; Queue DirPath
forall a. [a] -&gt; Queue a -&gt; Queue a
</span><a href="Data.Graph.Inductive.Internal.Queue.html#queuePutList"><span class="hs-identifier hs-var">queuePutList</span></a></span><span> </span><span class="annot"><span class="annottext">[DirPath]
</span><a href="#local-6989586621679077408"><span class="hs-identifier hs-var">suc1</span></a></span><span> </span><span class="annot"><span class="annottext">(Queue DirPath -&gt; Queue DirPath) -&gt; Queue DirPath -&gt; Queue DirPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DirPath] -&gt; Queue DirPath -&gt; Queue DirPath
forall a. [a] -&gt; Queue a -&gt; Queue a
</span><a href="Data.Graph.Inductive.Internal.Queue.html#queuePutList"><span class="hs-identifier hs-var">queuePutList</span></a></span><span> </span><span class="annot"><span class="annottext">[DirPath]
</span><a href="#local-6989586621679077407"><span class="hs-identifier hs-var">suc2</span></a></span><span> </span><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077415"><span class="hs-identifier hs-var">q1</span></a></span><span>
</span><span id="line-97"></span><span>                </span><span class="hs-comment">-- Traverse edges in reverse if flow positive</span><span>
</span><span id="line-98"></span><span>                </span><span id="local-6989586621679077408"><span class="annot"><span class="annottext">suc1 :: [DirPath]
</span><a href="#local-6989586621679077408"><span class="hs-identifier hs-var hs-var">suc1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077406"><span class="hs-identifier hs-var">preNode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Int, Direction) -&gt; DirPath -&gt; DirPath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">DirPath
</span><a href="#local-6989586621679077411"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-99"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077405"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077405"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077406"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077406"><span class="hs-identifier hs-var">preNode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Adj (Double, Double)
</span><a href="#local-6989586621679077414"><span class="hs-identifier hs-var">preAdj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077405"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-comment">-- Traverse edges forwards if flow less than capacity</span><span>
</span><span id="line-101"></span><span>                </span><span id="local-6989586621679077407"><span class="annot"><span class="annottext">suc2 :: [DirPath]
</span><a href="#local-6989586621679077407"><span class="hs-identifier hs-var hs-var">suc2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077403"><span class="hs-identifier hs-var">sucNode</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Int, Direction) -&gt; DirPath -&gt; DirPath
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">DirPath
</span><a href="#local-6989586621679077411"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-102"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077402"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077402"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077401"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077401"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077403"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077403"><span class="hs-identifier hs-var">sucNode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Adj (Double, Double)
</span><a href="#local-6989586621679077413"><span class="hs-identifier hs-var">sucAdj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077402"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077401"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077411"><span class="annot"><span class="annottext">p :: DirPath
</span><a href="#local-6989586621679077411"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077417"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077417"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077415"><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077415"><span class="hs-identifier hs-var">q1</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Queue DirPath -&gt; (DirPath, Queue DirPath)
forall a. Queue a -&gt; (a, Queue a)
</span><a href="Data.Graph.Inductive.Internal.Queue.html#queueGet"><span class="hs-identifier hs-var">queueGet</span></a></span><span> </span><span class="annot"><span class="annottext">Queue DirPath
</span><a href="#local-6989586621679077423"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Extract augmenting path from network; return path as a sequence of</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- edges with direction of traversal, and new network with augmenting</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- path removed.</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-type">extractPathFused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirPath"><span class="hs-identifier hs-type">DirPath</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-type">DirEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="extractPathFused"><span class="annot"><span class="annottext">extractPathFused :: Network -&gt; DirPath -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var hs-var">extractPathFused</span></a></span></span><span> </span><span id="local-6989586621679077398"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077398"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077398"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span id="local-6989586621679077397"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077397"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077397"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span id="local-6989586621679077396"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077396"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077395"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077395"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077394"><span class="annot"><span class="annottext">rest :: DirPath
</span><a href="#local-6989586621679077394"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077393"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077393"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077395"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077393"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077392"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077391"><span class="hs-identifier hs-var">tailedges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077390"><span class="hs-identifier hs-var">newerg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077391"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077391"><span class="hs-identifier hs-var">tailedges</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077390"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077390"><span class="hs-identifier hs-var">newerg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; DirPath -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077389"><span class="hs-identifier hs-var">newg</span></a></span><span> </span><span class="annot"><span class="annottext">DirPath
</span><a href="#local-6989586621679077394"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-115"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077392"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077392"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077389"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077389"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
-&gt; Int
-&gt; Int
-&gt; ((Double, Double) -&gt; Bool)
-&gt; Maybe ((Double, Double), Network)
forall a b.
Gr a b -&gt; Int -&gt; Int -&gt; (b -&gt; Bool) -&gt; Maybe (b, Gr a b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-var">extractEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077396"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077395"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077393"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Bool) -&gt; (Double, Double) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span id="local-6989586621679077386"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077386"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077385"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077385"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077384"><span class="annot"><span class="annottext">rest :: DirPath
</span><a href="#local-6989586621679077384"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679077383"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077383"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077383"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077385"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077382"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077381"><span class="hs-identifier hs-var">tailedges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077380"><span class="hs-identifier hs-var">newerg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077381"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077381"><span class="hs-identifier hs-var">tailedges</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077380"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077380"><span class="hs-identifier hs-var">newerg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; DirPath -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077379"><span class="hs-identifier hs-var">newg</span></a></span><span> </span><span class="annot"><span class="annottext">DirPath
</span><a href="#local-6989586621679077384"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-119"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077382"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077382"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077379"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077379"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
-&gt; Int
-&gt; Int
-&gt; ((Double, Double) -&gt; Bool)
-&gt; Maybe ((Double, Double), Network)
forall a b.
Gr a b -&gt; Int -&gt; Int -&gt; (b -&gt; Bool) -&gt; Maybe (b, Gr a b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-var">extractEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077386"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077383"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077385"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077378"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077378"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077378"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFusedStep"><span class="hs-identifier hs-type">ekFusedStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#EKStepFunc"><span class="hs-identifier hs-type">EKStepFunc</span></a></span><span>
</span><span id="line-122"></span><span id="ekFusedStep"><span class="annot"><span class="annottext">ekFusedStep :: EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFusedStep"><span class="hs-identifier hs-var hs-var">ekFusedStep</span></a></span></span><span> </span><span id="local-6989586621679077376"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077376"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077375"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077375"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077374"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DirPath
</span><a href="#local-6989586621679077373"><span class="hs-identifier hs-var">maybePath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">(Network, Double) -&gt; Maybe (Network, Double)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LEdge (Double, Double)] -&gt; Network -&gt; Network
forall (gr :: * -&gt; * -&gt; *) b a.
DynGraph gr =&gt;
[LEdge b] -&gt; gr a b -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#insEdges"><span class="hs-identifier hs-var">insEdges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077370"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077369"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077368"><span class="hs-identifier hs-var">newg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077369"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="annottext">Maybe DirPath
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Network, Double)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077373"><span class="annot"><span class="annottext">maybePath :: Maybe DirPath
</span><a href="#local-6989586621679077373"><span class="hs-identifier hs-var hs-var">maybePath</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Int -&gt; Int -&gt; Maybe DirPath
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPathFused"><span class="hs-identifier hs-var">augPathFused</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077376"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077375"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077374"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-127"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679077370"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077370"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077368"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077368"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; DirPath -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathFused"><span class="hs-identifier hs-var">extractPathFused</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077376"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DirPath -&gt; DirPath
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe DirPath
</span><a href="#local-6989586621679077373"><span class="hs-identifier hs-var">maybePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>          </span><span id="local-6989586621679077369"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679077369"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077370"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFused"><span class="hs-identifier hs-type">ekFused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="ekFused"><span class="annot"><span class="annottext">ekFused :: Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFused"><span class="hs-identifier hs-var hs-var">ekFused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EKStepFunc -&gt; Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-var">ekWith</span></a></span><span> </span><span class="annot"><span class="annottext">EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekFusedStep"><span class="hs-identifier hs-var">ekFusedStep</span></a></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- ENDEXTRACT</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- Alternative implementation: Use an explicit residual graph</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- EXTRACT fglEdmondsSimple.txt</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#residualGraph"><span class="hs-identifier hs-type">residualGraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-139"></span><span id="residualGraph"><span class="annot"><span class="annottext">residualGraph :: Network -&gt; Gr () Double
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#residualGraph"><span class="hs-identifier hs-var hs-var">residualGraph</span></a></span></span><span> </span><span id="local-6989586621679077362"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077362"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">[LNode ()] -&gt; [LEdge Double] -&gt; Gr () Double
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-var">mkGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network -&gt; [LNode ()]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><a href="Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var">labNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077362"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077359"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077358"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077357"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077356"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077359"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077359"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077358"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077358"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077357"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077357"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077356"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077356"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Network -&gt; [LEdge (Double, Double)]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077362"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077357"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077356"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[LEdge Double] -&gt; [LEdge Double] -&gt; [LEdge Double]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077354"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077353"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077352"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077353"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077354"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077352"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077352"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Network -&gt; [LEdge (Double, Double)]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077362"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077352"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPath"><span class="hs-identifier hs-type">augPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-145"></span><span id="augPath"><span class="annot"><span class="annottext">augPath :: Network -&gt; Int -&gt; Int -&gt; Maybe [Int]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPath"><span class="hs-identifier hs-var hs-var">augPath</span></a></span></span><span> </span><span id="local-6989586621679077349"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077349"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077348"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077348"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077347"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077347"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Int]] -&gt; Maybe [Int]
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([[Int]] -&gt; Maybe [Int]) -&gt; [[Int]] -&gt; Maybe [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [[Int]] -&gt; [[Int]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [Int]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([[Int]] -&gt; [[Int]]) -&gt; [[Int]] -&gt; [[Int]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Bool) -&gt; [[Int]] -&gt; [[Int]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679077346"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077346"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077346"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077347"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679077345"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077345"><span class="annot"><span class="annottext">tree :: [[Int]]
</span><a href="#local-6989586621679077345"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gr () Double -&gt; [[Int]]
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
Int -&gt; gr a b -&gt; [[Int]]
</span><a href="Data.Graph.Inductive.Query.BFS.html#bft"><span class="hs-identifier hs-var">bft</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077348"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network -&gt; Gr () Double
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#residualGraph"><span class="hs-identifier hs-var">residualGraph</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077349"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Extract augmenting path from network; return path as a sequence of</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- edges with direction of traversal, and new network with augmenting</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- path removed.</span><span>
</span><span id="line-151"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-type">extractPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-type">DirEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="extractPath"><span class="annot"><span class="annottext">extractPath :: Network -&gt; [Int] -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var hs-var">extractPath</span></a></span></span><span> </span><span id="local-6989586621679077343"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077343"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077343"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var">extractPath</span></a></span><span> </span><span id="local-6989586621679077342"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077342"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077342"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var">extractPath</span></a></span><span> </span><span id="local-6989586621679077341"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077341"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077340"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077339"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077338"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679077338"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ((Double, Double), Network)
</span><a href="#local-6989586621679077337"><span class="hs-identifier hs-var">fwdExtract</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077336"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077336"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077335"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077335"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077336"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077334"><span class="hs-identifier hs-var">tailedges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077333"><span class="hs-identifier hs-var">newerg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077334"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077334"><span class="hs-identifier hs-var">tailedges</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077333"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077333"><span class="hs-identifier hs-var">newerg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; [Int] -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var">extractPath</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077335"><span class="hs-identifier hs-var">newg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679077338"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">Maybe ((Double, Double), Network)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ((Double, Double), Network)
</span><a href="#local-6989586621679077332"><span class="hs-identifier hs-var">revExtract</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077331"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077331"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077330"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077330"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>                    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077331"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077329"><span class="hs-identifier hs-var">tailedges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077328"><span class="hs-identifier hs-var">newerg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>                    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077329"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077329"><span class="hs-identifier hs-var">tailedges</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077328"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077328"><span class="hs-identifier hs-var">newerg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; [Int] -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var">extractPath</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077330"><span class="hs-identifier hs-var">newg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679077338"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                </span><span class="annot"><span class="annottext">Maybe ((Double, Double), Network)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([DirEdge (Double, Double)], Network)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;extractPath: revExtract == Nothing&quot;</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077337"><span class="annot"><span class="annottext">fwdExtract :: Maybe ((Double, Double), Network)
</span><a href="#local-6989586621679077337"><span class="hs-identifier hs-var hs-var">fwdExtract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
-&gt; Int
-&gt; Int
-&gt; ((Double, Double) -&gt; Bool)
-&gt; Maybe ((Double, Double), Network)
forall a b.
Gr a b -&gt; Int -&gt; Int -&gt; (b -&gt; Bool) -&gt; Maybe (b, Gr a b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-var">extractEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077341"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Bool) -&gt; (Double, Double) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>          </span><span id="local-6989586621679077332"><span class="annot"><span class="annottext">revExtract :: Maybe ((Double, Double), Network)
</span><a href="#local-6989586621679077332"><span class="hs-identifier hs-var hs-var">revExtract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network
-&gt; Int
-&gt; Int
-&gt; ((Double, Double) -&gt; Bool)
-&gt; Maybe ((Double, Double), Network)
forall a b.
Gr a b -&gt; Int -&gt; Int -&gt; (b -&gt; Bool) -&gt; Maybe (b, Gr a b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-var">extractEdge</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077341"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077339"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077340"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Bool)
-&gt; ((Double, Double) -&gt; Double) -&gt; (Double, Double) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Extract an edge from the graph that satisfies a given predicate</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Return the label on the edge and the graph without the edge</span><span>
</span><span id="line-169"></span><span id="local-6989586621679077530"><span id="local-6989586621679077531"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-type">extractEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077531"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077530"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077530"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077530"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077531"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077530"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-170"></span><span id="extractEdge"><span class="annot"><span class="annottext">extractEdge :: Gr a b -&gt; Int -&gt; Int -&gt; (b -&gt; Bool) -&gt; Maybe (b, Gr a b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractEdge"><span class="hs-identifier hs-var hs-var">extractEdge</span></a></span></span><span> </span><span id="local-6989586621679077325"><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679077325"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077324"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077324"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679077323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077323"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679077322"><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679077322"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Int)
</span><a href="#local-6989586621679077321"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077320"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077320"><span class="hs-identifier hs-var">el</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b, Gr a b) -&gt; Maybe (b, Gr a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077320"><span class="hs-identifier hs-var">el</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077319"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077318"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077317"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077316"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Gr a b -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
DynGraph gr =&gt;
Context a b -&gt; gr a b -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#%26"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679077314"><span class="hs-identifier hs-var">newg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">Maybe (b, Int)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (b, Gr a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077319"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077319"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077318"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077318"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077317"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077317"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077313"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077313"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077314"><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679077314"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gr a b -&gt; (Maybe (Context a b), Gr a b)
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
Int -&gt; gr a b -&gt; Decomp gr a b
</span><a href="Data.Graph.Inductive.Graph.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077324"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679077325"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679077321"><span class="annot"><span class="annottext">Maybe (b, Int)
</span><a href="#local-6989586621679077321"><span class="hs-identifier hs-var">adj</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077316"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077316"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Adj b -&gt; ((b, Int) -&gt; Bool) -&gt; (Maybe (b, Int), Adj b)
forall b. Adj b -&gt; ((b, Int) -&gt; Bool) -&gt; (Maybe (b, Int), Adj b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractAdj"><span class="hs-identifier hs-var">extractAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077313"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-176"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679077311"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077311"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077310"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077310"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077310"><span class="hs-identifier hs-var">dest</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077323"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679077322"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077311"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- Extract an item from an adjacency list that satisfies a given</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- predicate. Return the item and the rest of the adjacency list</span><span>
</span><span id="line-180"></span><span id="local-6989586621679077492"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractAdj"><span class="hs-identifier hs-type">extractAdj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077492"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077492"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077492"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077492"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-181"></span><span id="extractAdj"><span class="annot"><span class="annottext">extractAdj :: Adj b -&gt; ((b, Int) -&gt; Bool) -&gt; (Maybe (b, Int), Adj b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractAdj"><span class="hs-identifier hs-var hs-var">extractAdj</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="annot"><span class="annottext">(b, Int) -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (b, Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractAdj"><span class="hs-identifier hs-var">extractAdj</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077308"><span class="annot"><span class="annottext">(b, Int)
</span><a href="#local-6989586621679077308"><span class="hs-identifier hs-var">adj</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077307"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077307"><span class="hs-identifier hs-var">adjs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679077306"><span class="annot"><span class="annottext">(b, Int) -&gt; Bool
</span><a href="#local-6989586621679077306"><span class="hs-identifier hs-var">p</span></a></span></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(b, Int) -&gt; Bool
</span><a href="#local-6989586621679077306"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(b, Int)
</span><a href="#local-6989586621679077308"><span class="hs-identifier hs-var">adj</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b, Int) -&gt; Maybe (b, Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(b, Int)
</span><a href="#local-6989586621679077308"><span class="hs-identifier hs-var">adj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077307"><span class="hs-identifier hs-var">adjs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (b, Int)
</span><a href="#local-6989586621679077305"><span class="hs-identifier hs-var">theone</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(b, Int)
</span><a href="#local-6989586621679077308"><span class="hs-identifier hs-var">adj</span></a></span><span class="annot"><span class="annottext">(b, Int) -&gt; Adj b -&gt; Adj b
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077304"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077305"><span class="annot"><span class="annottext">Maybe (b, Int)
</span><a href="#local-6989586621679077305"><span class="hs-identifier hs-var">theone</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077304"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077304"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Adj b -&gt; ((b, Int) -&gt; Bool) -&gt; (Maybe (b, Int), Adj b)
forall b. Adj b -&gt; ((b, Int) -&gt; Bool) -&gt; (Maybe (b, Int), Adj b)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractAdj"><span class="hs-identifier hs-var">extractAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077307"><span class="hs-identifier hs-var">adjs</span></a></span><span> </span><span class="annot"><span class="annottext">(b, Int) -&gt; Bool
</span><a href="#local-6989586621679077306"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-type">getPathDeltas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-type">DirEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span id="getPathDeltas"><span class="annot"><span class="annottext">getPathDeltas :: [DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var hs-var">getPathDeltas</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077303"><span class="annot"><span class="annottext">DirEdge (Double, Double)
</span><a href="#local-6989586621679077303"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077302"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077302"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DirEdge (Double, Double)
</span><a href="#local-6989586621679077303"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077301"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077301"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077300"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077300"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077301"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077300"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Double] -&gt; [Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077302"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077299"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077299"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077299"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; [Double] -&gt; [Double]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077302"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-type">integrateDelta</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-type">DirEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span id="integrateDelta"><span class="annot"><span class="annottext">integrateDelta :: [DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var hs-var">integrateDelta</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077298"><span class="annot"><span class="annottext">DirEdge (Double, Double)
</span><a href="#local-6989586621679077298"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077297"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077297"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679077296"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077296"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DirEdge (Double, Double)
</span><a href="#local-6989586621679077298"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679077295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077295"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077294"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077293"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077293"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077292"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077292"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077295"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077294"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077293"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077292"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077296"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LEdge (Double, Double)
-&gt; [LEdge (Double, Double)] -&gt; [LEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077297"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077296"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679077290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077290"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077289"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077289"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077288"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077288"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077287"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077287"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077290"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077289"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077288"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077287"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077296"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LEdge (Double, Double)
-&gt; [LEdge (Double, Double)] -&gt; [LEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077297"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077296"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">type</span><span> </span><span id="EKStepFunc"><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#EKStepFunc"><span class="hs-identifier hs-var">EKStepFunc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimpleStep"><span class="hs-identifier hs-type">ekSimpleStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#EKStepFunc"><span class="hs-identifier hs-type">EKStepFunc</span></a></span><span>
</span><span id="line-205"></span><span id="ekSimpleStep"><span class="annot"><span class="annottext">ekSimpleStep :: EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimpleStep"><span class="hs-identifier hs-var hs-var">ekSimpleStep</span></a></span></span><span> </span><span id="local-6989586621679077285"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077285"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077284"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077284"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077283"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077283"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [Int]
</span><a href="#local-6989586621679077282"><span class="hs-identifier hs-var">maybePath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">(Network, Double) -&gt; Maybe (Network, Double)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LEdge (Double, Double)] -&gt; Network -&gt; Network
forall (gr :: * -&gt; * -&gt; *) b a.
DynGraph gr =&gt;
[LEdge b] -&gt; gr a b -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#insEdges"><span class="hs-identifier hs-var">insEdges</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077281"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077280"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077279"><span class="hs-identifier hs-var">newg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077280"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Int]
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Network, Double)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077282"><span class="annot"><span class="annottext">maybePath :: Maybe [Int]
</span><a href="#local-6989586621679077282"><span class="hs-identifier hs-var hs-var">maybePath</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Int -&gt; Int -&gt; Maybe [Int]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPath"><span class="hs-identifier hs-var">augPath</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077285"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077284"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077283"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679077281"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077281"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077279"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077279"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; [Int] -&gt; ([DirEdge (Double, Double)], Network)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPath"><span class="hs-identifier hs-var">extractPath</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077285"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Int] -&gt; [Int]
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Int]
</span><a href="#local-6989586621679077282"><span class="hs-identifier hs-var">maybePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>          </span><span id="local-6989586621679077280"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679077280"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077281"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-type">ekWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#EKStepFunc"><span class="hs-identifier hs-type">EKStepFunc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="ekWith"><span class="annot"><span class="annottext">ekWith :: EKStepFunc -&gt; Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-var hs-var">ekWith</span></a></span></span><span> </span><span id="local-6989586621679077278"><span class="annot"><span class="annottext">EKStepFunc
</span><a href="#local-6989586621679077278"><span class="hs-identifier hs-var">stepfunc</span></a></span></span><span> </span><span id="local-6989586621679077277"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077277"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077276"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077276"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077275"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EKStepFunc
</span><a href="#local-6989586621679077278"><span class="hs-identifier hs-var">stepfunc</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077277"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077276"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077274"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077274"><span class="hs-identifier hs-var">newg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077273"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077273"><span class="hs-identifier hs-var">delta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077272"><span class="hs-identifier hs-var">finalg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077271"><span class="hs-identifier hs-var">capacity</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077273"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077272"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077272"><span class="hs-identifier hs-var">finalg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077271"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077271"><span class="hs-identifier hs-var">capacity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EKStepFunc -&gt; Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-var">ekWith</span></a></span><span> </span><span class="annot"><span class="annottext">EKStepFunc
</span><a href="#local-6989586621679077278"><span class="hs-identifier hs-var">stepfunc</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077274"><span class="hs-identifier hs-var">newg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077276"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077275"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Network, Double)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077277"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimple"><span class="hs-identifier hs-type">ekSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span id="ekSimple"><span class="annot"><span class="annottext">ekSimple :: Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimple"><span class="hs-identifier hs-var hs-var">ekSimple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EKStepFunc -&gt; Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-var">ekWith</span></a></span><span> </span><span class="annot"><span class="annottext">EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekSimpleStep"><span class="hs-identifier hs-var">ekSimpleStep</span></a></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- ENDEXTRACT</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- Alternative implementation: Process list of edges to extract path instead</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- of operating on graph structure</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-type">extractPathList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#DirEdge"><span class="hs-identifier hs-type">DirEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span id="extractPathList"><span class="annot"><span class="annottext">extractPathList :: [LEdge (Double, Double)]
-&gt; Set (Int, Int)
-&gt; ([DirEdge (Double, Double)], [LEdge (Double, Double)])
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var hs-var">extractPathList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var">extractPathList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077269"><span class="annot"><span class="annottext">edge :: LEdge (Double, Double)
</span><a href="#local-6989586621679077269"><span class="hs-identifier hs-var">edge</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679077268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077267"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077266"><span class="annot"><span class="annottext">l :: (Double, Double)
</span><a href="#local-6989586621679077266"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679077265"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077265"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077264"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077264"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077263"><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077263"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679077262"><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077265"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077264"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Set (Int, Int) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077260"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077260"><span class="hs-identifier hs-var">pathrest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077259"><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077259"><span class="hs-identifier hs-var">notrest</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
-&gt; Set (Int, Int)
-&gt; ([DirEdge (Double, Double)], [LEdge (Double, Double)])
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var">extractPathList</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077263"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Set (Int, Int) -&gt; Set (Int, Int)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077266"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077260"><span class="hs-identifier hs-var">pathrest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077259"><span class="hs-identifier hs-var">notrest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077264"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Set (Int, Int) -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">S.member</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077257"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077257"><span class="hs-identifier hs-var">pathrest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077256"><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077256"><span class="hs-identifier hs-var">notrest</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
-&gt; Set (Int, Int)
-&gt; ([DirEdge (Double, Double)], [LEdge (Double, Double)])
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var">extractPathList</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077263"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Set (Int, Int) -&gt; Set (Int, Int)
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077268"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077267"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679077266"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Direction
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">DirEdge (Double, Double)
-&gt; [DirEdge (Double, Double)] -&gt; [DirEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077257"><span class="hs-identifier hs-var">pathrest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077256"><span class="hs-identifier hs-var">notrest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                        </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077255"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077255"><span class="hs-identifier hs-var">pathrest</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077254"><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077254"><span class="hs-identifier hs-var">notrest</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
-&gt; Set (Int, Int)
-&gt; ([DirEdge (Double, Double)], [LEdge (Double, Double)])
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var">extractPathList</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077263"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Set (Int, Int)
</span><a href="#local-6989586621679077262"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077255"><span class="hs-identifier hs-var">pathrest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LEdge (Double, Double)
</span><a href="#local-6989586621679077269"><span class="hs-identifier hs-var">edge</span></a></span><span class="annot"><span class="annottext">LEdge (Double, Double)
-&gt; [LEdge (Double, Double)] -&gt; [LEdge (Double, Double)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077254"><span class="hs-identifier hs-var">notrest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekStepList"><span class="hs-identifier hs-type">ekStepList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#EKStepFunc"><span class="hs-identifier hs-type">EKStepFunc</span></a></span><span>
</span><span id="line-242"></span><span id="ekStepList"><span class="annot"><span class="annottext">ekStepList :: EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekStepList"><span class="hs-identifier hs-var hs-var">ekStepList</span></a></span></span><span> </span><span id="local-6989586621679077252"><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077252"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679077251"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077251"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679077250"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077250"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DirPath
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var">maybePath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">DirPath
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Network, Double) -&gt; Maybe (Network, Double)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LNode ()] -&gt; [LEdge (Double, Double)] -&gt; Network
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-var">mkGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network -&gt; [LNode ()]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><a href="Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var">labNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077252"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077248"><span class="hs-identifier hs-var">newEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077247"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">Maybe DirPath
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Network, Double)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077248"><span class="annot"><span class="annottext">newEdges :: [LEdge (Double, Double)]
</span><a href="#local-6989586621679077248"><span class="hs-identifier hs-var hs-var">newEdges</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; Double -&gt; [LEdge (Double, Double)]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#integrateDelta"><span class="hs-identifier hs-var">integrateDelta</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077246"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077247"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
-&gt; [LEdge (Double, Double)] -&gt; [LEdge (Double, Double)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077245"><span class="hs-identifier hs-var">otheredges</span></a></span><span>
</span><span id="line-246"></span><span>          </span><span id="local-6989586621679077249"><span class="annot"><span class="annottext">maybePath :: Maybe DirPath
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var hs-var">maybePath</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Network -&gt; Int -&gt; Int -&gt; Maybe DirPath
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#augPathFused"><span class="hs-identifier hs-var">augPathFused</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077252"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077251"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077250"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-247"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679077246"><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077246"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077245"><span class="annot"><span class="annottext">[LEdge (Double, Double)]
</span><a href="#local-6989586621679077245"><span class="hs-identifier hs-var">otheredges</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LEdge (Double, Double)]
-&gt; Set (Int, Int)
-&gt; ([DirEdge (Double, Double)], [LEdge (Double, Double)])
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#extractPathList"><span class="hs-identifier hs-var">extractPathList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Network -&gt; [LEdge (Double, Double)]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Network
</span><a href="#local-6989586621679077252"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int, Int)] -&gt; Set (Int, Int)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int] -&gt; [(Int, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679077243"><span class="hs-identifier hs-var">justPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Int]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679077243"><span class="hs-identifier hs-var">justPath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>          </span><span id="local-6989586621679077247"><span class="annot"><span class="annottext">delta :: Double
</span><a href="#local-6989586621679077247"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)] -&gt; [Double]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#getPathDeltas"><span class="hs-identifier hs-var">getPathDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DirEdge (Double, Double)]
</span><a href="#local-6989586621679077246"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-250"></span><span>          </span><span id="local-6989586621679077243"><span class="annot"><span class="annottext">justPath :: [Int]
</span><a href="#local-6989586621679077243"><span class="hs-identifier hs-var hs-var">justPath</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DirPath -&gt; [Int]
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#pathFromDirPath"><span class="hs-identifier hs-var">pathFromDirPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DirPath -&gt; DirPath
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe DirPath
</span><a href="#local-6989586621679077249"><span class="hs-identifier hs-var">maybePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekList"><span class="hs-identifier hs-type">ekList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.MaxFlow2.html#Network"><span class="hs-identifier hs-type">Network</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span id="ekList"><span class="annot"><span class="annottext">ekList :: Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekList"><span class="hs-identifier hs-var hs-var">ekList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EKStepFunc -&gt; Network -&gt; Int -&gt; Int -&gt; (Network, Double)
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekWith"><span class="hs-identifier hs-var">ekWith</span></a></span><span> </span><span class="annot"><span class="annottext">EKStepFunc
</span><a href="Data.Graph.Inductive.Query.MaxFlow2.html#ekStepList"><span class="hs-identifier hs-var">ekStepList</span></a></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- ENDEXTRACT</span><span>
</span><span id="line-255"></span></pre></body></html>