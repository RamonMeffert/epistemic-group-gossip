<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- (c) 1999 by Martin Erwig</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- | Threading Combinators.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.Internal.Thread</span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier">Split</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier">SplitM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Thread"><span class="hs-identifier">Thread</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Collect"><span class="hs-identifier">Collect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Operations</span></span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList%27"><span class="hs-identifier">threadList'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList"><span class="hs-identifier">threadList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe%27"><span class="hs-identifier">threadMaybe'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe"><span class="hs-identifier">threadMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#splitPar"><span class="hs-identifier">splitPar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#splitParM"><span class="hs-identifier">splitParM</span></a></span><span>
</span><span id="line-8"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- import Graph</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- import GraphData</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- import qualified Diet as D</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- import ADT</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- CLASSES AND TYPES</span><span>
</span><span id="line-18"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">{-
class Thread t a b where
  split :: a -&gt; t -&gt; (b,t)


instance Thread (Graph a b) Node (MContext a b) where
  split = match

instance (D.Discrete a) =&gt; Thread (D.Diet a) a a where
  split x s = (x,D.delete x s)
-}</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">{-
   Make clear different notions:

   &quot;thread&quot; = data structure + split operation
   ...      = threadable data structure
   ...      = split operation

-}</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- THREAD COMBINATORS</span><span>
</span><span id="line-44"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- (A) split along a list of indexes and thread data structure</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- there are different ways to consume the returned elements:</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">{-
--  (1) simple collect in a list
--
foldT1' ys []     d = ys
foldT1' ys (x:xs) d = foldT1' (y:ys) xs d'  where (y,d') = split x d
foldT1 xs d = foldT1' [] xs d

--  (2) combine by a function
--
foldT2' f ys []     d = ys
foldT2' f ys (x:xs) d = foldT2' f (f y ys) xs d'  where (y,d') = split x d
foldT2 f u xs d = foldT2' f u xs d
-}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- Mnemonics:</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">--  t : thread type</span><span>
</span><span id="line-69"></span><span class="hs-comment">--  i : index type</span><span>
</span><span id="line-70"></span><span class="hs-comment">--  r : result type</span><span>
</span><span id="line-71"></span><span class="hs-comment">--  c : collection type</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span id="Split"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-var">Split</span></a></span></span><span> </span><span id="local-6989586621679073323"><span class="annot"><a href="#local-6989586621679073323"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679073322"><span class="annot"><a href="#local-6989586621679073322"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679073321"><span class="annot"><a href="#local-6989586621679073321"><span class="hs-identifier hs-type">r</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679073322"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073323"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073321"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073323"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="Thread"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Thread"><span class="hs-identifier hs-var">Thread</span></a></span></span><span> </span><span id="local-6989586621679073320"><span class="annot"><a href="#local-6989586621679073320"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679073319"><span class="annot"><a href="#local-6989586621679073319"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679073318"><span class="annot"><a href="#local-6989586621679073318"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073320"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073320"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073319"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073318"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">type</span><span> </span><span id="Collect"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span id="local-6989586621679073317"><span class="annot"><a href="#local-6989586621679073317"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679073316"><span class="annot"><a href="#local-6989586621679073316"><span class="hs-identifier hs-type">c</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073317"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073316"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073316"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073316"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">--  (3) abstract from split</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span id="local-6989586621679073359"><span id="local-6989586621679073360"><span id="local-6989586621679073361"><span id="local-6989586621679073362"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList%27"><span class="hs-identifier hs-type">threadList'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073362"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073361"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073360"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073359"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073362"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679073359"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073360"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073361"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073360"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-80"></span><span id="threadList%27"><span class="annot"><span class="annottext">threadList' :: Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadList%27"><span class="hs-identifier hs-var hs-var">threadList'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679073315"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073315"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span id="local-6989586621679073314"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073314"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073315"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073314"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList%27"><span class="hs-identifier hs-var">threadList'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073313"><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073312"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073312"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073311"><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073311"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073310"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073310"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679073309"><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679073309"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073308"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073308"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
forall r c t i. Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadList%27"><span class="hs-identifier hs-var">threadList'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073313"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073307"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073312"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073311"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679073309"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073306"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-82"></span><span>                                   </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073307"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073307"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073306"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073306"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073311"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073310"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073308"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">{-
   Note: threadList' works top-down (or, from left),
         whereas dfs,gfold,... have been defined bottom-up (or from right).

   ==&gt; therefore, we define a correpsonding operator for folding
       bottom-up/from right.
-}</span><span>
</span><span id="line-91"></span><span id="local-6989586621679073302"><span id="local-6989586621679073303"><span id="local-6989586621679073304"><span id="local-6989586621679073305"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList"><span class="hs-identifier hs-type">threadList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073305"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073304"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073302"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073305"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679073302"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073303"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073304"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073303"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-92"></span><span id="threadList"><span class="annot"><span class="annottext">threadList :: Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadList"><span class="hs-identifier hs-var hs-var">threadList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679073301"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073301"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679073300"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073300"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073301"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073300"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadList"><span class="hs-identifier hs-var">threadList</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073299"><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073299"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073298"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073298"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073297"><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073297"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073296"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073296"><span class="hs-identifier hs-var">i</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679073295"><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679073295"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073294"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073294"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073299"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073293"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073292"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">t''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                                  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073293"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073293"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073290"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073290"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073297"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073296"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073294"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-95"></span><span>                                        </span><span class="hs-special">(</span><span id="local-6989586621679073292"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073292"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073291"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073291"><span class="hs-identifier hs-var">t''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
forall r c t i. Collect r c -&gt; Split t i r -&gt; [i] -&gt; t -&gt; (c, t)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadList"><span class="hs-identifier hs-var">threadList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; c -&gt; c
</span><a href="#local-6989586621679073299"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073298"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073297"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">[i]
</span><a href="#local-6989586621679073295"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073290"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- (B) thread &quot;maybes&quot;, ie, apply f to Just-values and continue</span><span>
</span><span id="line-100"></span><span class="hs-comment">--     threading with &quot;continuation&quot; c, and ignore Nothing-values, ie,</span><span>
</span><span id="line-101"></span><span class="hs-comment">--     stop threading and return current data structure.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- threadMaybe' :: (r -&gt; b) -&gt; Split t i r -&gt; (e -&gt; f -&gt; (Maybe i,t))</span><span>
</span><span id="line-104"></span><span class="hs-comment">--                 -&gt; e -&gt; f -&gt; (Maybe b,t)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">type</span><span> </span><span id="SplitM"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier hs-var">SplitM</span></a></span></span><span> </span><span id="local-6989586621679073289"><span class="annot"><a href="#local-6989586621679073289"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679073288"><span class="annot"><a href="#local-6989586621679073288"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679073287"><span class="annot"><a href="#local-6989586621679073287"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073289"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073288"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679073287"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679073282"><span id="local-6989586621679073283"><span id="local-6989586621679073284"><span id="local-6989586621679073285"><span id="local-6989586621679073286"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe%27"><span class="hs-identifier hs-type">threadMaybe'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073286"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679073285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073284"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073283"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073286"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073284"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073282"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679073283"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073284"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073282"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679073285"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-109"></span><span id="threadMaybe%27"><span class="annot"><span class="annottext">threadMaybe' :: (r -&gt; a)
-&gt; Split t i r -&gt; Split t j (Maybe i) -&gt; Split t j (Maybe a)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe%27"><span class="hs-identifier hs-var hs-var">threadMaybe'</span></a></span></span><span> </span><span id="local-6989586621679073281"><span class="annot"><span class="annottext">r -&gt; a
</span><a href="#local-6989586621679073281"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679073280"><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073280"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span id="local-6989586621679073279"><span class="annot"><span class="annottext">Split t j (Maybe i)
</span><a href="#local-6989586621679073279"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679073278"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073278"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679073277"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073277"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe i
</span><a href="#local-6989586621679073276"><span class="hs-identifier hs-var">mi</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073275"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073275"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; a
</span><a href="#local-6989586621679073281"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073274"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073273"><span class="hs-identifier hs-var">t''</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073274"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073274"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073273"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073273"><span class="hs-identifier hs-var">t''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073280"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073275"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-111"></span><span>                 </span><span class="annot"><span class="annottext">Maybe i
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073276"><span class="annot"><span class="annottext">Maybe i
</span><a href="#local-6989586621679073276"><span class="hs-identifier hs-var">mi</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073272"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073272"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t j (Maybe i)
</span><a href="#local-6989586621679073279"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073278"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073277"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- extension:  grant f access also to y, the result of split.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- threadMaybe :: (a -&gt; b -&gt; c) -&gt; (a -&gt; d -&gt; (b,d)) -&gt; (e -&gt; f -&gt; (Maybe a,d))</span><span>
</span><span id="line-117"></span><span class="hs-comment">--                -&gt; e -&gt; f -&gt; (Maybe c,d)</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- threadMaybe :: (i-&gt;r-&gt;a)-&gt;Split t i r-&gt;Split t j (Maybe i)-&gt;Split t j (Maybe a)</span><span>
</span><span id="line-119"></span><span id="local-6989586621679073267"><span id="local-6989586621679073268"><span id="local-6989586621679073269"><span id="local-6989586621679073270"><span id="local-6989586621679073271"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe"><span class="hs-identifier hs-type">threadMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073271"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073270"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073269"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073268"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073271"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073270"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier hs-type">SplitM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073268"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073267"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073271"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier hs-type">SplitM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073268"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073267"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073269"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-120"></span><span id="threadMaybe"><span class="annot"><span class="annottext">threadMaybe :: (i -&gt; r -&gt; a) -&gt; Split t i r -&gt; SplitM t j i -&gt; SplitM t j a
</span><a href="Data.Graph.Inductive.Internal.Thread.html#threadMaybe"><span class="hs-identifier hs-var hs-var">threadMaybe</span></a></span></span><span> </span><span id="local-6989586621679073266"><span class="annot"><span class="annottext">i -&gt; r -&gt; a
</span><a href="#local-6989586621679073266"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679073265"><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073265"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span id="local-6989586621679073264"><span class="annot"><span class="annottext">SplitM t j i
</span><a href="#local-6989586621679073264"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679073263"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073263"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679073262"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073262"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe i
</span><a href="#local-6989586621679073261"><span class="hs-identifier hs-var">mi</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073260"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073260"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; r -&gt; a
</span><a href="#local-6989586621679073266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073259"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073258"><span class="hs-identifier hs-var">t''</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073259"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073259"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073258"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073258"><span class="hs-identifier hs-var">t''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073265"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073260"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073257"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-122"></span><span>                 </span><span class="annot"><span class="annottext">Maybe i
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073257"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073261"><span class="annot"><span class="annottext">Maybe i
</span><a href="#local-6989586621679073261"><span class="hs-identifier hs-var">mi</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073257"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073257"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SplitM t j i
</span><a href="#local-6989586621679073264"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073263"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073262"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- (C) compose splits in parallel (is a kind of generalized zip)</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- splitPar :: (a -&gt; b -&gt; (c,d)) -&gt; (e -&gt; f -&gt; (g,h))</span><span>
</span><span id="line-129"></span><span class="hs-comment">--             -&gt; (a,e) -&gt; (b,f) -&gt; ((c,g),(d,h))</span><span>
</span><span id="line-130"></span><span id="local-6989586621679073251"><span id="local-6989586621679073252"><span id="local-6989586621679073253"><span id="local-6989586621679073254"><span id="local-6989586621679073255"><span id="local-6989586621679073256"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#splitPar"><span class="hs-identifier hs-type">splitPar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073256"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073255"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073254"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073253"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073252"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073251"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073256"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073253"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073255"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073252"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073254"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073251"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-131"></span><span id="splitPar"><span class="annot"><span class="annottext">splitPar :: Split t i r -&gt; Split u j s -&gt; Split (t, u) (i, j) (r, s)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#splitPar"><span class="hs-identifier hs-var hs-var">splitPar</span></a></span></span><span> </span><span id="local-6989586621679073250"><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073250"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679073249"><span class="annot"><span class="annottext">Split u j s
</span><a href="#local-6989586621679073249"><span class="hs-identifier hs-var">split'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073248"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073248"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073247"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073247"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073246"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073246"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073245"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073245"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073244"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679073243"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073242"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073241"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                                    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073244"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073244"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073242"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073242"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split t i r
</span><a href="#local-6989586621679073250"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073248"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073246"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-133"></span><span>                                          </span><span class="hs-special">(</span><span id="local-6989586621679073243"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679073243"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073241"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073241"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split u j s
</span><a href="#local-6989586621679073249"><span class="hs-identifier hs-var">split'</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073247"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073245"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679073235"><span id="local-6989586621679073236"><span id="local-6989586621679073237"><span id="local-6989586621679073238"><span id="local-6989586621679073239"><span id="local-6989586621679073240"><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#splitParM"><span class="hs-identifier hs-type">splitParM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier hs-type">SplitM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073240"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073239"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073238"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073237"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073236"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073235"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Internal.Thread.html#SplitM"><span class="hs-identifier hs-type">SplitM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073240"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073237"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073239"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073236"><span class="hs-identifier hs-type">j</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073238"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679073235"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-136"></span><span id="splitParM"><span class="annot"><span class="annottext">splitParM :: SplitM t i r -&gt; Split u j s -&gt; SplitM (t, u) (i, j) (r, s)
</span><a href="Data.Graph.Inductive.Internal.Thread.html#splitParM"><span class="hs-identifier hs-var hs-var">splitParM</span></a></span></span><span> </span><span id="local-6989586621679073234"><span class="annot"><span class="annottext">SplitM t i r
</span><a href="#local-6989586621679073234"><span class="hs-identifier hs-var">splitm</span></a></span></span><span> </span><span id="local-6989586621679073233"><span class="annot"><span class="annottext">Split u j s
</span><a href="#local-6989586621679073233"><span class="hs-identifier hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073232"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073232"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073231"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073231"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073230"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073230"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073229"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073229"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe r
</span><a href="#local-6989586621679073228"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073227"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073227"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(r, s) -&gt; Maybe (r, s)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679073227"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679073226"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073225"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073224"><span class="hs-identifier hs-var">u'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                     </span><span class="annot"><span class="annottext">Maybe r
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (r, s)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073225"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073229"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ignore 2nd split</span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073228"><span class="annot"><span class="annottext">Maybe r
</span><a href="#local-6989586621679073228"><span class="hs-identifier hs-var">mr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073225"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073225"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SplitM t i r
</span><a href="#local-6989586621679073234"><span class="hs-identifier hs-var">splitm</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679073232"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679073230"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-140"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679073226"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679073226"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073224"><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073224"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Split u j s
</span><a href="#local-6989586621679073233"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679073231"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">u
</span><a href="#local-6989586621679073229"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- (D) merge a thread with/into a computation</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">{-
   Example: assign consecutive numbers to the nodes of a tree

   Input: type d, thread (t,split), fold operation on d
-}</span><span>
</span><span id="line-150"></span></pre></body></html>