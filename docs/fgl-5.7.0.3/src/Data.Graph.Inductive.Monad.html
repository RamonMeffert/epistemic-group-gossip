<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- (c) 2002 by Martin Erwig [see file COPYRIGHT]</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Monadic Graphs</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.Monad</span><span class="hs-special">(</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Classes</span></span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier">GraphM</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Operations</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Graph Folds and Maps</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#ufoldM"><span class="hs-identifier">ufoldM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Graph Projection</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier">nodesM</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#edgesM"><span class="hs-identifier">edgesM</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#newNodesM"><span class="hs-identifier">newNodesM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Graph Construction and Destruction</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#delNodeM"><span class="hs-identifier">delNodeM</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier">delNodesM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#mkUGraphM"><span class="hs-identifier">mkUGraphM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Graph Inspection</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#contextM"><span class="hs-identifier">contextM</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labM"><span class="hs-identifier">labM</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></a></span><span class="hs-cpp">
#if MIN_VERSION_base(4,12,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-27"></span><span class="hs-pragma">{-# ANN</span><span> </span><span class="hs-pragma">module</span><span> </span><span class="annot"><span class="hs-pragma">&quot;HLint: ignore Redundant lambda&quot;</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- MONADIC GRAPH CLASS</span><span>
</span><span id="line-31"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- Currently, we define just one monadic graph class:</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">--   GraphM:    static, decomposable graphs</span><span>
</span><span id="line-37"></span><span class="hs-comment">--              static means that a graph itself cannot be changed</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- Later we might also define DynGraphM for dynamic, extensible graphs</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Monadic Graph</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-keyword">class</span><span class="hs-cpp">
#if MIN_VERSION_base(4,12,0)
</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-identifier">m</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span id="GraphM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-var">GraphM</span></a></span></span><span> </span><span id="local-6989586621679073855"><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679073854"><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#emptyM"><span class="hs-pragma hs-type">emptyM</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-pragma hs-type">isEmptyM</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-pragma hs-type">matchM</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#mkGraphM"><span class="hs-pragma hs-type">mkGraphM</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labNodesM"><span class="hs-pragma hs-type">labNodesM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679073707"><span id="local-6989586621679073708"><span id="emptyM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#emptyM"><span class="hs-identifier hs-type">emptyM</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073707"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679073824"><span id="local-6989586621679073825"><span id="isEmptyM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-type">isEmptyM</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073824"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679073839"><span id="local-6989586621679073840"><span id="matchM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-type">matchM</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Decomp"><span class="hs-identifier hs-type">Decomp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073839"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679073749"><span id="local-6989586621679073750"><span id="mkGraphM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#mkGraphM"><span class="hs-identifier hs-type">mkGraphM</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073750"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073749"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073750"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073749"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679073847"><span id="local-6989586621679073848"><span id="labNodesM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labNodesM"><span class="hs-identifier hs-type">labNodesM</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073847"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679073784"><span id="local-6989586621679073785"><span id="matchAnyM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#matchAnyM"><span class="hs-identifier hs-type">matchAnyM</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073784"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#GDecomp"><span class="hs-identifier hs-type">GDecomp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073784"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679073705"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#matchAnyM"><span class="hs-identifier hs-var hs-var">matchAnyM</span></a></span><span> </span><span id="local-6989586621679073704"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073704"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679073703"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679073703"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [LNode a]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [LNode a]
</span><a href="Data.Graph.Inductive.Monad.html#labNodesM"><span class="hs-identifier hs-var">labNodesM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073704"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-67"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679073703"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (GDecomp gr a b)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Match Exception, Empty Graph&quot;</span></span><span>
</span><span id="line-69"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679073702"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073702"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[LNode a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073701"><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073701"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073700"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073700"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073702"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073704"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-70"></span><span>                                   </span><span class="annot"><span class="annottext">GDecomp gr a b -&gt; m (GDecomp gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073701"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073700"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679073698"><span id="local-6989586621679073699"><span id="noNodesM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#noNodesM"><span class="hs-identifier hs-type">noNodesM</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073699"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073698"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679073696"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#noNodesM"><span class="hs-identifier hs-var hs-var">noNodesM</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [LNode a]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [LNode a]
</span><a href="Data.Graph.Inductive.Monad.html#labNodesM"><span class="hs-identifier hs-var">labNodesM</span></a></span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m [LNode a])
-&gt; ([LNode a] -&gt; Node) -&gt; m (gr a b) -&gt; m Node
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(m a -&gt; m b) -&gt; (b -&gt; c) -&gt; m a -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#%3E%3E."><span class="hs-operator hs-var">&gt;&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode a] -&gt; Node
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Node
</span><span class="hs-identifier hs-var">length</span></span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679073765"><span id="local-6989586621679073766"><span id="nodeRangeM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#nodeRangeM"><span class="hs-identifier hs-type">nodeRangeM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073766"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073765"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679073692"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#nodeRangeM"><span class="hs-identifier hs-var hs-var">nodeRangeM</span></a></span><span> </span><span id="local-6989586621679073691"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073691"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679073690"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073690"><span class="hs-identifier hs-var">isE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073691"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-77"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073690"><span class="hs-identifier hs-var">isE</span></a></span><span>
</span><span id="line-78"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (Node, Node)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nodeRangeM of empty graph&quot;</span></span><span>
</span><span id="line-79"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679073689"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073689"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier hs-var">nodesM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073691"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-80"></span><span>                               </span><span class="annot"><span class="annottext">(Node, Node) -&gt; m (Node, Node)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; Node
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073689"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Node] -&gt; Node
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073689"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679073772"><span id="local-6989586621679073773"><span id="labEdgesM"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labEdgesM"><span class="hs-identifier hs-type">labEdgesM</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073854"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073773"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073772"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073855"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073772"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679073685"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labEdgesM"><span class="hs-identifier hs-var hs-var">labEdgesM</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; [LEdge b] -&gt; [LEdge b])
-&gt; [LEdge b] -&gt; m (gr a b) -&gt; m [LEdge b]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#ufoldM"><span class="hs-identifier hs-var">ufoldM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073684"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679073684"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073683"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073683"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679073682"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679073682"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Node) -&gt; LEdge b) -&gt; Adj b -&gt; [LEdge b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; (b, Node) -&gt; LEdge b
forall b c a. b -&gt; (c, a) -&gt; (a, b, c)
</span><a href="#local-6989586621679073681"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073683"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679073684"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; [LEdge b] -&gt; [LEdge b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">((b, Node) -&gt; LEdge b) -&gt; Adj b -&gt; [LEdge b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; (b, Node) -&gt; LEdge b
forall a c b. a -&gt; (c, b) -&gt; (a, b, c)
</span><a href="#local-6989586621679073680"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073683"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679073682"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">[LEdge b] -&gt; [LEdge b] -&gt; [LEdge b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>      </span><span id="local-6989586621679073680"><span class="annot"><span class="annottext">o :: a -&gt; (c, b) -&gt; (a, b, c)
</span><a href="#local-6989586621679073680"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679073679"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073679"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073678"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073678"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073677"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073677"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073679"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073677"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073678"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>      </span><span id="local-6989586621679073681"><span class="annot"><span class="annottext">i :: b -&gt; (c, a) -&gt; (a, b, c)
</span><a href="#local-6989586621679073681"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679073676"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073676"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073675"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073675"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073674"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073674"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679073674"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679073676"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073675"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- composing a monadic function with a non-monadic one</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span id="local-6989586621679073830"><span id="local-6989586621679073831"><span id="local-6989586621679073832"><span id="local-6989586621679073833"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#%3E%3E."><span class="hs-operator hs-type">(&gt;&gt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679073833"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073833"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073833"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073831"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073831"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073830"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073833"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073833"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073830"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-92"></span><span id="local-6989586621679073673"><span class="annot"><span class="annottext">m a -&gt; m b
</span><a href="#local-6989586621679073673"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="%3E%3E."><span class="annot"><span class="annottext">&gt;&gt;. :: (m a -&gt; m b) -&gt; (b -&gt; c) -&gt; m a -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#%3E%3E."><span class="hs-operator hs-var hs-var">&gt;&gt;.</span></a></span></span><span> </span><span id="local-6989586621679073672"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679073672"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m b -&gt; (b -&gt; m c) -&gt; m c
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; m c
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(c -&gt; m c) -&gt; (b -&gt; c) -&gt; b -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679073672"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m b -&gt; m c) -&gt; (m a -&gt; m b) -&gt; m a -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; m b
</span><a href="#local-6989586621679073673"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- DERIVED GRAPH OPERATIONS</span><span>
</span><span id="line-97"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- graph folds and maps</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | graph fold</span><span>
</span><span id="line-103"></span><span id="local-6989586621679073811"><span id="local-6989586621679073812"><span id="local-6989586621679073813"><span id="local-6989586621679073814"><span id="local-6989586621679073815"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#ufoldM"><span class="hs-identifier hs-type">ufoldM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073815"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073814"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073813"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073812"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073811"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073811"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073811"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073815"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073814"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073813"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073812"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073815"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073811"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span></span><span>
</span><span id="line-104"></span><span id="ufoldM"><span class="annot"><span class="annottext">ufoldM :: (Context a b -&gt; c -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#ufoldM"><span class="hs-identifier hs-var hs-var">ufoldM</span></a></span></span><span> </span><span id="local-6989586621679073670"><span class="annot"><span class="annottext">Context a b -&gt; c -&gt; c
</span><a href="#local-6989586621679073670"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679073669"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073669"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679073668"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073668"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679073667"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073667"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073668"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-105"></span><span>                  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073667"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">c -&gt; m c
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073669"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-106"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073666"><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073666"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073665"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073665"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m (Context a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m (GDecomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchAnyM"><span class="hs-identifier hs-var">matchAnyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073668"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-107"></span><span>                               </span><span id="local-6989586621679073664"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073664"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; c -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; m c
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#ufoldM"><span class="hs-identifier hs-var">ufoldM</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; c -&gt; c
</span><a href="#local-6989586621679073670"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073669"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr a b -&gt; m (gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073665"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>                               </span><span class="annot"><span class="annottext">c -&gt; m c
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b -&gt; c -&gt; c
</span><a href="#local-6989586621679073670"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073666"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073664"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- (additional) graph projection</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- [noNodes, nodeRange, labNodes, labEdges are defined in class Graph]</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span id="local-6989586621679073820"><span id="local-6989586621679073821"><span id="local-6989586621679073822"><span id="local-6989586621679073823"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier hs-type">nodesM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073822"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073822"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073821"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073823"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-115"></span><span id="nodesM"><span class="annot"><span class="annottext">nodesM :: m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier hs-var hs-var">nodesM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [LNode a]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [LNode a]
</span><a href="Data.Graph.Inductive.Monad.html#labNodesM"><span class="hs-identifier hs-var">labNodesM</span></a></span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m [LNode a])
-&gt; ([LNode a] -&gt; [Node]) -&gt; m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(m a -&gt; m b) -&gt; (b -&gt; c) -&gt; m a -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#%3E%3E."><span class="hs-operator hs-var">&gt;&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">(LNode a -&gt; Node) -&gt; [LNode a] -&gt; [Node]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LNode a -&gt; Node
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679073660"><span id="local-6989586621679073661"><span id="local-6989586621679073662"><span id="local-6989586621679073663"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#edgesM"><span class="hs-identifier hs-type">edgesM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073662"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073662"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073661"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073660"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-118"></span><span id="edgesM"><span class="annot"><span class="annottext">edgesM :: m (gr a b) -&gt; m [(Node, Node)]
</span><a href="Data.Graph.Inductive.Monad.html#edgesM"><span class="hs-identifier hs-var hs-var">edgesM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [LEdge b]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [LEdge b]
</span><a href="Data.Graph.Inductive.Monad.html#labEdgesM"><span class="hs-identifier hs-var">labEdgesM</span></a></span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m [LEdge b])
-&gt; ([LEdge b] -&gt; [(Node, Node)]) -&gt; m (gr a b) -&gt; m [(Node, Node)]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(m a -&gt; m b) -&gt; (b -&gt; c) -&gt; m a -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#%3E%3E."><span class="hs-operator hs-var">&gt;&gt;.</span></a></span><span> </span><span class="annot"><span class="annottext">(LEdge b -&gt; (Node, Node)) -&gt; [LEdge b] -&gt; [(Node, Node)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679073658"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073658"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679073657"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073657"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073658"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073657"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679073653"><span id="local-6989586621679073654"><span id="local-6989586621679073655"><span id="local-6989586621679073656"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#newNodesM"><span class="hs-identifier hs-type">newNodesM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073655"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073655"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073654"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073653"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073656"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-121"></span><span id="newNodesM"><span class="annot"><span class="annottext">newNodesM :: Node -&gt; m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Monad.html#newNodesM"><span class="hs-identifier hs-var hs-var">newNodesM</span></a></span></span><span> </span><span id="local-6989586621679073652"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073652"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679073651"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073651"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679073650"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073650"><span class="hs-identifier hs-var">isE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073651"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-122"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679073650"><span class="hs-identifier hs-var">isE</span></a></span><span>
</span><span id="line-123"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; m [Node]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073652"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Node
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679073649"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073649"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m (Node, Node)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m (Node, Node)
</span><a href="Data.Graph.Inductive.Monad.html#nodeRangeM"><span class="hs-identifier hs-var">nodeRangeM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073651"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-125"></span><span>                              </span><span class="annot"><span class="annottext">[Node] -&gt; m [Node]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073649"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Node
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073649"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Node
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073652"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- graph construction &amp; destruction</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span id="local-6989586621679073644"><span id="local-6989586621679073645"><span id="local-6989586621679073646"><span id="local-6989586621679073647"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#delNodeM"><span class="hs-identifier hs-type">delNodeM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073647"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073646"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073647"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073646"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073644"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073647"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073646"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073644"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-131"></span><span id="delNodeM"><span class="annot"><span class="annottext">delNodeM :: Node -&gt; m (gr a b) -&gt; m (gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#delNodeM"><span class="hs-identifier hs-var hs-var">delNodeM</span></a></span></span><span> </span><span id="local-6989586621679073643"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073643"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; m (gr a b) -&gt; m (gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; m (gr a b) -&gt; m (gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier hs-var">delNodesM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073643"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679073757"><span id="local-6989586621679073758"><span id="local-6989586621679073759"><span id="local-6989586621679073760"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier hs-type">delNodesM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073759"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073759"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073757"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073759"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073758"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073757"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-134"></span><span id="delNodesM"><span class="annot"><span class="annottext">delNodesM :: [Node] -&gt; m (gr a b) -&gt; m (gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier hs-var hs-var">delNodesM</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679073642"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073642"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073642"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier hs-var">delNodesM</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073641"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073641"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679073640"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073640"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679073639"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073639"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MContext a b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679073638"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073638"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073641"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073639"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-136"></span><span>                        </span><span class="annot"><span class="annottext">[Node] -&gt; m (gr a b) -&gt; m (gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; m (gr a b) -&gt; m (gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#delNodesM"><span class="hs-identifier hs-var">delNodesM</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073640"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr a b -&gt; m (gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679073638"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679073636"><span id="local-6989586621679073637"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#mkUGraphM"><span class="hs-identifier hs-type">mkUGraphM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073637"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073636"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073637"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073636"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-139"></span><span id="mkUGraphM"><span class="annot"><span class="annottext">mkUGraphM :: [Node] -&gt; [(Node, Node)] -&gt; m (gr () ())
</span><a href="Data.Graph.Inductive.Monad.html#mkUGraphM"><span class="hs-identifier hs-var hs-var">mkUGraphM</span></a></span></span><span> </span><span id="local-6989586621679073635"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073635"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679073634"><span class="annot"><span class="annottext">[(Node, Node)]
</span><a href="#local-6989586621679073634"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LNode ()] -&gt; [LEdge ()] -&gt; m (gr () ())
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; m (gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#mkGraphM"><span class="hs-identifier hs-var">mkGraphM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; [LNode ()]
</span><a href="Data.Graph.Inductive.Monad.html#labUNodes"><span class="hs-identifier hs-var">labUNodes</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679073635"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Node, Node)] -&gt; [LEdge ()]
</span><a href="Data.Graph.Inductive.Monad.html#labUEdges"><span class="hs-identifier hs-var">labUEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[(Node, Node)]
</span><a href="#local-6989586621679073634"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labUEdges"><span class="hs-identifier hs-type">labUEdges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Edge"><span class="hs-identifier hs-type">Edge</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span id="labUEdges"><span class="annot"><span class="annottext">labUEdges :: [(Node, Node)] -&gt; [LEdge ()]
</span><a href="Data.Graph.Inductive.Monad.html#labUEdges"><span class="hs-identifier hs-var hs-var">labUEdges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, Node) -&gt; LEdge ()) -&gt; [(Node, Node)] -&gt; [LEdge ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Node, Node) -&gt; () -&gt; LEdge ()
forall b. (Node, Node) -&gt; b -&gt; LEdge b
</span><a href="Data.Graph.Inductive.Graph.html#toLEdge"><span class="hs-operator hs-var">`toLEdge`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labUNodes"><span class="hs-identifier hs-type">labUNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span id="labUNodes"><span class="annot"><span class="annottext">labUNodes :: [Node] -&gt; [LNode ()]
</span><a href="Data.Graph.Inductive.Monad.html#labUNodes"><span class="hs-identifier hs-var hs-var">labUNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node -&gt; LNode ()) -&gt; [Node] -&gt; [LNode ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679073630"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073630"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073630"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- graph inspection (for a particular node)</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span id="local-6989586621679073734"><span id="local-6989586621679073735"><span id="local-6989586621679073736"><span id="local-6989586621679073737"><span id="local-6989586621679073738"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#onMatch"><span class="hs-identifier hs-type">onMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073737"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073735"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073734"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073734"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073737"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073735"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073734"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span></span><span>
</span><span id="line-151"></span><span id="onMatch"><span class="annot"><span class="annottext">onMatch :: (Context a b -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; Node -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#onMatch"><span class="hs-identifier hs-var hs-var">onMatch</span></a></span></span><span> </span><span id="local-6989586621679073628"><span class="annot"><span class="annottext">Context a b -&gt; c
</span><a href="#local-6989586621679073628"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679073627"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073627"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679073626"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073626"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679073625"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073625"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679073624"><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679073624"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073625"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073626"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-152"></span><span>                     </span><span class="annot"><span class="annottext">c -&gt; m c
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679073624"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">MContext a b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679073627"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679073623"><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073623"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; c
</span><a href="#local-6989586621679073628"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679073623"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621679073619"><span id="local-6989586621679073620"><span id="local-6989586621679073621"><span id="local-6989586621679073622"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#contextM"><span class="hs-identifier hs-type">contextM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073622"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073621"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073622"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073621"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073622"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073619"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-155"></span><span id="contextM"><span class="annot"><span class="annottext">contextM :: m (gr a b) -&gt; Node -&gt; m (Context a b)
</span><a href="Data.Graph.Inductive.Monad.html#contextM"><span class="hs-identifier hs-var hs-var">contextM</span></a></span></span><span> </span><span id="local-6989586621679073618"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073618"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679073617"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073617"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; Context a b)
-&gt; Context a b -&gt; m (gr a b) -&gt; Node -&gt; m (Context a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; Node -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#onMatch"><span class="hs-identifier hs-var">onMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Context a b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Context a b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Match Exception, Node: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Node -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073617"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679073618"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679073617"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679073610"><span id="local-6989586621679073611"><span id="local-6989586621679073612"><span id="local-6989586621679073613"><span class="annot"><a href="Data.Graph.Inductive.Monad.html#labM"><span class="hs-identifier hs-type">labM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073613"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073612"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073613"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679073612"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679073610"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679073613"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679073611"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-158"></span><span id="labM"><span class="annot"><span class="annottext">labM :: m (gr a b) -&gt; Node -&gt; m (Maybe a)
</span><a href="Data.Graph.Inductive.Monad.html#labM"><span class="hs-identifier hs-var hs-var">labM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; Maybe a)
-&gt; Maybe a -&gt; m (gr a b) -&gt; Node -&gt; m (Maybe a)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c) -&gt; c -&gt; m (gr a b) -&gt; Node -&gt; m c
</span><a href="Data.Graph.Inductive.Monad.html#onMatch"><span class="hs-identifier hs-var">onMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; (Context a b -&gt; a) -&gt; Context a b -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; a
forall a b. Context a b -&gt; a
</span><a href="Data.Graph.Inductive.Graph.html#lab%27"><span class="hs-identifier hs-var">lab'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">{-
neighbors :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [Node]
neighbors = (\(p,_,_,s) -&gt; map snd (p++s)) .: context

suc :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [Node]
suc = map snd .: context4

pre :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [Node]
pre = map snd .: context1

lsuc :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [(Node,b)]
lsuc = map flip2 .: context4

lpre :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [(Node,b)]
lpre = map flip2 .: context1

out :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [LEdge b]
out g v = map (\(l,w)-&gt;(v,w,l)) (context4 g v)

inn :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; [LEdge b]
inn g v = map (\(l,w)-&gt;(w,v,l)) (context1 g v)

outdeg :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; Int
outdeg = length .: context4

indeg :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; Int
indeg  = length .: context1

deg :: (GraphM m gr) =&gt; m (gr a b) -&gt; Node -&gt; Int
deg = (\(p,_,_,s) -&gt; length p+length s) .: context
--

-- -- context inspection
-- --
-- node' :: Context a b -&gt; Node
-- node' (_,v,_,_) = v
--
-- lab' :: Context a b -&gt; a
-- lab' (_,_,l,_) = l
--
-- labNode' :: Context a b -&gt; LNode a
-- labNode' (_,v,l,_) = (v,l)
--
-- neighbors' :: Context a b -&gt; [Node]
-- neighbors' (p,_,_,s) = map snd p++map snd s
--
-- suc' :: Context a b -&gt; [Node]
-- suc' (_,_,_,s) = map snd s
--
-- pre' :: Context a b -&gt; [Node]
-- pre' (p,_,_,_) = map snd p
--
-- lpre' :: Context a b -&gt; [(Node,b)]
-- lpre' (p,_,_,_) = map flip2 p
--
-- lsuc' :: Context a b -&gt; [(Node,b)]
-- lsuc' (_,_,_,s) = map flip2 s
--
-- out' :: Context a b -&gt; [LEdge b]
-- out' (_,v,_,s) = map (\(l,w)-&gt;(v,w,l)) s
--
-- inn' :: Context a b -&gt; [LEdge b]
-- inn' (p,v,_,_) = map (\(l,w)-&gt;(w,v,l)) p
--
-- outdeg' :: Context a b -&gt; Int
-- outdeg' (_,_,_,s) = length s
--
-- indeg' :: Context a b -&gt; Int
-- indeg' (p,_,_,_) = length p
--
-- deg' :: Context a b -&gt; Int
-- deg' (p,_,_,s) = length p+length s


-- graph equality
--
nodeComp :: (Eq b) =&gt; LNode b -&gt; LNode b -&gt; Ordering
nodeComp n@(v,a) n'@(w,b) | n == n'   = EQ
                          | v&lt;w       = LT
                          | otherwise = GT

slabNodes :: (Eq a,Graph gr) =&gt; m (gr a b) -&gt; [LNode a]
slabNodes = sortBy nodeComp . labNodes

edgeComp :: (Eq b) =&gt; LEdge b -&gt; LEdge b -&gt; Ordering
edgeComp e@(v,w,a) e'@(x,y,b) | e == e'              = EQ
                              | v&lt;x || (v==x &amp;&amp; w&lt;y) = LT
                              | otherwise            = GT

slabEdges :: (Eq b,Graph gr) =&gt; m (gr a b) -&gt; [LEdge b]
slabEdges = sortBy edgeComp . labEdges

instance (Eq a,Eq b,Graph gr) =&gt; Eq (m (gr a b)) where
  g == g' = slabNodes g == slabNodes g' &amp;&amp; slabEdges g == slabEdges g'


-}</span><span>
</span><span id="line-257"></span></pre></body></html>