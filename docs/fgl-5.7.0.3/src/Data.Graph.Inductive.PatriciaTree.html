<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns, CPP, ScopedTypeVariables #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |An efficient implementation of 'Data.Graph.Inductive.Graph.Graph'</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- using big-endian patricia tree (i.e. &quot;Data.IntMap&quot;).</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- This module provides the following specialised functions to gain</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- more performance, using GHC's RULES pragma:</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.insNode'</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.insEdge'</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.gmap'</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.nmap'</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- * 'Data.Graph.Inductive.Graph.emap'</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.PatriciaTree</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier">Gr</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#UGr"><span class="hs-identifier">UGr</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftA2</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IntMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tuple</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">swap</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_containers (0,4,2)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_containers(0,5,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IMS</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.IntMap</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">IMS</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base (4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">second</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-57"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- GRAPH REPRESENTATION</span><span>
</span><span id="line-59"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="local-6989586621679075309"><span id="local-6989586621679075310"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Gr"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span id="local-6989586621679075505"><span class="annot"><a href="#local-6989586621679075505"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075504"><span class="annot"><a href="#local-6989586621679075504"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gr"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075505"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075504"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Gr a b -&gt; Rep (Gr a b) x)
-&gt; (forall x. Rep (Gr a b) x -&gt; Gr a b) -&gt; Generic (Gr a b)
forall x. Rep (Gr a b) x -&gt; Gr a b
forall x. Gr a b -&gt; Rep (Gr a b) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a b x. Rep (Gr a b) x -&gt; Gr a b
forall a b x. Gr a b -&gt; Rep (Gr a b) x
$cto :: forall a b x. Rep (Gr a b) x -&gt; Gr a b
$cfrom :: forall a b x. Gr a b -&gt; Rep (Gr a b) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-66"></span><span class="hs-keyword">type</span><span> </span><span id="GraphRep"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-var">GraphRep</span></a></span></span><span> </span><span id="local-6989586621679075304"><span class="annot"><a href="#local-6989586621679075304"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075303"><span class="annot"><a href="#local-6989586621679075303"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075304"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075303"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">type</span><span> </span><span id="Context%27"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-var">Context'</span></a></span></span><span> </span><span id="local-6989586621679075302"><span class="annot"><a href="#local-6989586621679075302"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075301"><span class="annot"><a href="#local-6989586621679075301"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075301"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075302"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075301"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="UGr"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#UGr"><span class="hs-identifier hs-var">UGr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- CLASS INSTANCES</span><span>
</span><span id="line-73"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span id="local-6989586621679075299"><span id="local-6989586621679075300"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075296"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679075300"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679075299"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075299"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075294"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075294"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075293"><span class="annot"><span class="annottext">== :: Gr a b -&gt; Gr a b -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075292"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075292"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; GraphRep a b -&gt; GraphRep a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall (f :: * -&gt; *) (f :: * -&gt; *) a a b.
(Functor f, Functor f, Ord a, Ord a) =&gt;
(f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621679075291"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075294"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; GraphRep a b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; GraphRep a b -&gt; GraphRep a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall (f :: * -&gt; *) (f :: * -&gt; *) a a b.
(Functor f, Functor f, Ord a, Ord a) =&gt;
(f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621679075291"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075292"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>      </span><span id="local-6989586621679075291"><span class="annot"><span class="annottext">sortAdj :: (f [a], b, f [a]) -&gt; (f [a], b, f [a])
</span><a href="#local-6989586621679075291"><span class="hs-identifier hs-var hs-var">sortAdj</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075290"><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621679075290"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075289"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075289"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075288"><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621679075288"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f [a] -&gt; f [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621679075290"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075289"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f [a] -&gt; f [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">f [a]
</span><a href="#local-6989586621679075288"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679075286"><span id="local-6989586621679075287"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075281"><span id="local-6989586621679075283"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679075287"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679075286"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075287"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075286"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679075279"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Gr a b -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679075277"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075277"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679075276"><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679075276"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075277"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-82"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGraph &quot;</span></span><span>
</span><span id="line-83"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LNode a] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><a href="Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var">labNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679075276"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-85"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679075276"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="local-6989586621679075267"><span id="local-6989586621679075268"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075260"><span id="local-6989586621679075262"><span id="local-6989586621679075264"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679075268"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679075267"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075268"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075267"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679075258"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS (Gr a b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span id="local-6989586621679075256"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075256"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a. Bool -&gt; ReadS a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075256"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReadS (Gr a b) -&gt; ReadS (Gr a b))
-&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679075254"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075254"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGraph&quot;</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075253"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075253"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS String
</span><span class="hs-identifier hs-var">lex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075254"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679075251"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679075251"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075250"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075250"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS [LNode a]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075253"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679075248"><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679075248"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075247"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075247"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS [LEdge b]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075250"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">(Gr a b, String) -&gt; [(Gr a b, String)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LNode a] -&gt; [LEdge b] -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-var">mkGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679075251"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679075248"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679075247"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075239"><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621679075234"><span class="annot"><span class="annottext">empty :: Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679075231"><span class="annot"><span class="annottext">isEmpty :: Gr a b -&gt; Bool
</span><a href="Data.Graph.Inductive.Graph.html#isEmpty"><span class="hs-identifier hs-var hs-var hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075229"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075229"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IM.null</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075229"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679075227"><span class="annot"><span class="annottext">match :: Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#match"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gr a b -&gt; Decomp Gr a b
forall a b. Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-var">matchGr</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679075224"><span class="annot"><span class="annottext">mkGraph :: [LNode a] -&gt; [LEdge b] -&gt; Gr a b
</span><a href="#local-6989586621679075224"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkGraph</span></a></span></span><span> </span><span id="local-6989586621679075223"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679075223"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679075222"><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679075222"><span class="hs-identifier hs-var">es</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; Gr a b -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) b a.
DynGraph gr =&gt;
[LEdge b] -&gt; gr a b -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#insEdges"><span class="hs-identifier hs-var">insEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679075222"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-102"></span><span>                      </span><span class="annot"><span class="annottext">(Gr a b -&gt; Gr a b) -&gt; ([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span>
</span><span id="line-103"></span><span>                      </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Gr a b)
-&gt; ([LNode a] -&gt; GraphRep a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Int, (IntMap [b], a, IntMap [b]))] -&gt; GraphRep a b
forall a. [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span>
</span><span id="line-104"></span><span>                      </span><span class="annot"><span class="annottext">([(Int, (IntMap [b], a, IntMap [b]))] -&gt; GraphRep a b)
-&gt; ([LNode a] -&gt; [(Int, (IntMap [b], a, IntMap [b]))])
-&gt; [LNode a]
-&gt; GraphRep a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LNode a -&gt; (Int, (IntMap [b], a, IntMap [b])))
-&gt; [LNode a] -&gt; [(Int, (IntMap [b], a, IntMap [b]))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; (IntMap [b], a, IntMap [b]))
-&gt; LNode a -&gt; (Int, (IntMap [b], a, IntMap [b]))
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679075218"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075218"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075218"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>                      </span><span class="annot"><span class="annottext">([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679075223"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679075217"><span class="annot"><span class="annottext">labNodes :: Gr a b -&gt; [LNode a]
</span><a href="#local-6989586621679075217"><span class="hs-identifier hs-var hs-var hs-var hs-var">labNodes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075216"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075216"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075215"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075214"><span class="hs-identifier hs-var">label</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075215"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075215"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075214"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075214"><span class="hs-identifier hs-var">label</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Int, Context' a b)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075216"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679075212"><span class="annot"><span class="annottext">noNodes :: Gr a b -&gt; Int
</span><a href="Data.Graph.Inductive.Graph.html#noNodes"><span class="hs-identifier hs-var hs-var hs-var hs-var">noNodes</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075210"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075210"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int
forall a. IntMap a -&gt; Int
</span><span class="hs-identifier hs-var">IM.size</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075210"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679075208"><span class="annot"><span class="annottext">nodeRange :: Gr a b -&gt; (Int, Int)
</span><a href="Data.Graph.Inductive.Graph.html#nodeRange"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075206"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075206"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Int, Int)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nodeRange of empty graph&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                       </span><span class="annot"><span class="annottext">(Maybe (Int, Int) -&gt; (Int, Int)) -&gt; Maybe (Int, Int) -&gt; (Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; (Int, Int))
-&gt; Maybe Int -&gt; Maybe Int -&gt; Maybe (Int, Int)
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Int, Context' a b), GraphRep a b) -&gt; Maybe Int
forall b b b. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679075204"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Int, Context' a b), GraphRep a b)
forall a. IntMap a -&gt; Maybe ((Int, a), IntMap a)
</span><span class="hs-identifier hs-var">IM.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075206"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Int, Context' a b), GraphRep a b) -&gt; Maybe Int
forall b b b. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679075204"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Int, Context' a b), GraphRep a b)
forall a. IntMap a -&gt; Maybe ((Int, a), IntMap a)
</span><span class="hs-identifier hs-var">IM.maxViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075206"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>        </span><span id="local-6989586621679075204"><span class="annot"><span class="annottext">ix :: Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679075204"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((b, b), b) -&gt; b) -&gt; Maybe ((b, b), b) -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b, b) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; b) -&gt; (((b, b), b) -&gt; (b, b)) -&gt; ((b, b), b) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, b), b) -&gt; (b, b)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679075201"><span class="annot"><span class="annottext">labEdges :: Gr a b -&gt; [LEdge b]
</span><a href="#local-6989586621679075201"><span class="hs-identifier hs-var hs-var hs-var hs-var">labEdges</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075200"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075200"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075199"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075199"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075198"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075198"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Int, Context' a b)]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075200"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-119"></span><span>                         </span><span class="hs-special">(</span><span id="local-6989586621679075197"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075197"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075196"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679075196"><span class="hs-identifier hs-var">labels</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; [(Int, [b])]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075198"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-120"></span><span>                         </span><span id="local-6989586621679075195"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075195"><span class="hs-identifier hs-var">label</span></a></span></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679075196"><span class="hs-identifier hs-var">labels</span></a></span><span>
</span><span id="line-121"></span><span>                         </span><span class="annot"><span class="annottext">LEdge b -&gt; [LEdge b]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075199"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075197"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075195"><span class="hs-identifier hs-var">label</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#DynGraph"><span class="hs-identifier hs-type">DynGraph</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679075191"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075191"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075190"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075190"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075189"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075189"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075188"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075188"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075187"><span class="annot"><span class="annottext">&amp; :: Context a b -&gt; Gr a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#%26"><span class="hs-operator hs-var hs-var hs-var hs-var">&amp;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075185"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075185"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679075184"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621679075184"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (IntMap [b], a, IntMap [b]) -&gt; GraphRep a b -&gt; GraphRep a b
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075190"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075182"><span class="hs-identifier hs-var">preds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075189"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075181"><span class="hs-identifier hs-var">succs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075185"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-126"></span><span>              </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679075180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075180"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075182"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075182"><span class="hs-identifier hs-var">preds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; (Int, IntMap [b])
forall b. Adj b -&gt; (Int, IntMap [b])
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var">fromAdjCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075191"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-127"></span><span>              </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679075178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075178"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075181"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075181"><span class="hs-identifier hs-var">succs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; (Int, IntMap [b])
forall b. Adj b -&gt; (Int, IntMap [b])
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var">fromAdjCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075188"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-128"></span><span>              </span><span class="hs-glyph">!</span><span id="local-6989586621679075177"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621679075177"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var">addSucc</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075184"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075190"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075180"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075182"><span class="hs-identifier hs-var">preds</span></a></span><span>
</span><span id="line-129"></span><span>              </span><span class="hs-glyph">!</span><span id="local-6989586621679075175"><span class="annot"><span class="annottext">g3 :: GraphRep a b
</span><a href="#local-6989586621679075175"><span class="hs-identifier hs-var hs-var">g3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b.
GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var">addPred</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075177"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075190"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075178"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075181"><span class="hs-identifier hs-var">succs</span></a></span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075175"><span class="hs-identifier hs-var">g3</span></a></span><span class="hs-cpp">

#if MIN_VERSION_containers (0,4,2)
</span><span id="local-6989586621679075172"><span id="local-6989586621679075173"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679075173"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679075172"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075173"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075172"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679075169"><span class="annot"><span class="annottext">rnf :: Gr a b -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075167"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075167"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075167"><span class="hs-identifier hs-var">g</span></a></span></span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base (4,8,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="local-6989586621679075162"><span class="annot"><span class="annottext">bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
forall a b c d. (a -&gt; c) -&gt; (b -&gt; d) -&gt; Gr a b -&gt; Gr c d
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-var">fastNEMap</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679075159"><span class="annot"><span class="annottext">first :: (a -&gt; b) -&gt; Gr a c -&gt; Gr b c
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">first</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Gr a c -&gt; Gr b c
forall a b c. (a -&gt; c) -&gt; Gr a b -&gt; Gr c b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-var">fastNMap</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679075156"><span class="annot"><span class="annottext">second :: (b -&gt; c) -&gt; Gr a b -&gt; Gr a c
</span><a href="#local-6989586621679075156"><span class="hs-identifier hs-var hs-var hs-var hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; Gr a b -&gt; Gr a c
forall a b c. (b -&gt; c) -&gt; Gr a b -&gt; Gr a c
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-var">fastEMap</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-146"></span><span id="local-6989586621679075153"><span id="local-6989586621679075154"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-type">matchGr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075154"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075153"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Decomp"><span class="hs-identifier hs-type">Decomp</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075154"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075153"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-147"></span><span id="matchGr"><span class="annot"><span class="annottext">matchGr :: Int -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#matchGr"><span class="hs-identifier hs-var hs-var">matchGr</span></a></span></span><span> </span><span id="local-6989586621679075151"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075150"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075150"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GraphRep a b -&gt; Maybe (Context' a b)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075150"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Context' a b)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075150"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075148"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075148"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075147"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075147"><span class="hs-identifier hs-var">label</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075146"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075146"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679075145"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621679075145"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075150"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-154"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679075143"><span class="annot"><span class="annottext">p' :: IntMap [b]
</span><a href="#local-6989586621679075143"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075148"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-155"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679075142"><span class="annot"><span class="annottext">s' :: IntMap [b]
</span><a href="#local-6989586621679075142"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075146"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-156"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679075141"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621679075141"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-var">clearPred</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075145"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075142"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-157"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679075139"><span class="annot"><span class="annottext">g3 :: GraphRep a b
</span><a href="#local-6989586621679075139"><span class="hs-identifier hs-var hs-var">g3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
forall a b x. GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-var">clearSucc</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075141"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075143"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-158"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b -&gt; Maybe (Context a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075143"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075151"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075147"><span class="hs-identifier hs-var">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075146"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075139"><span class="hs-identifier hs-var">g3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- OVERRIDING FUNCTIONS</span><span>
</span><span id="line-162"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;insNode/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#insNode"><span class="hs-pragma hs-type">insNode</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsNode"><span class="hs-pragma hs-type">fastInsNode</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span id="local-6989586621679075133"><span id="local-6989586621679075134"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsNode"><span class="hs-identifier hs-type">fastInsNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LNode"><span class="hs-identifier hs-type">LNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075134"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075134"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075133"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075134"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075133"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-168"></span><span id="fastInsNode"><span class="annot"><span class="annottext">fastInsNode :: LNode a -&gt; Gr a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsNode"><span class="hs-identifier hs-var hs-var">fastInsNode</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075132"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075132"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075131"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075130"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075130"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075129"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b -&gt; Gr a b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075129"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679075129"><span class="annot"><span class="annottext">g' :: GraphRep a b
</span><a href="#local-6989586621679075129"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (IntMap [b], a, IntMap [b]) -&gt; GraphRep a b -&gt; GraphRep a b
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075132"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075131"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075130"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;insEdge/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#insEdge"><span class="hs-pragma hs-type">insEdge</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-pragma hs-type">fastInsEdge</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-175"></span><span id="local-6989586621679075125"><span id="local-6989586621679075126"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-identifier hs-type">fastInsEdge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#LEdge"><span class="hs-identifier hs-type">LEdge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075126"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075126"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075126"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-176"></span><span id="fastInsEdge"><span class="annot"><span class="annottext">fastInsEdge :: LEdge b -&gt; Gr a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastInsEdge"><span class="hs-identifier hs-var hs-var">fastInsEdge</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075124"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075124"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075123"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075123"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075122"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075122"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075121"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075121"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075120"><span class="hs-identifier hs-var">g2</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b -&gt; Gr a b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075120"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679075119"><span class="annot"><span class="annottext">g1 :: GraphRep a b
</span><a href="#local-6989586621679075119"><span class="hs-identifier hs-var hs-var">g1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjust</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall a b. (a, b, IntMap [b]) -&gt; (a, b, IntMap [b])
</span><a href="#local-6989586621679075117"><span class="hs-identifier hs-var">addS'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075124"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075121"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679075120"><span class="annot"><span class="annottext">g2 :: GraphRep a b
</span><a href="#local-6989586621679075120"><span class="hs-identifier hs-var hs-var">g2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjust</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall b c. (IntMap [b], b, c) -&gt; (IntMap [b], b, c)
</span><a href="#local-6989586621679075116"><span class="hs-identifier hs-var">addP'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075119"><span class="hs-identifier hs-var">g1</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679075117"><span class="annot"><span class="annottext">addS' :: (a, b, IntMap [b]) -&gt; (a, b, IntMap [b])
</span><a href="#local-6989586621679075117"><span class="hs-identifier hs-var hs-var">addS'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075115"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075115"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075114"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075114"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075113"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075113"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075115"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075114"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075122"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075113"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679075116"><span class="annot"><span class="annottext">addP' :: (IntMap [b], b, c) -&gt; (IntMap [b], b, c)
</span><a href="#local-6989586621679075116"><span class="hs-identifier hs-var hs-var">addP'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075110"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075110"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075109"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075109"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075108"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679075108"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075124"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075122"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075110"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075109"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679075108"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;gmap/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#gmap"><span class="hs-pragma hs-type">gmap</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastGMap"><span class="hs-pragma hs-type">fastGMap</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastGMap"><span class="hs-identifier hs-type">fastGMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075105"><span class="annot"><a href="#local-6989586621679075105"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075104"><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679075103"><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679075102"><span class="annot"><a href="#local-6989586621679075102"><span class="hs-identifier hs-type">d</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075105"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075102"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075105"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075102"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-188"></span><span id="fastGMap"><span class="annot"><span class="annottext">fastGMap :: (Context a b -&gt; Context c d) -&gt; Gr a b -&gt; Gr c d
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastGMap"><span class="hs-identifier hs-var hs-var">fastGMap</span></a></span></span><span> </span><span id="local-6989586621679075101"><span class="annot"><span class="annottext">Context a b -&gt; Context c d
</span><a href="#local-6989586621679075101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075100"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075100"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep c d -&gt; Gr c d
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Context' a b -&gt; Context' c d)
-&gt; GraphRep a b -&gt; GraphRep c d
forall a b. (Int -&gt; a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Context' a b -&gt; Context' c d
</span><a href="#local-6989586621679075098"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075100"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621679075098"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075105"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075102"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679075098"><span class="annot"><span class="annottext">f' :: Int -&gt; Context' a b -&gt; Context' c d
</span><a href="#local-6989586621679075098"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context c d -&gt; Context' c d
forall a b. Context a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromContext"><span class="hs-identifier hs-var">fromContext</span></a></span><span> </span><span class="annot"><span class="annottext">(Context c d -&gt; Context' c d)
-&gt; (Context a b -&gt; Context c d) -&gt; Context a b -&gt; Context' c d
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Context c d
</span><a href="#local-6989586621679075101"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; Context' c d)
-&gt; (Context' a b -&gt; Context a b) -&gt; Context' a b -&gt; Context' c d
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Context' a b -&gt; Context a b) -&gt; Context' a b -&gt; Context' c d)
-&gt; (Int -&gt; Context' a b -&gt; Context a b)
-&gt; Int
-&gt; Context' a b
-&gt; Context' c d
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Context' a b -&gt; Context a b
forall a b. Int -&gt; Context' a b -&gt; Context a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toContext"><span class="hs-identifier hs-var">toContext</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;nmap/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#nmap"><span class="hs-pragma hs-type">nmap</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-pragma hs-type">fastNMap</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-type">fastNMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075423"><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075421"><span class="annot"><a href="#local-6989586621679075421"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679075422"><span class="annot"><a href="#local-6989586621679075422"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075422"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075421"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075422"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075421"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-197"></span><span id="fastNMap"><span class="annot"><span class="annottext">fastNMap :: (a -&gt; c) -&gt; Gr a b -&gt; Gr c b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastNMap"><span class="hs-identifier hs-var hs-var">fastNMap</span></a></span></span><span> </span><span id="local-6989586621679075094"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679075094"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075093"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075093"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep c b -&gt; Gr c b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' c b) -&gt; GraphRep a b -&gt; GraphRep c b
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' c b
</span><a href="#local-6989586621679075091"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075093"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679075091"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075423"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075421"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075422"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075421"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679075091"><span class="annot"><span class="annottext">f' :: Context' a b -&gt; Context' c b
</span><a href="#local-6989586621679075091"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075090"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075090"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075089"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075089"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075088"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075088"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075090"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679075094"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075089"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075088"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;emap/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#emap"><span class="hs-pragma hs-type">emap</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-pragma hs-type">fastEMap</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-205"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-type">fastEMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075415"><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075417"><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679075416"><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">c</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-206"></span><span id="fastEMap"><span class="annot"><span class="annottext">fastEMap :: (b -&gt; c) -&gt; Gr a b -&gt; Gr a c
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastEMap"><span class="hs-identifier hs-var hs-var">fastEMap</span></a></span></span><span> </span><span id="local-6989586621679075086"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679075086"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075085"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075085"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a c -&gt; Gr a c
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' a c) -&gt; GraphRep a b -&gt; GraphRep a c
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' a c
</span><a href="#local-6989586621679075084"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075085"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621679075084"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075417"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075416"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679075084"><span class="annot"><span class="annottext">f' :: Context' a b -&gt; Context' a c
</span><a href="#local-6989586621679075084"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075083"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075083"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075082"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075081"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075081"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [c]) -&gt; IntMap [b] -&gt; IntMap [c]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; [b] -&gt; [c]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679075086"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075083"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075082"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [c]) -&gt; IntMap [b] -&gt; IntMap [c]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; [b] -&gt; [c]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679075086"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075081"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="hs-pragma">&quot;nemap/Data.Graph.Inductive.PatriciaTree&quot;</span></span><span>  </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#nemap"><span class="hs-pragma hs-type">nemap</span></a></span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-pragma hs-type">fastNEMap</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-214"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-type">fastNEMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075430"><span class="annot"><a href="#local-6989586621679075430"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075428"><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679075429"><span class="annot"><a href="#local-6989586621679075429"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span id="local-6989586621679075427"><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">d</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075429"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075429"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-215"></span><span id="fastNEMap"><span class="annot"><span class="annottext">fastNEMap :: (a -&gt; c) -&gt; (b -&gt; d) -&gt; Gr a b -&gt; Gr c d
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fastNEMap"><span class="hs-identifier hs-var hs-var">fastNEMap</span></a></span></span><span> </span><span id="local-6989586621679075079"><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679075079"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679075078"><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679075078"><span class="hs-identifier hs-var">fe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679075077"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075077"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep c d -&gt; Gr c d
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' c d) -&gt; GraphRep a b -&gt; GraphRep c d
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Context' c d
</span><a href="#local-6989586621679075076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075077"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621679075076"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075428"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075429"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075427"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679075076"><span class="annot"><span class="annottext">f :: Context' a b -&gt; Context' c d
</span><a href="#local-6989586621679075076"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075075"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075075"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075074"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075074"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075073"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075073"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([b] -&gt; [d]) -&gt; IntMap [b] -&gt; IntMap [d]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; d) -&gt; [b] -&gt; [d]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679075078"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075075"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; c
</span><a href="#local-6989586621679075079"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075074"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [d]) -&gt; IntMap [b] -&gt; IntMap [d]
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
</span><span class="hs-identifier hs-var">IM.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; d) -&gt; [b] -&gt; [d]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; d
</span><a href="#local-6989586621679075078"><span class="hs-identifier hs-var">fe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075073"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- UTILITIES</span><span>
</span><span id="line-222"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span id="local-6989586621679075407"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-type">toAdj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075407"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075407"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-225"></span><span id="toAdj"><span class="annot"><span class="annottext">toAdj :: IntMap [b] -&gt; Adj b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var hs-var">toAdj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, [b]) -&gt; Adj b) -&gt; [(Int, [b])] -&gt; Adj b
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(Int, [b]) -&gt; Adj b
forall b a. (b, [a]) -&gt; [(a, b)]
</span><a href="#local-6989586621679075071"><span class="hs-identifier hs-var">expand</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, [b])] -&gt; Adj b)
-&gt; (IntMap [b] -&gt; [(Int, [b])]) -&gt; IntMap [b] -&gt; Adj b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; [(Int, [b])]
forall a. IntMap a -&gt; [(Int, a)]
</span><span class="hs-identifier hs-var">IM.toList</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679075071"><span class="annot"><span class="annottext">expand :: (b, [a]) -&gt; [(a, b)]
</span><a href="#local-6989586621679075071"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075070"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075070"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075069"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075069"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, b)) -&gt; [a] -&gt; [(a, b)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; (a, b)) -&gt; b -&gt; a -&gt; (a, b)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075070"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075069"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621679075338"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdj"><span class="hs-identifier hs-type">fromAdj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075338"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075338"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-230"></span><span id="fromAdj"><span class="annot"><span class="annottext">fromAdj :: Adj b -&gt; IntMap [b]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdj"><span class="hs-identifier hs-var hs-var">fromAdj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; [(Int, [b])] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromListWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, [b])] -&gt; IntMap [b])
-&gt; (Adj b -&gt; [(Int, [b])]) -&gt; Adj b -&gt; IntMap [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, Int) -&gt; (Int, [b])) -&gt; Adj b -&gt; [(Int, [b])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; [b]) -&gt; (Int, b) -&gt; (Int, [b])
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, b) -&gt; (Int, [b]))
-&gt; ((b, Int) -&gt; (Int, b)) -&gt; (b, Int) -&gt; (Int, [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b, Int) -&gt; (Int, b)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-keyword">data</span><span> </span><span id="FromListCounting"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span></span><span> </span><span id="local-6989586621679075349"><span class="annot"><a href="#local-6989586621679075349"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FromListCounting"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075061"><span id="local-6989586621679075063"><span class="annot"><span class="annottext">FromListCounting a -&gt; FromListCounting a -&gt; Bool
(FromListCounting a -&gt; FromListCounting a -&gt; Bool)
-&gt; (FromListCounting a -&gt; FromListCounting a -&gt; Bool)
-&gt; Eq (FromListCounting a)
forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FromListCounting a -&gt; FromListCounting a -&gt; Bool
$c/= :: forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
== :: FromListCounting a -&gt; FromListCounting a -&gt; Bool
$c== :: forall a. Eq a =&gt; FromListCounting a -&gt; FromListCounting a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075055"><span id="local-6989586621679075057"><span id="local-6989586621679075059"><span class="annot"><span class="annottext">Int -&gt; FromListCounting a -&gt; ShowS
[FromListCounting a] -&gt; ShowS
FromListCounting a -&gt; String
(Int -&gt; FromListCounting a -&gt; ShowS)
-&gt; (FromListCounting a -&gt; String)
-&gt; ([FromListCounting a] -&gt; ShowS)
-&gt; Show (FromListCounting a)
forall a. Show a =&gt; Int -&gt; FromListCounting a -&gt; ShowS
forall a. Show a =&gt; [FromListCounting a] -&gt; ShowS
forall a. Show a =&gt; FromListCounting a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FromListCounting a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [FromListCounting a] -&gt; ShowS
show :: FromListCounting a -&gt; String
$cshow :: forall a. Show a =&gt; FromListCounting a -&gt; String
showsPrec :: Int -&gt; FromListCounting a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FromListCounting a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075047"><span id="local-6989586621679075049"><span id="local-6989586621679075051"><span id="local-6989586621679075053"><span class="annot"><span class="annottext">ReadPrec [FromListCounting a]
ReadPrec (FromListCounting a)
Int -&gt; ReadS (FromListCounting a)
ReadS [FromListCounting a]
(Int -&gt; ReadS (FromListCounting a))
-&gt; ReadS [FromListCounting a]
-&gt; ReadPrec (FromListCounting a)
-&gt; ReadPrec [FromListCounting a]
-&gt; Read (FromListCounting a)
forall a. Read a =&gt; ReadPrec [FromListCounting a]
forall a. Read a =&gt; ReadPrec (FromListCounting a)
forall a. Read a =&gt; Int -&gt; ReadS (FromListCounting a)
forall a. Read a =&gt; ReadS [FromListCounting a]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [FromListCounting a]
$creadListPrec :: forall a. Read a =&gt; ReadPrec [FromListCounting a]
readPrec :: ReadPrec (FromListCounting a)
$creadPrec :: forall a. Read a =&gt; ReadPrec (FromListCounting a)
readList :: ReadS [FromListCounting a]
$creadList :: forall a. Read a =&gt; ReadS [FromListCounting a]
readsPrec :: Int -&gt; ReadS (FromListCounting a)
$creadsPrec :: forall a. Read a =&gt; Int -&gt; ReadS (FromListCounting a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span id="local-6989586621679075353"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-type">getFromListCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075353"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075353"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-236"></span><span id="getFromListCounting"><span class="annot"><span class="annottext">getFromListCounting :: FromListCounting a -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-var hs-var">getFromListCounting</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span id="local-6989586621679075045"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075045"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679075044"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679075044"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075045"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679075044"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-pragma hs-type">getFromListCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621679075345"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-type">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075345"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075345"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075345"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-240"></span><span id="fromListWithKeyCounting"><span class="annot"><span class="annottext">fromListWithKeyCounting :: (Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-var hs-var">fromListWithKeyCounting</span></a></span></span><span> </span><span id="local-6989586621679075042"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679075042"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FromListCounting a -&gt; (Int, IntMap a)
forall a. FromListCounting a -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#getFromListCounting"><span class="hs-identifier hs-var">getFromListCounting</span></a></span><span> </span><span class="annot"><span class="annottext">(FromListCounting a -&gt; (Int, IntMap a))
-&gt; ([(Int, a)] -&gt; FromListCounting a)
-&gt; [(Int, a)]
-&gt; (Int, IntMap a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a)
-&gt; FromListCounting a -&gt; [(Int, a)] -&gt; FromListCounting a
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a
</span><a href="#local-6989586621679075041"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; IntMap a -&gt; FromListCounting a
forall a. Int -&gt; IntMap a -&gt; FromListCounting a
</span><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">IntMap a
forall a. IntMap a
</span><span class="hs-identifier hs-var">IM.empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>    </span><span id="local-6989586621679075041"><span class="annot"><span class="annottext">ins :: FromListCounting a -&gt; (Int, a) -&gt; FromListCounting a
</span><a href="#local-6989586621679075041"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-type">FromListCounting</span></a></span><span> </span><span id="local-6989586621679075040"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075040"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679075039"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679075039"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075038"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075038"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679075037"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075037"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap a -&gt; FromListCounting a
forall a. Int -&gt; IntMap a -&gt; FromListCounting a
</span><a href="Data.Graph.Inductive.PatriciaTree.html#FromListCounting"><span class="hs-identifier hs-var">FromListCounting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075040"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
forall a. (Int -&gt; a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWithKey</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679075042"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075038"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075037"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679075039"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-pragma hs-type">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621679075343"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-type">fromListWithCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075343"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075343"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-246"></span><span id="fromListWithCounting"><span class="annot"><span class="annottext">fromListWithCounting :: (a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-var hs-var">fromListWithCounting</span></a></span></span><span> </span><span id="local-6989586621679075033"><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679075033"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
forall a. (Int -&gt; a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithKeyCounting"><span class="hs-identifier hs-var">fromListWithKeyCounting</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679075032"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075032"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679075031"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075031"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
</span><a href="#local-6989586621679075033"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075032"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075031"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-pragma hs-type">fromListWithCounting</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621679075448"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-type">fromAdjCounting</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075448"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075448"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span id="fromAdjCounting"><span class="annot"><span class="annottext">fromAdjCounting :: Adj b -&gt; (Int, IntMap [b])
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdjCounting"><span class="hs-identifier hs-var hs-var">fromAdjCounting</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; [(Int, [b])] -&gt; (Int, IntMap [b])
forall a. (a -&gt; a -&gt; a) -&gt; [(Int, a)] -&gt; (Int, IntMap a)
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromListWithCounting"><span class="hs-identifier hs-var">fromListWithCounting</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, [b])] -&gt; (Int, IntMap [b]))
-&gt; (Adj b -&gt; [(Int, [b])]) -&gt; Adj b -&gt; (Int, IntMap [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, Int) -&gt; (Int, [b])) -&gt; Adj b -&gt; [(Int, [b])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; [b]) -&gt; (Int, b) -&gt; (Int, [b])
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Int, b) -&gt; (Int, [b]))
-&gt; ((b, Int) -&gt; (Int, b)) -&gt; (b, Int) -&gt; (Int, [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(b, Int) -&gt; (Int, b)
forall a b. (a, b) -&gt; (b, a)
</span><span class="hs-identifier hs-var">swap</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- We use differenceWith to modify a graph more than bulkThreshold times,</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- and repeated insertWith otherwise.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-type">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-255"></span><span id="bulkThreshold"><span class="annot"><span class="annottext">bulkThreshold :: Int
</span><a href="Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var hs-var">bulkThreshold</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span id="local-6989586621679075385"><span id="local-6989586621679075386"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#toContext"><span class="hs-identifier hs-type">toContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075385"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075385"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-258"></span><span id="toContext"><span class="annot"><span class="annottext">toContext :: Int -&gt; Context' a b -&gt; Context a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toContext"><span class="hs-identifier hs-var hs-var">toContext</span></a></span></span><span> </span><span id="local-6989586621679075029"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075028"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075028"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075027"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075026"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075026"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075028"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075027"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b] -&gt; Adj b
forall b. IntMap [b] -&gt; Adj b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#toAdj"><span class="hs-identifier hs-var">toAdj</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075026"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679075387"><span id="local-6989586621679075388"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#fromContext"><span class="hs-identifier hs-type">fromContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075387"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075388"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075387"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-261"></span><span id="fromContext"><span class="annot"><span class="annottext">fromContext :: Context a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromContext"><span class="hs-identifier hs-var hs-var">fromContext</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075025"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075025"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075024"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075024"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075023"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075023"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b -&gt; IntMap [b]
forall b. Adj b -&gt; IntMap [b]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdj"><span class="hs-identifier hs-var">fromAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075025"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075024"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; IntMap [b]
forall b. Adj b -&gt; IntMap [b]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#fromAdj"><span class="hs-identifier hs-var">fromAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679075023"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- A version of @++@ where order isn't important, so @xs ++ [x]@</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- becomes @x:xs@.  Used when we have to have a function of type @[a]</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- -&gt; [a] -&gt; [a]@ but one of the lists is just going to be a single</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- element (and it isn't possible to tell which).</span><span>
</span><span id="line-267"></span><span id="local-6989586621679075395"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-type">addLists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-268"></span><span id="addLists"><span class="annot"><span class="annottext">addLists :: [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var hs-var">addLists</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679075022"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075022"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679075021"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075021"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075022"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075021"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span id="local-6989586621679075020"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075020"><span class="hs-keyword hs-var">as</span></a></span></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679075019"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075019"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075019"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075020"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span id="local-6989586621679075018"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075018"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span id="local-6989586621679075017"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075017"><span class="hs-identifier hs-var">ys</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075018"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679075017"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-type">addSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075447"><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075446"><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-273"></span><span id="addSucc"><span class="annot"><span class="annottext">addSucc :: GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var hs-var">addSucc</span></a></span></span><span> </span><span id="local-6989586621679075016"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span id="local-6989586621679075015"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075015"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679075014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075014"><span class="hs-identifier hs-var">numAdd</span></a></span></span><span> </span><span id="local-6989586621679075013"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075013"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075014"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b)
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var">foldlWithKey'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621679075010"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075013"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621679075010"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679075010"><span class="annot"><span class="annottext">go :: GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621679075010"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679075009"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075009"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679075008"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075008"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075007"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679075007"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.adjust</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall a b. (a, b, IntMap [b]) -&gt; (a, b, IntMap [b])
</span><a href="#local-6989586621679075005"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075008"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075009"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679075005"><span class="annot"><span class="annottext">f :: (a, b, IntMap [b]) -&gt; (a, b, IntMap [b])
</span><a href="#local-6989586621679075005"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679075004"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075004"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075003"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075003"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075002"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075002"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679075001"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621679075001"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075015"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679075007"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075002"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-279"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679075004"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679075003"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679075001"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addSucc"><span class="hs-identifier hs-var">addSucc</span></a></span><span> </span><span id="local-6989586621679075000"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075000"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679074999"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074999"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679074998"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074998"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b])
 -&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b]))
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.differenceWith</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b])
-&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621679074996"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679075000"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074998"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621679074996"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075447"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679074996"><span class="annot"><span class="annottext">go :: (IntMap [b], a, IntMap [b])
-&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621679074996"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074995"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074995"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074994"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074993"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074993"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679074992"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074992"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679074991"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621679074991"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074999"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074992"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074993"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-284"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; Maybe (IntMap [b], a, IntMap [b])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074995"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074994"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074991"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621679075333"><span id="local-6989586621679075334"><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-type">foldlWithKey'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075334"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.Key</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075333"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075334"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075334"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075333"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075334"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-287"></span><span id="foldlWithKey%27"><span class="annot"><span class="annottext">foldlWithKey' :: (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var hs-var">foldlWithKey'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if MIN_VERSION_containers (0,4,2)
</span><span>  </span><span class="annot"><span class="annottext">(a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><span class="hs-identifier hs-var">IM.foldlWithKey'</span></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">IM.foldWithKey</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">adjustFunc</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-identifier">adjustFunc</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">b</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-296"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-type">addPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679074988"><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679074987"><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-297"></span><span id="addPred"><span class="annot"><span class="annottext">addPred :: GraphRep a b -&gt; Int -&gt; Int -&gt; IntMap [b] -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var hs-var">addPred</span></a></span></span><span> </span><span id="local-6989586621679074986"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var">g0</span></a></span></span><span> </span><span id="local-6989586621679074985"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074985"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679074984"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074984"><span class="hs-identifier hs-var">numAdd</span></a></span></span><span> </span><span id="local-6989586621679074983"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074983"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074984"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.Graph.Inductive.PatriciaTree.html#bulkThreshold"><span class="hs-identifier hs-var">bulkThreshold</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b)
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; Int -&gt; b -&gt; a) -&gt; a -&gt; IntMap b -&gt; a
</span><a href="Data.Graph.Inductive.PatriciaTree.html#foldlWithKey%27"><span class="hs-identifier hs-var">foldlWithKey'</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621679074982"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074983"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621679074982"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679074982"><span class="annot"><span class="annottext">go :: GraphRep a b -&gt; Int -&gt; [b] -&gt; GraphRep a b
</span><a href="#local-6989586621679074982"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679074981"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074981"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679074980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074980"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679074979"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074979"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b]))
-&gt; Int -&gt; GraphRep a b -&gt; GraphRep a b
forall a. (a -&gt; a) -&gt; Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.adjust</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; (IntMap [b], a, IntMap [b])
forall b c. (IntMap [b], b, c) -&gt; (IntMap [b], b, c)
</span><a href="#local-6989586621679074978"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074980"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074981"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679074978"><span class="annot"><span class="annottext">f :: (IntMap [b], b, c) -&gt; (IntMap [b], b, c)
</span><a href="#local-6989586621679074978"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074977"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074977"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074976"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679074976"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074975"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679074975"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679074974"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621679074974"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074985"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074979"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074977"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-303"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074974"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679074976"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679074975"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#addPred"><span class="hs-identifier hs-var">addPred</span></a></span><span> </span><span id="local-6989586621679074973"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074973"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679074972"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074972"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679074971"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074971"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IntMap [b], a, IntMap [b])
 -&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b]))
-&gt; GraphRep a b -&gt; IntMap [b] -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.differenceWith</span></span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b])
-&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621679074970"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074973"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074971"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="#local-6989586621679074970"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074988"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074987"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679074970"><span class="annot"><span class="annottext">go :: (IntMap [b], a, IntMap [b])
-&gt; [b] -&gt; Maybe (IntMap [b], a, IntMap [b])
</span><a href="#local-6989586621679074970"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074969"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074969"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074968"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074968"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074967"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074967"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679074966"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074966"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679074965"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621679074965"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([b] -&gt; [b] -&gt; [b]) -&gt; Int -&gt; [b] -&gt; IntMap [b] -&gt; IntMap [b]
forall a. (a -&gt; a -&gt; a) -&gt; Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [b] -&gt; [b]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="Data.Graph.Inductive.PatriciaTree.html#addLists"><span class="hs-identifier hs-var">addLists</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074972"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679074966"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074969"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-308"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(IntMap [b], a, IntMap [b]) -&gt; Maybe (IntMap [b], a, IntMap [b])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074965"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074968"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074967"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-type">clearSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679074964"><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679074963"><span class="annot"><a href="#local-6989586621679074963"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679074962"><span class="annot"><a href="#local-6989586621679074962"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074963"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679074962"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074963"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-311"></span><span id="clearSucc"><span class="annot"><span class="annottext">clearSucc :: GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#clearSucc"><span class="hs-identifier hs-var hs-var">clearSucc</span></a></span></span><span> </span><span id="local-6989586621679074961"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074961"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679074960"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074960"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; x -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap x -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.differenceWith</span></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679074959"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074961"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="#local-6989586621679074959"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074963"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074962"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074963"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679074959"><span class="annot"><span class="annottext">go :: Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679074959"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074958"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074958"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074957"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074957"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074956"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074956"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679074955"><span class="annot"><span class="annottext">ss' :: IntMap [b]
</span><a href="#local-6989586621679074955"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074960"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074956"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-315"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074958"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074957"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074955"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-type">clearPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679075410"><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679075409"><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679075408"><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-318"></span><span id="clearPred"><span class="annot"><span class="annottext">clearPred :: GraphRep a b -&gt; Int -&gt; IntMap x -&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.PatriciaTree.html#clearPred"><span class="hs-identifier hs-var hs-var">clearPred</span></a></span></span><span> </span><span id="local-6989586621679074954"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074954"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679074953"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074953"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; x -&gt; Maybe (Context' a b))
-&gt; GraphRep a b -&gt; IntMap x -&gt; GraphRep a b
forall a b. (a -&gt; b -&gt; Maybe a) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap a
</span><span class="hs-identifier hs-var">IMS.differenceWith</span></span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679074952"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679074954"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621679074952"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075408"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.PatriciaTree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075409"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679074952"><span class="annot"><span class="annottext">go :: Context' a b -&gt; x -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679074952"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679074951"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074951"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074950"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074950"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679074949"><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074949"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679074948"><span class="annot"><span class="annottext">ps' :: IntMap [b]
</span><a href="#local-6989586621679074948"><span class="hs-identifier hs-var hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IntMap [b] -&gt; IntMap [b]
forall a. Int -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.delete</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679074953"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074951"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-322"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074948"><span class="hs-identifier hs-var">ps'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074950"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IntMap [b]
</span><a href="#local-6989586621679074949"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span></pre></body></html>