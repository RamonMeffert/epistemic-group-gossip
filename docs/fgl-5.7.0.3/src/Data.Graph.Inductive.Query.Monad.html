<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- (c) 2002 by Martin Erwig [see file COPYRIGHT]</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Monadic Graph Algorithms</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.Query.Monad</span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Additional Graph Utilities</span></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#mapFst"><span class="hs-identifier">mapFst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#mapSnd"><span class="hs-identifier">mapSnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#%3E%3C"><span class="hs-operator">(&gt;&lt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#orP"><span class="hs-identifier">orP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph Transformer Monad</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier">GT</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier">apply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#apply%27"><span class="hs-identifier">apply'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#applyWith"><span class="hs-identifier">applyWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#applyWith%27"><span class="hs-identifier">applyWith'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier">runGT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#condMGT%27"><span class="hs-identifier">condMGT'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#recMGT%27"><span class="hs-identifier">recMGT'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#condMGT"><span class="hs-identifier">condMGT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#recMGT"><span class="hs-identifier">recMGT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Graph Computations Based on Graph Monads</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Monadic Graph Accessing Functions</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNode"><span class="hs-identifier">getNode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getContext"><span class="hs-identifier">getContext</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNodes%27"><span class="hs-identifier">getNodes'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNodes"><span class="hs-identifier">getNodes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#sucGT"><span class="hs-identifier">sucGT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#sucM"><span class="hs-identifier">sucM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Derived Graph Recursion Operators</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphRec"><span class="hs-identifier">graphRec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphRec%27"><span class="hs-identifier">graphRec'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphUFold"><span class="hs-identifier">graphUFold</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Examples: Graph Algorithms as Instances of Recursion Operators</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Instances of graphRec</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM0"><span class="hs-identifier">graphNodesM0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM"><span class="hs-identifier">graphNodesM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodes"><span class="hs-identifier">graphNodes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphFilterM"><span class="hs-identifier">graphFilterM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphFilter"><span class="hs-identifier">graphFilter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Example: Monadic DFS Algorithm(s)</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier">dfsGT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsM"><span class="hs-identifier">dfsM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsM%27"><span class="hs-identifier">dfsM'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier">dffM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphDff"><span class="hs-identifier">graphDff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphDff%27"><span class="hs-identifier">graphDff'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Why all this?</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- graph monad ensures single-threaded access</span><span>
</span><span id="line-28"></span><span class="hs-comment">--  ==&gt; we can safely use imperative updates in the graph implementation</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftM2</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Monad.html"><span class="hs-identifier">Data.Graph.Inductive.Monad</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- some additional (graph) utilities</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span id="local-6989586621679077769"><span id="local-6989586621679077770"><span id="local-6989586621679077771"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#mapFst"><span class="hs-identifier hs-type">mapFst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077769"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077770"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077769"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-44"></span><span id="mapFst"><span class="annot"><span class="annottext">mapFst :: (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
</span><a href="Data.Graph.Inductive.Query.Monad.html#mapFst"><span class="hs-identifier hs-var hs-var">mapFst</span></a></span></span><span> </span><span id="local-6989586621679077768"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077768"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077767"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077767"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077766"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077768"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077767"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span id="local-6989586621679077763"><span id="local-6989586621679077764"><span id="local-6989586621679077765"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#mapSnd"><span class="hs-identifier hs-type">mapSnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077765"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077764"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077763"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077765"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077763"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077764"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-46"></span><span id="mapSnd"><span class="annot"><span class="annottext">mapSnd :: (a -&gt; b) -&gt; (c, a) -&gt; (c, b)
</span><a href="Data.Graph.Inductive.Query.Monad.html#mapSnd"><span class="hs-identifier hs-var hs-var">mapSnd</span></a></span></span><span> </span><span id="local-6989586621679077762"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077762"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077761"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077761"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077760"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077761"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077762"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">8</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#%3E%3C"><span class="hs-operator hs-type">&gt;&lt;</span></a></span><span>
</span><span id="line-49"></span><span id="local-6989586621679077756"><span id="local-6989586621679077757"><span id="local-6989586621679077758"><span id="local-6989586621679077759"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#%3E%3C"><span class="hs-operator hs-type">(&gt;&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077759"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077758"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077757"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077756"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077757"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077758"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679077756"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-50"></span><span class="hs-special">(</span><span id="local-6989586621679077755"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="%3E%3C"><span class="annot"><span class="annottext">&gt;&lt; :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
</span><a href="Data.Graph.Inductive.Query.Monad.html#%3E%3C"><span class="hs-operator hs-var hs-var">&gt;&lt;</span></a></span></span><span> </span><span id="local-6989586621679077754"><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679077754"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077753"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077753"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077752"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077752"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077753"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679077754"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679077752"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span id="local-6989586621679077750"><span id="local-6989586621679077751"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#orP"><span class="hs-identifier hs-type">orP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077751"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077750"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077751"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679077750"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-53"></span><span id="orP"><span class="annot"><span class="annottext">orP :: (a -&gt; Bool) -&gt; (b -&gt; Bool) -&gt; (a, b) -&gt; Bool
</span><a href="Data.Graph.Inductive.Query.Monad.html#orP"><span class="hs-identifier hs-var hs-var">orP</span></a></span></span><span> </span><span id="local-6989586621679077749"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679077749"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679077748"><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679077748"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077747"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077747"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077746"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077746"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679077749"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
</span><a href="#local-6989586621679077748"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077746"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &quot;wrapped&quot; state transformer monad   ==</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- monadic graph transformer monad</span><span>
</span><span id="line-58"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">newtype</span><span> </span><span id="GT"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-var">GT</span></a></span></span><span> </span><span id="local-6989586621679078020"><span class="annot"><a href="#local-6989586621679078020"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679078019"><span class="annot"><a href="#local-6989586621679078019"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679078018"><span class="annot"><a href="#local-6989586621679078018"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MGT"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078020"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078019"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078020"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078019"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span id="local-6989586621679078090"><span id="local-6989586621679078091"><span id="local-6989586621679078092"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078092"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078091"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078090"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078092"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078091"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078092"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078090"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078091"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-63"></span><span id="apply"><span class="annot"><span class="annottext">apply :: GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-type">MGT</span></a></span><span> </span><span id="local-6989586621679077743"><span class="annot"><span class="annottext">m g -&gt; m (a, g)
</span><a href="#local-6989586621679077743"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; m (a, g)
</span><a href="#local-6989586621679077743"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679078013"><span id="local-6989586621679078014"><span id="local-6989586621679078015"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#apply%27"><span class="hs-identifier hs-type">apply'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679078015"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078015"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078014"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078013"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078014"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078015"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078013"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078014"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-66"></span><span id="apply%27"><span class="annot"><span class="annottext">apply' :: GT m g a -&gt; g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply%27"><span class="hs-identifier hs-var hs-var">apply'</span></a></span></span><span> </span><span id="local-6989586621679077742"><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077742"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m g a -&gt; m g -&gt; m (a, g)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077742"><span class="hs-identifier hs-var">gt</span></a></span><span> </span><span class="annot"><span class="annottext">(m g -&gt; m (a, g)) -&gt; (g -&gt; m g) -&gt; g -&gt; m (a, g)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g -&gt; m g
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span id="local-6989586621679078073"><span id="local-6989586621679078074"><span id="local-6989586621679078075"><span id="local-6989586621679078076"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#applyWith"><span class="hs-identifier hs-type">applyWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679078076"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078074"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078073"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078073"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078074"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078073"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-69"></span><span id="applyWith"><span class="annot"><span class="annottext">applyWith :: (a -&gt; b) -&gt; GT m g a -&gt; m g -&gt; m (b, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#applyWith"><span class="hs-identifier hs-var hs-var">applyWith</span></a></span></span><span> </span><span id="local-6989586621679077740"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077740"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-type">MGT</span></a></span><span> </span><span id="local-6989586621679077739"><span class="annot"><span class="annottext">m g -&gt; m (a, g)
</span><a href="#local-6989586621679077739"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679077738"><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077738"><span class="hs-identifier hs-var">gm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679077737"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077737"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077736"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077736"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m g -&gt; m (a, g)
</span><a href="#local-6989586621679077739"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077738"><span class="hs-identifier hs-var">gm</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(b, g) -&gt; m (b, g)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077740"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077737"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077736"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679077850"><span id="local-6989586621679077851"><span id="local-6989586621679077852"><span id="local-6989586621679077853"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#applyWith%27"><span class="hs-identifier hs-type">applyWith'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077853"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077851"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077853"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077850"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077852"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077850"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077853"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077851"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679077850"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-72"></span><span id="applyWith%27"><span class="annot"><span class="annottext">applyWith' :: (a -&gt; b) -&gt; GT m g a -&gt; g -&gt; m (b, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#applyWith%27"><span class="hs-identifier hs-var hs-var">applyWith'</span></a></span></span><span> </span><span id="local-6989586621679077735"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679077734"><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077734"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; GT m g a -&gt; m g -&gt; m (b, g)
forall (m :: * -&gt; *) a b g.
Monad m =&gt;
(a -&gt; b) -&gt; GT m g a -&gt; m g -&gt; m (b, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#applyWith"><span class="hs-identifier hs-var">applyWith</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077734"><span class="hs-identifier hs-var">gt</span></a></span><span> </span><span class="annot"><span class="annottext">(m g -&gt; m (b, g)) -&gt; (g -&gt; m g) -&gt; g -&gt; m (b, g)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g -&gt; m g
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span id="local-6989586621679077918"><span id="local-6989586621679077919"><span id="local-6989586621679077920"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-type">runGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077920"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077919"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077918"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077919"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077920"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077918"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-75"></span><span id="runGT"><span class="annot"><span class="annottext">runGT :: GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var hs-var">runGT</span></a></span></span><span> </span><span id="local-6989586621679077733"><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077733"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span id="local-6989586621679077732"><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077732"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679077731"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077731"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">g
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GT m g a -&gt; m g -&gt; m (a, g)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077733"><span class="hs-identifier hs-var">gt</span></a></span><span> </span><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077732"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077731"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679077729"><span id="local-6989586621679077730"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077726"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077730"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077730"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077729"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679077724"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; GT m g a -&gt; GT m g b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; GT m g a -&gt; GT m g b
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679077722"><span id="local-6989586621679077723"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077713"><span id="local-6989586621679077715"><span id="local-6989586621679077717"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077722"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679077711"><span class="annot"><span class="annottext">pure :: a -&gt; GT m g a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; GT m g a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679077710"><span class="annot"><span class="annottext">&lt;*&gt; :: GT m g (a -&gt; b) -&gt; GT m g a -&gt; GT m g b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m g (a -&gt; b) -&gt; GT m g a -&gt; GT m g b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span></span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679077708"><span id="local-6989586621679077709"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077704"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077709"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077709"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077708"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679077701"><span class="annot"><span class="annottext">return :: a -&gt; GT m g a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></span></span><span> </span><span id="local-6989586621679077700"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077700"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m g -&gt; m (a, g)) -&gt; GT m g a
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077699"><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077699"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077698"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077698"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077699"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(a, g) -&gt; m (a, g)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077700"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077698"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679077697"><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077697"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679077696"><span class="annot"><span class="annottext">&gt;&gt;= :: GT m g a -&gt; (a -&gt; GT m g b) -&gt; GT m g b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621679077695"><span class="annot"><span class="annottext">a -&gt; GT m g b
</span><a href="#local-6989586621679077695"><span class="hs-identifier hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m g -&gt; m (b, g)) -&gt; GT m g b
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077694"><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077694"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span id="local-6989586621679077693"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077693"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077692"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077692"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">GT m g a -&gt; m g -&gt; m (a, g)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m g a
</span><a href="#local-6989586621679077697"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m g
</span><a href="#local-6989586621679077694"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">GT m g b -&gt; g -&gt; m (b, g)
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply%27"><span class="hs-identifier hs-var">apply'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; GT m g b
</span><a href="#local-6989586621679077695"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077693"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679077692"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679078003"><span id="local-6989586621679078004"><span id="local-6989586621679078005"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#condMGT%27"><span class="hs-identifier hs-type">condMGT'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679078005"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078003"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078003"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078005"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078004"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078003"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-89"></span><span id="condMGT%27"><span class="annot"><span class="annottext">condMGT' :: (s -&gt; Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT%27"><span class="hs-identifier hs-var hs-var">condMGT'</span></a></span></span><span> </span><span id="local-6989586621679077691"><span class="annot"><span class="annottext">s -&gt; Bool
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679077690"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679077689"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077689"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m s -&gt; m (a, s)) -&gt; GT m s a
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077688"><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077687"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">s -&gt; Bool
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GT m s a -&gt; m s -&gt; m (a, s)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GT m s a -&gt; m s -&gt; m (a, s)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077689"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679077999"><span id="local-6989586621679078000"><span id="local-6989586621679078001"><span id="local-6989586621679078002"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#recMGT%27"><span class="hs-identifier hs-type">recMGT'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679078002"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078000"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078000"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077999"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077999"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077999"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078002"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077999"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-92"></span><span id="recMGT%27"><span class="annot"><span class="annottext">recMGT' :: (s -&gt; Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT%27"><span class="hs-identifier hs-var hs-var">recMGT'</span></a></span></span><span> </span><span id="local-6989586621679077686"><span class="annot"><span class="annottext">s -&gt; Bool
</span><a href="#local-6989586621679077686"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679077685"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077685"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span id="local-6989586621679077684"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077684"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679077683"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; Bool) -&gt; GT m s b -&gt; GT m s b -&gt; GT m s b
forall (m :: * -&gt; *) s a.
Monad m =&gt;
(s -&gt; Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT%27"><span class="hs-identifier hs-var">condMGT'</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Bool
</span><a href="#local-6989586621679077686"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; GT m s b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                            </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077682"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077682"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077685"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span id="local-6989586621679077681"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077681"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">(s -&gt; Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
forall (m :: * -&gt; *) s a b.
Monad m =&gt;
(s -&gt; Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT%27"><span class="hs-identifier hs-var">recMGT'</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Bool
</span><a href="#local-6989586621679077686"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077685"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">;</span><span class="annot"><span class="annottext">b -&gt; GT m s b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077682"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077681"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621679077989"><span id="local-6989586621679077990"><span id="local-6989586621679077991"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#condMGT"><span class="hs-identifier hs-type">condMGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077990"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077990"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077990"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077990"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077989"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-96"></span><span id="condMGT"><span class="annot"><span class="annottext">condMGT :: (m s -&gt; m Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT"><span class="hs-identifier hs-var hs-var">condMGT</span></a></span></span><span> </span><span id="local-6989586621679077680"><span class="annot"><span class="annottext">m s -&gt; m Bool
</span><a href="#local-6989586621679077680"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679077679"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077679"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679077678"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077678"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m s -&gt; m (a, s)) -&gt; GT m s a
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077677"><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077676"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077676"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">m s -&gt; m Bool
</span><a href="#local-6989586621679077680"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077676"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GT m s a -&gt; m s -&gt; m (a, s)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077679"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">GT m s a -&gt; m s -&gt; m (a, s)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077678"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">m s
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span id="local-6989586621679077985"><span id="local-6989586621679077986"><span id="local-6989586621679077987"><span id="local-6989586621679077988"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#recMGT"><span class="hs-identifier hs-type">recMGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679077988"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077986"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077985"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077985"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077985"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077988"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077987"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077985"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-99"></span><span id="recMGT"><span class="annot"><span class="annottext">recMGT :: (m s -&gt; m Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT"><span class="hs-identifier hs-var hs-var">recMGT</span></a></span></span><span> </span><span id="local-6989586621679077675"><span class="annot"><span class="annottext">m s -&gt; m Bool
</span><a href="#local-6989586621679077675"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679077674"><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077674"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span id="local-6989586621679077673"><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679077672"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077672"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m s -&gt; m Bool) -&gt; GT m s b -&gt; GT m s b -&gt; GT m s b
forall (m :: * -&gt; *) s a.
Monad m =&gt;
(m s -&gt; m Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT"><span class="hs-identifier hs-var">condMGT</span></a></span><span> </span><span class="annot"><span class="annottext">m s -&gt; m Bool
</span><a href="#local-6989586621679077675"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; GT m s b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077672"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                          </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077671"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077674"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span id="local-6989586621679077670"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">(m s -&gt; m Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
forall (m :: * -&gt; *) s a b.
Monad m =&gt;
(m s -&gt; m Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT"><span class="hs-identifier hs-var">recMGT</span></a></span><span> </span><span class="annot"><span class="annottext">m s -&gt; m Bool
</span><a href="#local-6989586621679077675"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GT m s a
</span><a href="#local-6989586621679077674"><span class="hs-identifier hs-var">mg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077672"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">;</span><span class="annot"><span class="annottext">b -&gt; GT m s b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; b
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- graph computations based on state monads/graph monads</span><span>
</span><span id="line-105"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- some monadic graph accessing functions</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span id="local-6989586621679077937"><span id="local-6989586621679077938"><span id="local-6989586621679077939"><span id="local-6989586621679077940"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNode"><span class="hs-identifier hs-type">getNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077940"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077939"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077940"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077939"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077938"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077937"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span></span></span></span></span><span>
</span><span id="line-111"></span><span id="getNode"><span class="annot"><span class="annottext">getNode :: GT m (gr a b) Node
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNode"><span class="hs-identifier hs-var hs-var">getNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m (Node, gr a b)) -&gt; GT m (gr a b) Node
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077669"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077669"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077668"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077668"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621679077667"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077667"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m (Context a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m (GDecomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchAnyM"><span class="hs-identifier hs-var">matchAnyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077669"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">(Node, gr a b) -&gt; m (Node, gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077668"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077667"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679077887"><span id="local-6989586621679077888"><span id="local-6989586621679077889"><span id="local-6989586621679077890"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getContext"><span class="hs-identifier hs-type">getContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077890"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077889"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077890"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077889"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077887"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077887"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-114"></span><span id="getContext"><span class="annot"><span class="annottext">getContext :: GT m (gr a b) (Context a b)
</span><a href="Data.Graph.Inductive.Query.Monad.html#getContext"><span class="hs-identifier hs-var hs-var">getContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m (Context a b, gr a b))
-&gt; GT m (gr a b) (Context a b)
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m (Context a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m (GDecomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchAnyM"><span class="hs-identifier hs-var">matchAnyM</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- some functions defined by using the do-notation explicitly</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Note: most of these can be expressed as an instance of graphRec</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span id="local-6989586621679077662"><span id="local-6989586621679077663"><span id="local-6989586621679077664"><span id="local-6989586621679077665"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNodes%27"><span class="hs-identifier hs-type">getNodes'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077665"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077664"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077665"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077664"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077665"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077663"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-120"></span><span id="getNodes%27"><span class="annot"><span class="annottext">getNodes' :: GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNodes%27"><span class="hs-identifier hs-var hs-var">getNodes'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(gr a b -&gt; Bool)
-&gt; GT m (gr a b) [Node]
-&gt; GT m (gr a b) [Node]
-&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) s a.
Monad m =&gt;
(s -&gt; Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT%27"><span class="hs-identifier hs-var">condMGT'</span></a></span><span> </span><span class="annot"><span class="annottext">gr a b -&gt; Bool
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; Bool
</span><a href="Data.Graph.Inductive.Graph.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#nodeGetter"><span class="hs-identifier hs-var">nodeGetter</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679077656"><span id="local-6989586621679077657"><span id="local-6989586621679077658"><span id="local-6989586621679077659"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#getNodes"><span class="hs-identifier hs-type">getNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077659"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077658"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077659"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077658"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077657"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077656"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-123"></span><span id="getNodes"><span class="annot"><span class="annottext">getNodes :: GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNodes"><span class="hs-identifier hs-var hs-var">getNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m Bool)
-&gt; GT m (gr a b) [Node]
-&gt; GT m (gr a b) [Node]
-&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) s a.
Monad m =&gt;
(m s -&gt; m Bool) -&gt; GT m s a -&gt; GT m s a -&gt; GT m s a
</span><a href="Data.Graph.Inductive.Query.Monad.html#condMGT"><span class="hs-identifier hs-var">condMGT</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#nodeGetter"><span class="hs-identifier hs-var">nodeGetter</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679077955"><span id="local-6989586621679077956"><span id="local-6989586621679077957"><span id="local-6989586621679077958"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#nodeGetter"><span class="hs-identifier hs-type">nodeGetter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077958"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077957"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077955"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-126"></span><span id="nodeGetter"><span class="annot"><span class="annottext">nodeGetter :: GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#nodeGetter"><span class="hs-identifier hs-var hs-var">nodeGetter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node -&gt; [Node] -&gt; [Node])
-&gt; GT m (gr a b) Node
-&gt; GT m (gr a b) [Node]
-&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) a1 a2 r.
Monad m =&gt;
(a1 -&gt; a2 -&gt; r) -&gt; m a1 -&gt; m a2 -&gt; m r
</span><span class="hs-identifier hs-var">liftM2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) Node
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) Node
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNode"><span class="hs-identifier hs-var">getNode</span></a></span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNodes"><span class="hs-identifier hs-var">getNodes</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621679077914"><span id="local-6989586621679077915"><span id="local-6989586621679077916"><span id="local-6989586621679077917"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#sucGT"><span class="hs-identifier hs-type">sucGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077917"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077916"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077917"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077916"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077915"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077914"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-129"></span><span id="sucGT"><span class="annot"><span class="annottext">sucGT :: Node -&gt; GT m (gr a b) (Maybe [Node])
</span><a href="Data.Graph.Inductive.Query.Monad.html#sucGT"><span class="hs-identifier hs-var hs-var">sucGT</span></a></span></span><span> </span><span id="local-6989586621679077654"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077654"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m (Maybe [Node], gr a b))
-&gt; GT m (gr a b) (Maybe [Node])
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077653"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077653"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077652"><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077651"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077651"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077654"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077653"><span class="hs-identifier hs-var">mg</span></a></span><span>
</span><span id="line-130"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077649"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077649"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe [Node], gr a b) -&gt; m (Maybe [Node], gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; Maybe [Node]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Node) -&gt; Node) -&gt; Adj b -&gt; [Node]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(b, Node) -&gt; Node
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077649"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077651"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                         </span><span class="annot"><span class="annottext">MContext a b
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe [Node], gr a b) -&gt; m (Maybe [Node], gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Node]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077651"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679077645"><span id="local-6989586621679077646"><span id="local-6989586621679077647"><span id="local-6989586621679077648"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#sucM"><span class="hs-identifier hs-type">sucM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077648"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077647"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077648"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077647"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077646"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077645"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077648"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-136"></span><span id="sucM"><span class="annot"><span class="annottext">sucM :: Node -&gt; m (gr a b) -&gt; m (Maybe [Node])
</span><a href="Data.Graph.Inductive.Query.Monad.html#sucM"><span class="hs-identifier hs-var hs-var">sucM</span></a></span></span><span> </span><span id="local-6989586621679077644"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077644"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) (Maybe [Node]) -&gt; m (gr a b) -&gt; m (Maybe [Node])
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; GT m (gr a b) (Maybe [Node])
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; GT m (gr a b) (Maybe [Node])
</span><a href="Data.Graph.Inductive.Query.Monad.html#sucGT"><span class="hs-identifier hs-var">sucGT</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077644"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- some derived graph recursion operators</span><span>
</span><span id="line-142"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- graphRec :: GraphMonad a b c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GraphMonad a b d</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- graphRec f g u = cond isEmpty (return u)</span><span>
</span><span id="line-147"></span><span class="hs-comment">--                               (do x &lt;- f</span><span>
</span><span id="line-148"></span><span class="hs-comment">--                                   y &lt;- graphRec f g u</span><span>
</span><span id="line-149"></span><span class="hs-comment">--                                   return (g x y))</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | encapsulates a simple recursion schema on graphs</span><span>
</span><span id="line-152"></span><span id="local-6989586621679077891"><span id="local-6989586621679077892"><span id="local-6989586621679077893"><span id="local-6989586621679077894"><span id="local-6989586621679077895"><span id="local-6989586621679077896"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphRec"><span class="hs-identifier hs-type">graphRec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077895"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077895"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077893"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679077892"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077892"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077891"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077891"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077891"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077896"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077895"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077893"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679077891"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-154"></span><span id="graphRec"><span class="annot"><span class="annottext">graphRec :: GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphRec"><span class="hs-identifier hs-var hs-var">graphRec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m Bool)
-&gt; GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
forall (m :: * -&gt; *) s a b.
Monad m =&gt;
(m s -&gt; m Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT"><span class="hs-identifier hs-var">recMGT</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679077638"><span id="local-6989586621679077639"><span id="local-6989586621679077640"><span id="local-6989586621679077641"><span id="local-6989586621679077642"><span id="local-6989586621679077643"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphRec%27"><span class="hs-identifier hs-type">graphRec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077642"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077642"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077641"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077640"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679077639"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077639"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077638"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077638"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077638"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077642"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077641"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077640"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679077638"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-158"></span><span id="graphRec%27"><span class="annot"><span class="annottext">graphRec' :: GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphRec%27"><span class="hs-identifier hs-var hs-var">graphRec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(gr a b -&gt; Bool)
-&gt; GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
forall (m :: * -&gt; *) s a b.
Monad m =&gt;
(s -&gt; Bool) -&gt; GT m s a -&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; GT m s b
</span><a href="Data.Graph.Inductive.Query.Monad.html#recMGT%27"><span class="hs-identifier hs-var">recMGT'</span></a></span><span> </span><span class="annot"><span class="annottext">gr a b -&gt; Bool
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; Bool
</span><a href="Data.Graph.Inductive.Graph.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679077874"><span id="local-6989586621679077875"><span id="local-6989586621679077876"><span id="local-6989586621679077877"><span id="local-6989586621679077878"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphUFold"><span class="hs-identifier hs-type">graphUFold</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077877"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077876"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077875"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077874"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077874"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077874"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077878"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077877"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077876"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077875"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679077874"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span></span><span>
</span><span id="line-161"></span><span id="graphUFold"><span class="annot"><span class="annottext">graphUFold :: (Context a b -&gt; c -&gt; c) -&gt; c -&gt; GT m (gr a b) c
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphUFold"><span class="hs-identifier hs-var hs-var">graphUFold</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) (Context a b)
-&gt; (Context a b -&gt; c -&gt; c) -&gt; c -&gt; GT m (gr a b) c
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c d.
GraphM m gr =&gt;
GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphRec"><span class="hs-identifier hs-var">graphRec</span></a></span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) (Context a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) (Context a b)
</span><a href="Data.Graph.Inductive.Query.Monad.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Examples: graph algorithms as instances of recursion operators</span><span>
</span><span id="line-167"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- instances of graphRec</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span id="local-6989586621679077634"><span id="local-6989586621679077635"><span id="local-6989586621679077636"><span id="local-6989586621679077637"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM0"><span class="hs-identifier hs-type">graphNodesM0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077637"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077636"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077637"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077636"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077635"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077634"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-172"></span><span id="graphNodesM0"><span class="annot"><span class="annottext">graphNodesM0 :: GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM0"><span class="hs-identifier hs-var hs-var">graphNodesM0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) Node
-&gt; (Node -&gt; [Node] -&gt; [Node]) -&gt; [Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c d.
GraphM m gr =&gt;
GT m (gr a b) c -&gt; (c -&gt; d -&gt; d) -&gt; d -&gt; GT m (gr a b) d
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphRec"><span class="hs-identifier hs-var">graphRec</span></a></span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) Node
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) Node
</span><a href="Data.Graph.Inductive.Query.Monad.html#getNode"><span class="hs-identifier hs-var">getNode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679077630"><span id="local-6989586621679077631"><span id="local-6989586621679077632"><span id="local-6989586621679077633"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM"><span class="hs-identifier hs-type">graphNodesM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077633"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077632"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077633"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077632"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077631"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077630"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-175"></span><span id="graphNodesM"><span class="annot"><span class="annottext">graphNodesM :: GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM"><span class="hs-identifier hs-var hs-var">graphNodesM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; [Node] -&gt; [Node]) -&gt; [Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c -&gt; c) -&gt; c -&gt; GT m (gr a b) c
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphUFold"><span class="hs-identifier hs-var">graphUFold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077629"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077629"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077629"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679077625"><span id="local-6989586621679077626"><span id="local-6989586621679077627"><span id="local-6989586621679077628"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphNodes"><span class="hs-identifier hs-type">graphNodes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077627"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077627"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077625"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-178"></span><span id="graphNodes"><span class="annot"><span class="annottext">graphNodes :: m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphNodes"><span class="hs-identifier hs-var hs-var">graphNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node] -&gt; m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphNodesM"><span class="hs-identifier hs-var">graphNodesM</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span id="local-6989586621679077858"><span id="local-6989586621679077859"><span id="local-6989586621679077860"><span id="local-6989586621679077861"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphFilterM"><span class="hs-identifier hs-type">graphFilterM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077861"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077860"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077858"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>                              </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077861"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077860"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077858"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077858"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-182"></span><span id="graphFilterM"><span class="annot"><span class="annottext">graphFilterM :: (Context a b -&gt; Bool) -&gt; GT m (gr a b) [Context a b]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphFilterM"><span class="hs-identifier hs-var hs-var">graphFilterM</span></a></span></span><span> </span><span id="local-6989586621679077624"><span class="annot"><span class="annottext">Context a b -&gt; Bool
</span><a href="#local-6989586621679077624"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Context a b -&gt; [Context a b] -&gt; [Context a b])
-&gt; [Context a b] -&gt; GT m (gr a b) [Context a b]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b c.
GraphM m gr =&gt;
(Context a b -&gt; c -&gt; c) -&gt; c -&gt; GT m (gr a b) c
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphUFold"><span class="hs-identifier hs-var">graphUFold</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077623"><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077623"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679077622"><span class="annot"><span class="annottext">[Context a b]
</span><a href="#local-6989586621679077622"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Bool
</span><a href="#local-6989586621679077624"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077623"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077623"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Context a b -&gt; [Context a b] -&gt; [Context a b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Context a b]
</span><a href="#local-6989586621679077622"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Context a b]
</span><a href="#local-6989586621679077622"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span id="local-6989586621679077618"><span id="local-6989586621679077619"><span id="local-6989586621679077620"><span id="local-6989586621679077621"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphFilter"><span class="hs-identifier hs-type">graphFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077620"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077618"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077620"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077618"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077621"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077618"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-185"></span><span id="graphFilter"><span class="annot"><span class="annottext">graphFilter :: (Context a b -&gt; Bool) -&gt; m (gr a b) -&gt; m [Context a b]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphFilter"><span class="hs-identifier hs-var hs-var">graphFilter</span></a></span></span><span> </span><span id="local-6989586621679077617"><span class="annot"><span class="annottext">Context a b -&gt; Bool
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Context a b] -&gt; m (gr a b) -&gt; m [Context a b]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context a b -&gt; Bool) -&gt; GT m (gr a b) [Context a b]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
(Context a b -&gt; Bool) -&gt; GT m (gr a b) [Context a b]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphFilterM"><span class="hs-identifier hs-var">graphFilterM</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Bool
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- Example: monadic dfs algorithm(s)</span><span>
</span><span id="line-192"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Monadic graph algorithms are defined in two steps:</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span class="hs-comment">--  (1) define the (possibly parameterized) graph transformer (e.g., dfsGT)</span><span>
</span><span id="line-197"></span><span class="hs-comment">--  (2) run the graph transformer (applied to arguments) (e.g., dfsM)</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679077846"><span id="local-6989586621679077847"><span id="local-6989586621679077848"><span id="local-6989586621679077849"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-type">dfsGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077849"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077848"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077849"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077848"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077847"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077846"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-201"></span><span id="dfsGT"><span class="annot"><span class="annottext">dfsGT :: [Node] -&gt; GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var hs-var">dfsGT</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var">dfsGT</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077616"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077615"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m ([Node], gr a b)) -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077614"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>               </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077613"><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">mc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077612"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">mg</span></a></span><span>
</span><span id="line-204"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679077611"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077611"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Node] -&gt; [Node])
-&gt; GT m (gr a b) [Node] -&gt; gr a b -&gt; m ([Node], gr a b)
forall (m :: * -&gt; *) a b g.
Monad m =&gt;
(a -&gt; b) -&gt; GT m g a -&gt; g -&gt; m (b, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#applyWith%27"><span class="hs-identifier hs-var">applyWith'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077616"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var">dfsGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Node) -&gt; Node) -&gt; Adj b -&gt; [Node]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(b, Node) -&gt; Node
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679077611"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">[Node] -&gt; [Node] -&gt; [Node]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-206"></span><span>                    </span><span class="annot"><span class="annottext">MContext a b
</span><span class="hs-identifier hs-var">Nothing</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node] -&gt; gr a b -&gt; m ([Node], gr a b)
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply%27"><span class="hs-identifier hs-var">apply'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var">dfsGT</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">g'</span></a></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | depth-first search yielding number of nodes</span><span>
</span><span id="line-209"></span><span id="local-6989586621679077607"><span id="local-6989586621679077608"><span id="local-6989586621679077609"><span id="local-6989586621679077610"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsM"><span class="hs-identifier hs-type">dfsM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077610"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077609"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077610"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077609"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077608"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077607"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077610"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-210"></span><span id="dfsM"><span class="annot"><span class="annottext">dfsM :: [Node] -&gt; m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsM"><span class="hs-identifier hs-var hs-var">dfsM</span></a></span></span><span> </span><span id="local-6989586621679077606"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077606"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node] -&gt; m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var">dfsGT</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077606"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679077602"><span id="local-6989586621679077603"><span id="local-6989586621679077604"><span id="local-6989586621679077605"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dfsM%27"><span class="hs-identifier hs-type">dfsM'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077604"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077604"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077603"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077602"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077605"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-213"></span><span id="dfsM%27"><span class="annot"><span class="annottext">dfsM' :: m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsM%27"><span class="hs-identifier hs-var hs-var">dfsM'</span></a></span></span><span> </span><span id="local-6989586621679077601"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077601"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077600"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077600"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier hs-var">nodesM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077601"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Node] -&gt; m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dfsGT"><span class="hs-identifier hs-var">dfsGT</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077600"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077601"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | depth-first search yielding dfs forest</span><span>
</span><span id="line-217"></span><span id="local-6989586621679077822"><span id="local-6989586621679077823"><span id="local-6989586621679077824"><span id="local-6989586621679077825"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-type">dffM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077825"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077824"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#GT"><span class="hs-identifier hs-type">GT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077825"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077824"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077823"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077822"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-218"></span><span id="dffM"><span class="annot"><span class="annottext">dffM :: [Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var hs-var">dffM</span></a></span></span><span> </span><span id="local-6989586621679077598"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077598"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (gr a b) -&gt; m ([Tree Node], gr a b))
-&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) g a. (m g -&gt; m (a, g)) -&gt; GT m g a
</span><a href="Data.Graph.Inductive.Query.Monad.html#MGT"><span class="hs-identifier hs-var">MGT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077597"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">mg</span></a></span></span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679077596"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077596"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">mg</span></a></span><span>
</span><span id="line-220"></span><span>             </span><span id="local-6989586621679077595"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">m (gr a b) -&gt; m Bool
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m Bool
</span><a href="Data.Graph.Inductive.Monad.html#isEmptyM"><span class="hs-identifier hs-var">isEmptyM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">mg</span></a></span><span>
</span><span id="line-221"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span class="annot"><span class="annottext">[Node] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077598"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([Tree Node], gr a b) -&gt; m ([Tree Node], gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077596"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-222"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077593"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077593"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077592"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077592"><span class="hs-identifier hs-var">vs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077598"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-223"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077591"><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077591"><span class="hs-identifier hs-var">mc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077590"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077590"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Node -&gt; m (gr a b) -&gt; m (MContext a b, gr a b)
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
Node -&gt; m (gr a b) -&gt; m (Decomp gr a b)
</span><a href="Data.Graph.Inductive.Monad.html#matchM"><span class="hs-identifier hs-var">matchM</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679077593"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">mg</span></a></span><span>
</span><span id="line-224"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MContext a b
</span><a href="#local-6989586621679077591"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-225"></span><span>                     </span><span class="annot"><span class="annottext">MContext a b
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Tree Node] -&gt; m (gr a b) -&gt; m ([Tree Node], gr a b)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var">dffM</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077592"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr a b -&gt; m (gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077590"><span class="hs-identifier hs-var">g1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679077589"><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077589"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077588"><span class="annot"><span class="annottext">[Tree Node]
</span><a href="#local-6989586621679077588"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077587"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077587"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Tree Node] -&gt; m (gr a b) -&gt; m ([Tree Node], gr a b)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var">dffM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b -&gt; [Node]
forall a b. Context a b -&gt; [Node]
</span><a href="Data.Graph.Inductive.Graph.html#suc%27"><span class="hs-identifier hs-var">suc'</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077589"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr a b -&gt; m (gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077590"><span class="hs-identifier hs-var">g1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                                   </span><span class="hs-special">(</span><span id="local-6989586621679077585"><span class="annot"><span class="annottext">[Tree Node]
</span><a href="#local-6989586621679077585"><span class="hs-identifier hs-var">ts'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077584"><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077584"><span class="hs-identifier hs-var">g3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Tree Node] -&gt; m (gr a b) -&gt; m ([Tree Node], gr a b)
forall (m :: * -&gt; *) g a. GT m g a -&gt; m g -&gt; m (a, g)
</span><a href="Data.Graph.Inductive.Query.Monad.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var">dffM</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077592"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">gr a b -&gt; m (gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077587"><span class="hs-identifier hs-var">g2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                                   </span><span class="annot"><span class="annottext">([Tree Node], gr a b) -&gt; m ([Tree Node], gr a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; [Tree Node] -&gt; Tree Node
forall a. a -&gt; Forest a -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b -&gt; Node
forall a b. Context a b -&gt; Node
</span><a href="Data.Graph.Inductive.Graph.html#node%27"><span class="hs-identifier hs-var">node'</span></a></span><span> </span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679077589"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tree Node]
</span><a href="#local-6989586621679077588"><span class="hs-identifier hs-var">ts</span></a></span><span class="annot"><span class="annottext">Tree Node -&gt; [Tree Node] -&gt; [Tree Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Tree Node]
</span><a href="#local-6989586621679077585"><span class="hs-identifier hs-var">ts'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">gr a b
</span><a href="#local-6989586621679077584"><span class="hs-identifier hs-var">g3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679077578"><span id="local-6989586621679077579"><span id="local-6989586621679077580"><span id="local-6989586621679077581"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphDff"><span class="hs-identifier hs-type">graphDff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077580"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077580"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077579"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077578"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077581"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-232"></span><span id="graphDff"><span class="annot"><span class="annottext">graphDff :: [Node] -&gt; m (gr a b) -&gt; m [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphDff"><span class="hs-identifier hs-var hs-var">graphDff</span></a></span></span><span> </span><span id="local-6989586621679077577"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077577"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Tree Node] -&gt; m (gr a b) -&gt; m [Tree Node]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var">dffM</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077577"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621679077573"><span id="local-6989586621679077574"><span id="local-6989586621679077575"><span id="local-6989586621679077576"><span class="annot"><a href="Data.Graph.Inductive.Query.Monad.html#graphDff%27"><span class="hs-identifier hs-type">graphDff'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Monad.html#GraphM"><span class="hs-identifier hs-type">GraphM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077576"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077575"><span class="hs-identifier hs-type">gr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077576"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679077575"><span class="hs-identifier hs-type">gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077574"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077573"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679077576"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-235"></span><span id="graphDff%27"><span class="annot"><span class="annottext">graphDff' :: m (gr a b) -&gt; m [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#graphDff%27"><span class="hs-identifier hs-var hs-var">graphDff'</span></a></span></span><span> </span><span id="local-6989586621679077572"><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077572"><span class="hs-identifier hs-var">mg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span id="local-6989586621679077571"><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077571"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (gr a b) -&gt; m [Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
m (gr a b) -&gt; m [Node]
</span><a href="Data.Graph.Inductive.Monad.html#nodesM"><span class="hs-identifier hs-var">nodesM</span></a></span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077572"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">GT m (gr a b) [Tree Node] -&gt; m (gr a b) -&gt; m [Tree Node]
forall (m :: * -&gt; *) g a. Monad m =&gt; GT m g a -&gt; m g -&gt; m a
</span><a href="Data.Graph.Inductive.Query.Monad.html#runGT"><span class="hs-identifier hs-var">runGT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Node] -&gt; GT m (gr a b) [Tree Node]
forall (m :: * -&gt; *) (gr :: * -&gt; * -&gt; *) a b.
GraphM m gr =&gt;
[Node] -&gt; GT m (gr a b) [Tree Node]
</span><a href="Data.Graph.Inductive.Query.Monad.html#dffM"><span class="hs-identifier hs-var">dffM</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679077571"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (gr a b)
</span><a href="#local-6989586621679077572"><span class="hs-identifier hs-var">mg</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-236"></span></pre></body></html>