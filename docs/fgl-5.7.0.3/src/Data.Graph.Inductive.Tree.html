<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- (c) 1999 - 2002 by Martin Erwig [see file COPYRIGHT]</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- | Tree-based implementation of 'Graph' and 'DynGraph'</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">--   You will probably have better performance using the</span><span>
</span><span id="line-10"></span><span class="hs-comment">--   &quot;Data.Graph.Inductive.PatriciaTree&quot; implementation instead.</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Graph.Inductive.Tree</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier">Gr</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#UGr"><span class="hs-identifier">UGr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html"><span class="hs-identifier">Data.Graph.Inductive.Graph</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftA2</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sort</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_containers (0,4,2)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base (4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">first</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">second</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-36"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- GRAPH REPRESENTATION</span><span>
</span><span id="line-38"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span id="local-6989586621679078587"><span id="local-6989586621679078588"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Gr"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span id="local-6989586621679078738"><span class="annot"><a href="#local-6989586621679078738"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679078737"><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gr"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078737"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 702
</span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Gr a b -&gt; Rep (Gr a b) x)
-&gt; (forall x. Rep (Gr a b) x -&gt; Gr a b) -&gt; Generic (Gr a b)
forall x. Rep (Gr a b) x -&gt; Gr a b
forall x. Gr a b -&gt; Rep (Gr a b) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a b x. Rep (Gr a b) x -&gt; Gr a b
forall a b x. Gr a b -&gt; Rep (Gr a b) x
$cto :: forall a b x. Rep (Gr a b) x -&gt; Gr a b
$cfrom :: forall a b x. Gr a b -&gt; Rep (Gr a b) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-45"></span><span class="hs-keyword">type</span><span> </span><span id="GraphRep"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#GraphRep"><span class="hs-identifier hs-var">GraphRep</span></a></span></span><span> </span><span id="local-6989586621679078582"><span class="annot"><a href="#local-6989586621679078582"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679078581"><span class="annot"><a href="#local-6989586621679078581"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078582"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078581"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">type</span><span> </span><span id="Context%27"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-var">Context'</span></a></span></span><span> </span><span id="local-6989586621679078580"><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679078579"><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679078580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">type</span><span> </span><span id="UGr"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#UGr"><span class="hs-identifier hs-var">UGr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- CLASS INSTANCES</span><span>
</span><span id="line-52"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679078577"><span id="local-6989586621679078578"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078574"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679078578"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679078577"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078578"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078577"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078572"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078572"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679078571"><span class="annot"><span class="annottext">== :: Gr a b -&gt; Gr a b -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078570"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078570"><span class="hs-identifier hs-var">g2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([(b, Node)], a, [(b, Node)]) -&gt; ([(b, Node)], a, [(b, Node)]))
-&gt; GraphRep a b -&gt; GraphRep a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([(b, Node)], a, [(b, Node)]) -&gt; ([(b, Node)], a, [(b, Node)])
forall a a b. (Ord a, Ord a) =&gt; ([a], b, [a]) -&gt; ([a], b, [a])
</span><a href="#local-6989586621679078569"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078572"><span class="hs-identifier hs-var">g1</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; GraphRep a b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(([(b, Node)], a, [(b, Node)]) -&gt; ([(b, Node)], a, [(b, Node)]))
-&gt; GraphRep a b -&gt; GraphRep a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([(b, Node)], a, [(b, Node)]) -&gt; ([(b, Node)], a, [(b, Node)])
forall a a b. (Ord a, Ord a) =&gt; ([a], b, [a]) -&gt; ([a], b, [a])
</span><a href="#local-6989586621679078569"><span class="hs-identifier hs-var">sortAdj</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078570"><span class="hs-identifier hs-var">g2</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>      </span><span id="local-6989586621679078569"><span class="annot"><span class="annottext">sortAdj :: ([a], b, [a]) -&gt; ([a], b, [a])
</span><a href="#local-6989586621679078569"><span class="hs-identifier hs-var hs-var">sortAdj</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078568"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078568"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078567"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078567"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078566"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078566"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078568"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078567"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sort</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078566"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span id="local-6989586621679078564"><span id="local-6989586621679078565"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078559"><span id="local-6989586621679078561"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679078565"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679078564"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078565"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078564"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621679078557"><span class="annot"><span class="annottext">showsPrec :: Node -&gt; Gr a b -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span id="local-6989586621679078555"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078555"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679078554"><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679078554"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078555"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-61"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGraph &quot;</span></span><span>
</span><span id="line-62"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LNode a] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LNode a]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LNode a]
</span><a href="Data.Graph.Inductive.Graph.html#labNodes"><span class="hs-identifier hs-var">labNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679078554"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-64"></span><span>                    </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; ShowS
forall a. Show a =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">shows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gr a b -&gt; [LEdge b]
forall (gr :: * -&gt; * -&gt; *) a b. Graph gr =&gt; gr a b -&gt; [LEdge b]
</span><a href="Data.Graph.Inductive.Graph.html#labEdges"><span class="hs-identifier hs-var">labEdges</span></a></span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679078554"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679078545"><span id="local-6989586621679078546"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078538"><span id="local-6989586621679078540"><span id="local-6989586621679078542"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679078546"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679078545"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078545"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679078536"><span class="annot"><span class="annottext">readsPrec :: Node -&gt; ReadS (Gr a b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span id="local-6989586621679078534"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078534"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a. Bool -&gt; ReadS a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078534"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Node
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReadS (Gr a b) -&gt; ReadS (Gr a b))
-&gt; ReadS (Gr a b) -&gt; ReadS (Gr a b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679078532"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078532"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mkGraph&quot;</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078531"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078531"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS String
</span><span class="hs-identifier hs-var">lex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078532"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679078529"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679078529"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078528"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078528"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS [LNode a]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078531"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679078526"><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679078526"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078525"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078525"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadS [LEdge b]
forall a. Read a =&gt; ReadS a
</span><span class="hs-identifier hs-var">reads</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078528"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">(Gr a b, String) -&gt; [(Gr a b, String)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LNode a] -&gt; [LEdge b] -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) a b.
Graph gr =&gt;
[LNode a] -&gt; [LEdge b] -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#mkGraph"><span class="hs-identifier hs-var">mkGraph</span></a></span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679078529"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679078526"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078525"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Graph</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679078513"><span class="annot"><span class="annottext">empty :: Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679078510"><span class="annot"><span class="annottext">isEmpty :: Gr a b -&gt; Bool
</span><a href="Data.Graph.Inductive.Graph.html#isEmpty"><span class="hs-identifier hs-var hs-var hs-var hs-var">isEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078508"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078508"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">M.null</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078508"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679078506"><span class="annot"><span class="annottext">match :: Node -&gt; Gr a b -&gt; Decomp Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#match"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679078504"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078504"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679078503"><span class="annot"><span class="annottext">gr :: Gr a b
</span><a href="#local-6989586621679078503"><span class="hs-identifier hs-var">gr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078502"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078502"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Decomp Gr a b
-&gt; ((Context' a b, GraphRep a b) -&gt; Decomp Gr a b)
-&gt; Maybe (Context' a b, GraphRep a b)
-&gt; Decomp Gr a b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Gr a b
</span><a href="#local-6989586621679078503"><span class="hs-identifier hs-var">gr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context a b -&gt; Maybe (Context a b))
-&gt; (Context a b, Gr a b) -&gt; Decomp Gr a b
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">Context a b -&gt; Maybe (Context a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Context a b, Gr a b) -&gt; Decomp Gr a b)
-&gt; ((Context' a b, GraphRep a b) -&gt; (Context a b, Gr a b))
-&gt; (Context' a b, GraphRep a b)
-&gt; Decomp Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; GraphRep a b -&gt; (Context a b, Gr a b))
-&gt; (Context' a b, GraphRep a b) -&gt; (Context a b, Gr a b)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; Context' a b -&gt; GraphRep a b -&gt; (Context a b, Gr a b)
forall a b.
Node -&gt; Context' a b -&gt; GraphRep a b -&gt; (Context a b, Gr a b)
</span><a href="Data.Graph.Inductive.Tree.html#cleanSplit"><span class="hs-identifier hs-var">cleanSplit</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078504"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                      </span><span class="annot"><span class="annottext">(Maybe (Context' a b, GraphRep a b) -&gt; Decomp Gr a b)
-&gt; ((Maybe (Context' a b), GraphRep a b)
    -&gt; Maybe (Context' a b, GraphRep a b))
-&gt; (Maybe (Context' a b), GraphRep a b)
-&gt; Decomp Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679078497"><span class="annot"><span class="annottext">Maybe (Context' a b)
</span><a href="#local-6989586621679078497"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078496"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078496"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; (Context' a b, GraphRep a b))
-&gt; Maybe (Context' a b) -&gt; Maybe (Context' a b, GraphRep a b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; GraphRep a b -&gt; (Context' a b, GraphRep a b))
-&gt; GraphRep a b -&gt; Context' a b -&gt; (Context' a b, GraphRep a b)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078496"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Context' a b)
</span><a href="#local-6989586621679078497"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>                      </span><span class="annot"><span class="annottext">((Maybe (Context' a b), GraphRep a b) -&gt; Decomp Gr a b)
-&gt; (Maybe (Context' a b), GraphRep a b) -&gt; Decomp Gr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Node -&gt; Context' a b -&gt; Maybe (Context' a b))
-&gt; Node -&gt; GraphRep a b -&gt; (Maybe (Context' a b), GraphRep a b)
forall k a.
Ord k =&gt;
(k -&gt; a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; (Maybe a, Map k a)
</span><span class="hs-identifier hs-var">M.updateLookupWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context' a b -&gt; Maybe (Context' a b))
-&gt; Node -&gt; Context' a b -&gt; Maybe (Context' a b)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context' a b) -&gt; Context' a b -&gt; Maybe (Context' a b)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Context' a b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078504"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078502"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679078492"><span class="annot"><span class="annottext">mkGraph :: [LNode a] -&gt; [LEdge b] -&gt; Gr a b
</span><a href="#local-6989586621679078492"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkGraph</span></a></span></span><span> </span><span id="local-6989586621679078491"><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679078491"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679078490"><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679078490"><span class="hs-identifier hs-var">es</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LEdge b] -&gt; Gr a b -&gt; Gr a b
forall (gr :: * -&gt; * -&gt; *) b a.
DynGraph gr =&gt;
[LEdge b] -&gt; gr a b -&gt; gr a b
</span><a href="Data.Graph.Inductive.Graph.html#insEdges"><span class="hs-identifier hs-var">insEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[LEdge b]
</span><a href="#local-6989586621679078490"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-86"></span><span>                      </span><span class="annot"><span class="annottext">(Gr a b -&gt; Gr a b) -&gt; ([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span>
</span><span id="line-87"></span><span>                      </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Gr a b)
-&gt; ([LNode a] -&gt; GraphRep a b) -&gt; [LNode a] -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Node, ([(b, Node)], a, [(b, Node)]))] -&gt; GraphRep a b
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-88"></span><span>                      </span><span class="annot"><span class="annottext">([(Node, ([(b, Node)], a, [(b, Node)]))] -&gt; GraphRep a b)
-&gt; ([LNode a] -&gt; [(Node, ([(b, Node)], a, [(b, Node)]))])
-&gt; [LNode a]
-&gt; GraphRep a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(LNode a -&gt; (Node, ([(b, Node)], a, [(b, Node)])))
-&gt; [LNode a] -&gt; [(Node, ([(b, Node)], a, [(b, Node)]))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; ([(b, Node)], a, [(b, Node)]))
-&gt; LNode a -&gt; (Node, ([(b, Node)], a, [(b, Node)]))
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078486"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078486"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078486"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>                      </span><span class="annot"><span class="annottext">([LNode a] -&gt; Gr a b) -&gt; [LNode a] -&gt; Gr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[LNode a]
</span><a href="#local-6989586621679078491"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679078485"><span class="annot"><span class="annottext">labNodes :: Gr a b -&gt; [LNode a]
</span><a href="#local-6989586621679078485"><span class="hs-identifier hs-var hs-var hs-var hs-var">labNodes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078484"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078484"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, (Adj b, a, Adj b)) -&gt; LNode a)
-&gt; [(Node, (Adj b, a, Adj b))] -&gt; [LNode a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679078483"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078483"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679078482"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078482"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078483"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078482"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Node, (Adj b, a, Adj b))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078484"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679078480"><span class="annot"><span class="annottext">matchAny :: Gr a b -&gt; GDecomp Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#matchAny"><span class="hs-identifier hs-var hs-var hs-var hs-var">matchAny</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078478"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078478"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GDecomp Gr a b
-&gt; (((Node, Context' a b), GraphRep a b) -&gt; GDecomp Gr a b)
-&gt; Maybe ((Node, Context' a b), GraphRep a b)
-&gt; GDecomp Gr a b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; GDecomp Gr a b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Match Exception, Empty Graph&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Node, Context' a b) -&gt; GraphRep a b -&gt; GDecomp Gr a b)
-&gt; ((Node, Context' a b), GraphRep a b) -&gt; GDecomp Gr a b
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Node -&gt; Context' a b -&gt; GraphRep a b -&gt; GDecomp Gr a b)
-&gt; (Node, Context' a b) -&gt; GraphRep a b -&gt; GDecomp Gr a b
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Node -&gt; Context' a b -&gt; GraphRep a b -&gt; GDecomp Gr a b
forall a b.
Node -&gt; Context' a b -&gt; GraphRep a b -&gt; (Context a b, Gr a b)
</span><a href="Data.Graph.Inductive.Tree.html#cleanSplit"><span class="hs-identifier hs-var">cleanSplit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Node, Context' a b), GraphRep a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">M.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078478"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679078475"><span class="annot"><span class="annottext">noNodes :: Gr a b -&gt; Node
</span><a href="Data.Graph.Inductive.Graph.html#noNodes"><span class="hs-identifier hs-var hs-var hs-var hs-var">noNodes</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078473"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078473"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Node
forall k a. Map k a -&gt; Node
</span><span class="hs-identifier hs-var">M.size</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078473"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679078471"><span class="annot"><span class="annottext">nodeRange :: Gr a b -&gt; (Node, Node)
</span><a href="Data.Graph.Inductive.Graph.html#nodeRange"><span class="hs-identifier hs-var hs-var hs-var hs-var">nodeRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078469"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078469"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Node, Node) -&gt; Maybe (Node, Node) -&gt; (Node, Node)
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; (Node, Node)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nodeRange of empty graph&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                      </span><span class="annot"><span class="annottext">(Maybe (Node, Node) -&gt; (Node, Node))
-&gt; Maybe (Node, Node) -&gt; (Node, Node)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Node -&gt; Node -&gt; (Node, Node))
-&gt; Maybe Node -&gt; Maybe Node -&gt; Maybe (Node, Node)
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Node, Context' a b), GraphRep a b) -&gt; Maybe Node
forall b b b. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679078468"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Node, Context' a b), GraphRep a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">M.minViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078469"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ((Node, Context' a b), GraphRep a b) -&gt; Maybe Node
forall b b b. Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679078468"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; Maybe ((Node, Context' a b), GraphRep a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><span class="hs-identifier hs-var">M.maxViewWithKey</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078469"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>      </span><span id="local-6989586621679078468"><span class="annot"><span class="annottext">ix :: Maybe ((b, b), b) -&gt; Maybe b
</span><a href="#local-6989586621679078468"><span class="hs-identifier hs-var hs-var">ix</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((b, b), b) -&gt; b) -&gt; Maybe ((b, b), b) -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b, b) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((b, b) -&gt; b) -&gt; (((b, b), b) -&gt; (b, b)) -&gt; ((b, b), b) -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((b, b), b) -&gt; (b, b)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679078466"><span class="annot"><span class="annottext">labEdges :: Gr a b -&gt; [LEdge b]
</span><a href="#local-6989586621679078466"><span class="hs-identifier hs-var hs-var hs-var hs-var">labEdges</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078465"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078465"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Node, (Adj b, a, Adj b)) -&gt; [LEdge b])
-&gt; [(Node, (Adj b, a, Adj b))] -&gt; [LEdge b]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679078463"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078463"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679078462"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078462"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">((b, Node) -&gt; LEdge b) -&gt; Adj b -&gt; [LEdge b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679078461"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078461"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078460"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078460"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078463"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078460"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078461"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078462"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphRep a b -&gt; [(Node, (Adj b, a, Adj b))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078465"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- After a Node (with its corresponding Context') are split out of a</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- GraphRep, clean up the remainders.</span><span>
</span><span id="line-109"></span><span id="local-6989586621679078713"><span id="local-6989586621679078714"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#cleanSplit"><span class="hs-identifier hs-type">cleanSplit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078713"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078713"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078713"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078713"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-111"></span><span id="cleanSplit"><span class="annot"><span class="annottext">cleanSplit :: Node -&gt; Context' a b -&gt; GraphRep a b -&gt; (Context a b, Gr a b)
</span><a href="Data.Graph.Inductive.Tree.html#cleanSplit"><span class="hs-identifier hs-var hs-var">cleanSplit</span></a></span></span><span> </span><span id="local-6989586621679078459"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078459"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078458"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078458"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078457"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078457"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078456"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078456"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679078455"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078455"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context a b
</span><a href="#local-6989586621679078454"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078453"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- Note: loops are kept only in successor list</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679078454"><span class="annot"><span class="annottext">c :: Context a b
</span><a href="#local-6989586621679078454"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078452"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078459"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078457"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078456"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679078452"><span class="annot"><span class="annottext">p' :: Adj b
</span><a href="#local-6989586621679078452"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; Adj b
forall a. [(a, Node)] -&gt; [(a, Node)]
</span><a href="#local-6989586621679078451"><span class="hs-identifier hs-var">rmLoops</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078458"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679078450"><span class="annot"><span class="annottext">s' :: Adj b
</span><a href="#local-6989586621679078450"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b -&gt; Adj b
forall a. [(a, Node)] -&gt; [(a, Node)]
</span><a href="#local-6989586621679078451"><span class="hs-identifier hs-var">rmLoops</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078456"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679078451"><span class="annot"><span class="annottext">rmLoops :: [(a, Node)] -&gt; [(a, Node)]
</span><a href="#local-6989586621679078451"><span class="hs-identifier hs-var hs-var">rmLoops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Node) -&gt; Bool) -&gt; [(a, Node)] -&gt; [(a, Node)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078459"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Node -&gt; Bool) -&gt; ((a, Node) -&gt; Node) -&gt; (a, Node) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, Node) -&gt; Node
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679078453"><span class="annot"><span class="annottext">g' :: GraphRep a b
</span><a href="#local-6989586621679078453"><span class="hs-identifier hs-var hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
forall b a.
Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-var">updAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078450"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; b -&gt; Context' a b -&gt; Context' a b
forall b a. Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#clearPred"><span class="hs-identifier hs-var">clearPred</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078459"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; GraphRep a b)
-&gt; (GraphRep a b -&gt; GraphRep a b) -&gt; GraphRep a b -&gt; GraphRep a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
forall b a.
Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-var">updAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078452"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; b -&gt; Context' a b -&gt; Context' a b
forall b a. Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#clearSucc"><span class="hs-identifier hs-var">clearSucc</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078459"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; GraphRep a b) -&gt; GraphRep a b -&gt; GraphRep a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078455"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- DynGraph</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#DynGraph"><span class="hs-identifier hs-type">DynGraph</span></a></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679078442"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078442"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078441"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078441"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078440"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078440"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078439"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078439"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679078438"><span class="annot"><span class="annottext">&amp; :: Context a b -&gt; Gr a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Graph.html#%26"><span class="hs-operator hs-var hs-var hs-var hs-var">&amp;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078436"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078436"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; Gr a b
forall a b. GraphRep a b -&gt; Gr a b
</span><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-var">Gr</span></a></span><span>
</span><span id="line-125"></span><span>                       </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Gr a b)
-&gt; (GraphRep a b -&gt; GraphRep a b) -&gt; GraphRep a b -&gt; Gr a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
forall b a.
Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-var">updAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078442"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; b -&gt; Context' a b -&gt; Context' a b
forall b a. Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#addSucc"><span class="hs-identifier hs-var">addSucc</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078441"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>                       </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; GraphRep a b)
-&gt; (GraphRep a b -&gt; GraphRep a b) -&gt; GraphRep a b -&gt; GraphRep a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
forall b a.
Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-var">updAdj</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078439"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; b -&gt; Context' a b -&gt; Context' a b
forall b a. Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#addPred"><span class="hs-identifier hs-var">addPred</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078441"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                       </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; Gr a b) -&gt; GraphRep a b -&gt; Gr a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Context' a b) -&gt; Maybe (Context' a b))
-&gt; Node -&gt; GraphRep a b -&gt; GraphRep a b
forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.alter</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Context' a b) -&gt; Maybe (Context' a b)
forall b. Maybe b -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679078432"><span class="hs-identifier hs-var">addCntxt</span></a></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078441"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078436"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621679078432"><span class="annot"><span class="annottext">addCntxt :: Maybe b -&gt; Maybe (Context' a b)
</span><a href="#local-6989586621679078432"><span class="hs-identifier hs-var hs-var">addCntxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Context' a b)
-&gt; (b -&gt; Maybe (Context' a b)) -&gt; Maybe b -&gt; Maybe (Context' a b)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context' a b -&gt; Maybe (Context' a b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Context' a b
</span><a href="#local-6989586621679078431"><span class="hs-identifier hs-var">cntxt'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Context' a b) -&gt; b -&gt; Maybe (Context' a b)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe (Context' a b)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Node Exception, Node: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">Node -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078441"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621679078431"><span class="annot"><span class="annottext">cntxt' :: Context' a b
</span><a href="#local-6989586621679078431"><span class="hs-identifier hs-var hs-var">cntxt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078442"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078440"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078439"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_containers (0,4,2)
</span><span id="local-6989586621679078428"><span id="local-6989586621679078429"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679078429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679078428"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078429"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078428"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679078425"><span class="annot"><span class="annottext">rnf :: Gr a b -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span id="local-6989586621679078423"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078423"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphRep a b -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078423"><span class="hs-identifier hs-var">g</span></a></span></span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_base (4,8,0)
</span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Gr"><span class="hs-identifier hs-type">Gr</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679078418"><span class="annot"><span class="annottext">bimap :: (a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">bimap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (c -&gt; d) -&gt; Gr a c -&gt; Gr b d
forall (gr :: * -&gt; * -&gt; *) a c b d.
DynGraph gr =&gt;
(a -&gt; c) -&gt; (b -&gt; d) -&gt; gr a b -&gt; gr c d
</span><a href="Data.Graph.Inductive.Graph.html#nemap"><span class="hs-identifier hs-var">nemap</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679078415"><span class="annot"><span class="annottext">first :: (a -&gt; b) -&gt; Gr a c -&gt; Gr b c
</span><a href="#local-6989586621679078415"><span class="hs-identifier hs-var hs-var hs-var hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Gr a c -&gt; Gr b c
forall (gr :: * -&gt; * -&gt; *) a c b.
DynGraph gr =&gt;
(a -&gt; c) -&gt; gr a b -&gt; gr c b
</span><a href="Data.Graph.Inductive.Graph.html#nmap"><span class="hs-identifier hs-var">nmap</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679078413"><span class="annot"><span class="annottext">second :: (b -&gt; c) -&gt; Gr a b -&gt; Gr a c
</span><a href="#local-6989586621679078413"><span class="hs-identifier hs-var hs-var hs-var hs-var">second</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; Gr a b -&gt; Gr a c
forall (gr :: * -&gt; * -&gt; *) b c a.
DynGraph gr =&gt;
(b -&gt; c) -&gt; gr a b -&gt; gr a c
</span><a href="Data.Graph.Inductive.Graph.html#emap"><span class="hs-identifier hs-var">emap</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-147"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- UTILITIES</span><span>
</span><span id="line-149"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679078410"><span id="local-6989586621679078411"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#addSucc"><span class="hs-identifier hs-type">addSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078411"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078411"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078410"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078411"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-152"></span><span id="addSucc"><span class="annot"><span class="annottext">addSucc :: Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#addSucc"><span class="hs-identifier hs-var hs-var">addSucc</span></a></span></span><span> </span><span id="local-6989586621679078409"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078409"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679078408"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078408"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078407"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078407"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078406"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078406"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078405"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078405"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078407"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078406"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078408"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078409"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(b, Node) -&gt; Adj b -&gt; Adj b
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078405"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621679078403"><span id="local-6989586621679078404"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#addPred"><span class="hs-identifier hs-type">addPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078404"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078403"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078404"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078403"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078404"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-155"></span><span id="addPred"><span class="annot"><span class="annottext">addPred :: Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#addPred"><span class="hs-identifier hs-var hs-var">addPred</span></a></span></span><span> </span><span id="local-6989586621679078402"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078402"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679078401"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078401"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078400"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078400"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078399"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078399"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078398"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078398"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078401"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078402"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(b, Node) -&gt; Adj b -&gt; Adj b
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078400"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078399"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078398"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679078396"><span id="local-6989586621679078397"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#clearSucc"><span class="hs-identifier hs-type">clearSucc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078397"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078396"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078397"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078396"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078397"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-158"></span><span id="clearSucc"><span class="annot"><span class="annottext">clearSucc :: Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#clearSucc"><span class="hs-identifier hs-var hs-var">clearSucc</span></a></span></span><span> </span><span id="local-6989586621679078395"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078395"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078394"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078394"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078393"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078393"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078392"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078392"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078394"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078393"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">((b, Node) -&gt; Bool) -&gt; Adj b -&gt; Adj b
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078395"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Node -&gt; Bool) -&gt; ((b, Node) -&gt; Node) -&gt; (b, Node) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(b, Node) -&gt; Node
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078392"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679078649"><span id="local-6989586621679078650"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#clearPred"><span class="hs-identifier hs-type">clearPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078649"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078649"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078650"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-161"></span><span id="clearPred"><span class="annot"><span class="annottext">clearPred :: Node -&gt; b -&gt; Context' a b -&gt; Context' a b
</span><a href="Data.Graph.Inductive.Tree.html#clearPred"><span class="hs-identifier hs-var hs-var">clearPred</span></a></span></span><span> </span><span id="local-6989586621679078391"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078391"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078390"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078390"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078389"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078389"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078388"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078388"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Node) -&gt; Bool) -&gt; Adj b -&gt; Adj b
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078391"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Node -&gt; Bool) -&gt; ((b, Node) -&gt; Node) -&gt; (b, Node) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(b, Node) -&gt; Node
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078390"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078389"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078388"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679078651"><span id="local-6989586621679078652"><span class="annot"><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-type">updAdj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Graph.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#Context%27"><span class="hs-identifier hs-type">Context'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Graph.Inductive.Tree.html#GraphRep"><span class="hs-identifier hs-type">GraphRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078652"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-164"></span><span id="updAdj"><span class="annot"><span class="annottext">updAdj :: Adj b
-&gt; (b -&gt; Context' a b -&gt; Context' a b)
-&gt; GraphRep a b
-&gt; GraphRep a b
</span><a href="Data.Graph.Inductive.Tree.html#updAdj"><span class="hs-identifier hs-var hs-var">updAdj</span></a></span></span><span> </span><span id="local-6989586621679078387"><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078387"><span class="hs-identifier hs-var">adj</span></a></span></span><span> </span><span id="local-6989586621679078386"><span class="annot"><span class="annottext">b -&gt; Context' a b -&gt; Context' a b
</span><a href="#local-6989586621679078386"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679078385"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078385"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GraphRep a b -&gt; (b, Node) -&gt; GraphRep a b)
-&gt; GraphRep a b -&gt; Adj b -&gt; GraphRep a b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078384"><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078384"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078383"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078383"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078382"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078382"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Context' a b -&gt; Context' a b)
-&gt; Node -&gt; GraphRep a b -&gt; GraphRep a b
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Context' a b -&gt; Context' a b
</span><a href="#local-6989586621679078386"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679078383"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679078382"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078384"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GraphRep a b
</span><a href="#local-6989586621679078385"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Adj b
</span><a href="#local-6989586621679078387"><span class="hs-identifier hs-var">adj</span></a></span><span>
</span><span id="line-165"></span></pre></body></html>